  [1m[35m (1.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "availabilities"[0m
  [1m[35m (1.5ms)[0m  [1m[35mCREATE TABLE "availabilities" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "tour_id" integer NOT NULL, "availability_rule_id" integer NOT NULL, "start_time" datetime, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE  INDEX "index_availabilities_on_availability_rule_id" ON "availabilities" ("availability_rule_id")[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE  INDEX "index_availabilities_on_tour_id" ON "availabilities" ("tour_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "availability_rules"[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "availability_rules" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "rule_type" varchar, "rule_data" json, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "tours"[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE TABLE "tours" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "description" varchar, "duration_hours" integer, "duration_days" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE TEMPORARY TABLE "aavailabilities" ("id" integer NOT NULL PRIMARY KEY, "tour_id" integer NOT NULL, "availability_rule_id" integer NOT NULL, "start_time" datetime DEFAULT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE  INDEX "tindex_aavailabilities_on_tour_id" ON "aavailabilities" ("tour_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE  INDEX "tindex_aavailabilities_on_availability_rule_id" ON "aavailabilities" ("availability_rule_id")[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "aavailabilities" ("id","tour_id","availability_rule_id","start_time","created_at","updated_at")
                     SELECT "id","tour_id","availability_rule_id","start_time","created_at","updated_at" FROM "availabilities"[0m
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE "availabilities"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "availabilities" ("id" integer NOT NULL PRIMARY KEY, "tour_id" integer NOT NULL, "availability_rule_id" integer NOT NULL, "start_time" datetime DEFAULT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_5756610d3f"
FOREIGN KEY ("availability_rule_id")
  REFERENCES "availability_rules" ("id")
)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE  INDEX "index_availabilities_on_availability_rule_id" ON "availabilities" ("availability_rule_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE  INDEX "index_availabilities_on_tour_id" ON "availabilities" ("tour_id")[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "availabilities" ("id","tour_id","availability_rule_id","start_time","created_at","updated_at")
                     SELECT "id","tour_id","availability_rule_id","start_time","created_at","updated_at" FROM "aavailabilities"[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE "aavailabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[35m (1.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA foreign_keys[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA defer_foreign_keys[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA defer_foreign_keys = ON[0m
  [1m[35m (0.1ms)[0m  [1m[35mPRAGMA foreign_keys = OFF[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TEMPORARY TABLE "aavailabilities" ("id" integer NOT NULL PRIMARY KEY, "tour_id" integer NOT NULL, "availability_rule_id" integer NOT NULL, "start_time" datetime DEFAULT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE  INDEX "tindex_aavailabilities_on_tour_id" ON "aavailabilities" ("tour_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE  INDEX "tindex_aavailabilities_on_availability_rule_id" ON "aavailabilities" ("availability_rule_id")[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "aavailabilities" ("id","tour_id","availability_rule_id","start_time","created_at","updated_at")
                     SELECT "id","tour_id","availability_rule_id","start_time","created_at","updated_at" FROM "availabilities"[0m
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE "availabilities"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "availabilities" ("id" integer NOT NULL PRIMARY KEY, "tour_id" integer NOT NULL, "availability_rule_id" integer NOT NULL, "start_time" datetime DEFAULT NULL, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL, CONSTRAINT "fk_rails_5756610d3f"
FOREIGN KEY ("availability_rule_id")
  REFERENCES "availability_rules" ("id")
, CONSTRAINT "fk_rails_9840c1e67d"
FOREIGN KEY ("tour_id")
  REFERENCES "tours" ("id")
)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE  INDEX "index_availabilities_on_availability_rule_id" ON "availabilities" ("availability_rule_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE  INDEX "index_availabilities_on_tour_id" ON "availabilities" ("tour_id")[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "availabilities" ("id","tour_id","availability_rule_id","start_time","created_at","updated_at")
                     SELECT "id","tour_id","availability_rule_id","start_time","created_at","updated_at" FROM "aavailabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE "aavailabilities"[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA defer_foreign_keys = 0[0m
  [1m[35m (0.0ms)[0m  [1m[35mPRAGMA foreign_keys = 1[0m
  [1m[35m (1.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (1.5ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (1.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20240327124602)[0m
  [1m[35m (1.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20240327115417),
(20240327115519);

[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.5ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["key", "environment"], ["value", "test"], ["created_at", "2024-03-28 04:05:50.976341"], ["updated_at", "2024-03-28 04:05:50.976341"]]
  [1m[35m (0.9ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.3ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["key", "schema_sha1"], ["value", "58f004826dcd5eddbbc07038e4ca7c35d3613c96"], ["created_at", "2024-03-28 04:05:50.981023"], ["updated_at", "2024-03-28 04:05:50.981023"]]
  [1m[35m (0.8ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 9ms (Views: 0.5ms | ActiveRecord: 0.4ms | Allocations: 2439)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 04:05:51.240854"], ["updated_at", "2024-03-28 04:05:51.240854"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 04:05:51.255464"], ["updated_at", "2024-03-28 04:05:51.255464"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 04:05:51.282671"], ["updated_at", "2024-03-28 04:05:51.282671"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 57ms (Views: 0.9ms | ActiveRecord: 2.7ms | Allocations: 16735)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 1ms (Views: 0.6ms | ActiveRecord: 0.2ms | Allocations: 324)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.3ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 2ms (Views: 0.8ms | ActiveRecord: 0.3ms | Allocations: 314)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 2ms (Views: 1.0ms | ActiveRecord: 0.2ms | Allocations: 282)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (1.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 12:05:51 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 04:05:51.535094"], ["updated_at", "2024-03-28 04:05:51.535094"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 04:05:51.537014"], ["updated_at", "2024-03-28 04:05:51.537014"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 04:05:51.540551"], ["updated_at", "2024-03-28 04:05:51.540551"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 18ms (Views: 0.7ms | ActiveRecord: 1.4ms | Allocations: 2495)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 2424)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.9ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 04:08:20.080364"], ["updated_at", "2024-03-28 04:08:20.080364"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 04:08:20.098723"], ["updated_at", "2024-03-28 04:08:20.098723"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 04:08:20.125412"], ["updated_at", "2024-03-28 04:08:20.125412"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 66ms (Views: 0.8ms | ActiveRecord: 3.3ms | Allocations: 16380)
  [1m[35m (1.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 1ms (Views: 0.7ms | ActiveRecord: 0.3ms | Allocations: 324)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (1.7ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 4ms (Views: 1.2ms | ActiveRecord: 1.7ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.3ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 2ms (Views: 1.5ms | ActiveRecord: 0.3ms | Allocations: 282)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 12:08:20 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 04:08:20.329311"], ["updated_at", "2024-03-28 04:08:20.329311"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.3ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 04:08:20.332722"], ["updated_at", "2024-03-28 04:08:20.332722"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 04:08:20.336995"], ["updated_at", "2024-03-28 04:08:20.336995"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 18ms (Views: 0.7ms | ActiveRecord: 2.2ms | Allocations: 2493)
  [1m[35m (1.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.3ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 04:09:12.027112"], ["updated_at", "2024-03-28 04:09:12.027112"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 04:09:12.064353"], ["updated_at", "2024-03-28 04:09:12.064353"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 04:09:12.084531"], ["updated_at", "2024-03-28 04:09:12.084531"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 68ms (Views: 0.6ms | ActiveRecord: 2.6ms | Allocations: 16394)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 324)
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:09:12.101744"], ["updated_at", "2024-03-28 04:09:12.101744"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:09:12.106848"], ["updated_at", "2024-03-28 04:09:12.106848"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 2ms (Views: 1.0ms | ActiveRecord: 0.2ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (1.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 1ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:09:12.158132"], ["updated_at", "2024-03-28 04:09:12.158132"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.4ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.6ms | ActiveRecord: 0.4ms | Allocations: 581)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:09:12.175331"], ["updated_at", "2024-03-28 04:09:12.175331"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.5ms | ActiveRecord: 0.8ms | Allocations: 763)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:09:12.184753"], ["updated_at", "2024-03-28 04:09:12.184753"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.6ms | ActiveRecord: 1.0ms | Allocations: 761)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:09:12.200073"], ["updated_at", "2024-03-28 04:09:12.200073"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.6ms | ActiveRecord: 0.7ms | Allocations: 761)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:09:12.208264"], ["updated_at", "2024-03-28 04:09:12.208264"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 04:09:12.214889"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 981)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:09:12.222614"], ["updated_at", "2024-03-28 04:09:12.222614"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 04:09:12.230864"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 806)
  [1m[35m (2.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:09:12.244716"], ["updated_at", "2024-03-28 04:09:12.244716"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.3ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 04:09:12.251901"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 11ms (Views: 0.5ms | ActiveRecord: 1.1ms | Allocations: 848)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:09:12.269203"], ["updated_at", "2024-03-28 04:09:12.269203"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.5ms | Allocations: 425)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:09:12.283217"], ["updated_at", "2024-03-28 04:09:12.283217"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.6ms | Allocations: 356)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 12:09:12 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 04:09:12.462007"], ["updated_at", "2024-03-28 04:09:12.462007"]]
  [1m[35m (3.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 04:09:12.470483"], ["updated_at", "2024-03-28 04:09:12.470483"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (3.8ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 04:09:12.490115"], ["updated_at", "2024-03-28 04:09:12.490115"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 93ms (Views: 2.3ms | ActiveRecord: 9.0ms | Allocations: 2490)
  [1m[35m (2.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 7ms (Views: 0.5ms | ActiveRecord: 0.5ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 04:10:24.439888"], ["updated_at", "2024-03-28 04:10:24.439888"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 04:10:24.476470"], ["updated_at", "2024-03-28 04:10:24.476470"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 04:10:24.496003"], ["updated_at", "2024-03-28 04:10:24.496003"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 68ms (Views: 1.3ms | ActiveRecord: 3.0ms | Allocations: 16393)
  [1m[35m (3.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 324)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:10:24.517217"], ["updated_at", "2024-03-28 04:10:24.517217"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:10:24.521492"], ["updated_at", "2024-03-28 04:10:24.521492"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 1ms (Views: 0.8ms | ActiveRecord: 0.2ms | Allocations: 314)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 1ms (Views: 0.6ms | ActiveRecord: 0.1ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:10:24.576571"], ["updated_at", "2024-03-28 04:10:24.576571"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 581)
  [1m[35m (1.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:10:24.597048"], ["updated_at", "2024-03-28 04:10:24.597048"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 3ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 763)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:10:24.615669"], ["updated_at", "2024-03-28 04:10:24.615669"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 3ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 761)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:10:24.626147"], ["updated_at", "2024-03-28 04:10:24.626147"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.6ms | ActiveRecord: 0.9ms | Allocations: 761)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:10:24.632785"], ["updated_at", "2024-03-28 04:10:24.632785"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 04:10:24.636633"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.5ms | ActiveRecord: 0.5ms | Allocations: 981)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:10:24.643488"], ["updated_at", "2024-03-28 04:10:24.643488"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 04:10:24.646878"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.7ms | ActiveRecord: 0.4ms | Allocations: 806)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:10:24.652579"], ["updated_at", "2024-03-28 04:10:24.652579"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 04:10:24.659956"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.5ms | ActiveRecord: 1.1ms | Allocations: 848)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:10:24.667178"], ["updated_at", "2024-03-28 04:10:24.667178"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 425)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:10:24.676187"], ["updated_at", "2024-03-28 04:10:24.676187"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 12:10:24 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (14.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 04:10:24.737237"], ["updated_at", "2024-03-28 04:10:24.737237"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 04:10:24.757927"], ["updated_at", "2024-03-28 04:10:24.757927"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 04:10:24.801487"], ["updated_at", "2024-03-28 04:10:24.801487"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 97ms (Views: 9.5ms | ActiveRecord: 15.7ms | Allocations: 2490)
  [1m[35m (2.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 6ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.9ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 04:42:33.738603"], ["updated_at", "2024-03-28 04:42:33.738603"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 04:42:33.775350"], ["updated_at", "2024-03-28 04:42:33.775350"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 04:42:33.794186"], ["updated_at", "2024-03-28 04:42:33.794186"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 68ms (Views: 0.8ms | ActiveRecord: 5.0ms | Allocations: 16393)
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 324)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:42:33.816165"], ["updated_at", "2024-03-28 04:42:33.816165"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:42:33.820063"], ["updated_at", "2024-03-28 04:42:33.820063"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 12:42:33 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.6ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:42:33"], ["created_at", "2024-03-28 04:42:33.827840"], ["updated_at", "2024-03-28 04:42:33.827840"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 7ms (Views: 0.4ms | ActiveRecord: 1.0ms | Allocations: 1496)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:42:33.834149"], ["updated_at", "2024-03-28 04:42:33.834149"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:42:33.836313"], ["updated_at", "2024-03-28 04:42:33.836313"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 12:42:33 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.7ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:42:33"], ["created_at", "2024-03-28 04:42:33.840873"], ["updated_at", "2024-03-28 04:42:33.840873"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 8ms (Views: 1.5ms | ActiveRecord: 1.0ms | Allocations: 1173)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.9ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 1ms (Views: 0.6ms | ActiveRecord: 0.2ms | Allocations: 314)
  [1m[35m (2.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:42:33.884125"], ["updated_at", "2024-03-28 04:42:33.884125"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 3ms (Views: 0.6ms | ActiveRecord: 0.1ms | Allocations: 537)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.0ms | Allocations: 497)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.0ms | Allocations: 388)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (2.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", ""], ["rule_data", "{}"], ["created_at", "2024-03-28 04:42:33.917940"], ["updated_at", "2024-03-28 04:42:33.917940"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 13ms (Views: 0.4ms | ActiveRecord: 2.4ms | Allocations: 953)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:42:34.072166"], ["updated_at", "2024-03-28 04:42:34.072166"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 04:42:34.088505"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.5ms | ActiveRecord: 0.6ms | Allocations: 1359)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (31.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:42:34.096128"], ["updated_at", "2024-03-28 04:42:34.096128"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.3ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 04:42:34.134603"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.3ms | ActiveRecord: 0.5ms | Allocations: 1181)
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:42:34.140911"], ["updated_at", "2024-03-28 04:42:34.140911"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", ""], ["rule_data", "{}"], ["updated_at", "2024-03-28 04:42:34.147469"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 1047)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:42:34.152842"], ["updated_at", "2024-03-28 04:42:34.152842"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 425)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:42:34.163508"], ["updated_at", "2024-03-28 04:42:34.163508"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.8ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 1.1ms | Allocations: 356)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:42:34.177366"], ["updated_at", "2024-03-28 04:42:34.177366"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.8ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (1.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:42:34.195614"], ["updated_at", "2024-03-28 04:42:34.195614"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.6ms | ActiveRecord: 0.8ms | Allocations: 763)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (3.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:42:34.206483"], ["updated_at", "2024-03-28 04:42:34.206483"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 7ms (Views: 0.6ms | ActiveRecord: 4.0ms | Allocations: 761)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:42:34.238108"], ["updated_at", "2024-03-28 04:42:34.238108"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 11ms (Views: 0.6ms | ActiveRecord: 1.0ms | Allocations: 761)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (3.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.0ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:42:34.394010"], ["updated_at", "2024-03-28 04:42:34.394010"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (1.0ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 04:42:34.440167"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 113ms (Views: 90.5ms | ActiveRecord: 1.4ms | Allocations: 842)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (7.5ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.9ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:42:34.565872"], ["updated_at", "2024-03-28 04:42:34.565872"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 04:42:34.584323"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 15ms (Views: 6.7ms | ActiveRecord: 0.6ms | Allocations: 806)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (3.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:42:34.601247"], ["updated_at", "2024-03-28 04:42:34.601247"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 04:42:34.634362"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 26ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 848)
  [1m[35m (1.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (4.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:42:34.671163"], ["updated_at", "2024-03-28 04:42:34.671163"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.5ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.9ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:42:34.692620"], ["updated_at", "2024-03-28 04:42:34.692620"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.5ms | Allocations: 356)
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 12:42:34 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 04:42:34.921023"], ["updated_at", "2024-03-28 04:42:34.921023"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 04:42:34.923750"], ["updated_at", "2024-03-28 04:42:34.923750"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 04:42:34.928609"], ["updated_at", "2024-03-28 04:42:34.928609"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 33ms (Views: 1.0ms | ActiveRecord: 2.1ms | Allocations: 2490)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 12:45:34 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:45:34.515405"], ["updated_at", "2024-03-28 04:45:34.515405"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:45:34.547420"], ["updated_at", "2024-03-28 04:45:34.547420"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:45:34"], ["created_at", "2024-03-28 04:45:34.567314"], ["updated_at", "2024-03-28 04:45:34.567314"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 63ms (Views: 0.8ms | ActiveRecord: 2.6ms | Allocations: 16855)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 12:45:34 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:45:34.576524"], ["updated_at", "2024-03-28 04:45:34.576524"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:45:34.579189"], ["updated_at", "2024-03-28 04:45:34.579189"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:45:34"], ["created_at", "2024-03-28 04:45:34.583324"], ["updated_at", "2024-03-28 04:45:34.583324"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 10ms (Views: 0.7ms | ActiveRecord: 1.5ms | Allocations: 2633)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 04:45:34.598153"], ["updated_at", "2024-03-28 04:45:34.598153"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 04:45:34.600020"], ["updated_at", "2024-03-28 04:45:34.600020"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 04:45:34.603035"], ["updated_at", "2024-03-28 04:45:34.603035"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 8ms (Views: 0.8ms | ActiveRecord: 1.3ms | Allocations: 2266)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (1.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 2ms (Views: 0.7ms | ActiveRecord: 1.2ms | Allocations: 323)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:45:34.615940"], ["updated_at", "2024-03-28 04:45:34.615940"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:45:34.619130"], ["updated_at", "2024-03-28 04:45:34.619130"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.5ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:45:34.621390"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:45:34.621390"], ["created_at", "2024-03-28 04:45:34.624310"], ["updated_at", "2024-03-28 04:45:34.624310"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 1ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 553)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:45:34.633902"], ["updated_at", "2024-03-28 04:45:34.633902"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:45:34.637223"], ["updated_at", "2024-03-28 04:45:34.637223"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 12:45:34 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (1.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:45:34"], ["created_at", "2024-03-28 04:45:34.645445"], ["updated_at", "2024-03-28 04:45:34.645445"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.3ms | ActiveRecord: 1.5ms | Allocations: 1465)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:45:34.649517"], ["updated_at", "2024-03-28 04:45:34.649517"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:45:34.651550"], ["updated_at", "2024-03-28 04:45:34.651550"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 12:45:34 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:45:34"], ["created_at", "2024-03-28 04:45:34.658362"], ["updated_at", "2024-03-28 04:45:34.658362"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 1173)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 12:45:34 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 7ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 1944)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:45:34.677489"], ["updated_at", "2024-03-28 04:45:34.677489"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:45:34.680225"], ["updated_at", "2024-03-28 04:45:34.680225"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:45:34.681493"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:45:34.681493"], ["created_at", "2024-03-28 04:45:34.683367"], ["updated_at", "2024-03-28 04:45:34.683367"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 12:45:34 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.3ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 04:45:34"], ["updated_at", "2024-03-28 04:45:34.691606"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.5ms | ActiveRecord: 0.7ms | Allocations: 1422)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (1.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:45:34.701370"], ["updated_at", "2024-03-28 04:45:34.701370"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:45:34.704073"], ["updated_at", "2024-03-28 04:45:34.704073"]]
  [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:45:34.707738"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:45:34.707738"], ["created_at", "2024-03-28 04:45:34.710469"], ["updated_at", "2024-03-28 04:45:34.710469"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 12:45:34 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.0ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.1ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 04:45:34"], ["updated_at", "2024-03-28 04:45:34.717176"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 1268)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:45:34.728218"], ["updated_at", "2024-03-28 04:45:34.728218"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:45:34.731189"], ["updated_at", "2024-03-28 04:45:34.731189"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:45:34.733149"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:45:34.733149"], ["created_at", "2024-03-28 04:45:34.736462"], ["updated_at", "2024-03-28 04:45:34.736462"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 12:45:34 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (6.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 11ms (Views: 0.5ms | ActiveRecord: 6.4ms | Allocations: 1040)
  [1m[35m (2.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:45:34.763734"], ["updated_at", "2024-03-28 04:45:34.763734"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:45:34.767309"], ["updated_at", "2024-03-28 04:45:34.767309"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.5ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:45:34.770437"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:45:34.770437"], ["created_at", "2024-03-28 04:45:34.772962"], ["updated_at", "2024-03-28 04:45:34.772962"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.5ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:45:34.784686"], ["updated_at", "2024-03-28 04:45:34.784686"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:45:34.786926"], ["updated_at", "2024-03-28 04:45:34.786926"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:45:34.788172"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.8ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:45:34.788172"], ["created_at", "2024-03-28 04:45:34.789776"], ["updated_at", "2024-03-28 04:45:34.789776"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 0.4ms | Allocations: 357)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.3ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 8ms (Views: 4.7ms | ActiveRecord: 0.3ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:45:34.824556"], ["updated_at", "2024-03-28 04:45:34.824556"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 7ms (Views: 5.6ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 4ms (ActiveRecord: 0.0ms | Allocations: 481)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 4ms (ActiveRecord: 0.0ms | Allocations: 388)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (2.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", ""], ["rule_data", "{}"], ["created_at", "2024-03-28 04:45:34.920602"], ["updated_at", "2024-03-28 04:45:34.920602"]]
  [1m[35m (1.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 10ms (Views: 2.5ms | ActiveRecord: 2.0ms | Allocations: 948)
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:45:34.933934"], ["updated_at", "2024-03-28 04:45:34.933934"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 04:45:34.943296"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 11ms (Views: 3.1ms | ActiveRecord: 0.3ms | Allocations: 1219)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:45:34.952293"], ["updated_at", "2024-03-28 04:45:34.952293"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 04:45:34.958327"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 1181)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:45:34.966317"], ["updated_at", "2024-03-28 04:45:34.966317"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", ""], ["rule_data", "{}"], ["updated_at", "2024-03-28 04:45:34.973326"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 1047)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:45:34.980840"], ["updated_at", "2024-03-28 04:45:34.980840"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.5ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (4.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:45:34.998740"], ["updated_at", "2024-03-28 04:45:34.998740"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 280)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:45:35.016319"], ["updated_at", "2024-03-28 04:45:35.016319"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 143ms (Views: 1.2ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (1.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:45:35.172938"], ["updated_at", "2024-03-28 04:45:35.172938"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 1.4ms | ActiveRecord: 0.6ms | Allocations: 763)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:45:35.217216"], ["updated_at", "2024-03-28 04:45:35.217216"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.7ms | ActiveRecord: 1.1ms | Allocations: 761)
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:45:35.230770"], ["updated_at", "2024-03-28 04:45:35.230770"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.4ms | ActiveRecord: 0.8ms | Allocations: 761)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:45:35.237947"], ["updated_at", "2024-03-28 04:45:35.237947"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 04:45:35.243377"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 842)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.9ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:45:35.249777"], ["updated_at", "2024-03-28 04:45:35.249777"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 04:45:35.256143"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 806)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:45:35.262807"], ["updated_at", "2024-03-28 04:45:35.262807"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 04:45:35.273922"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 848)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:45:35.278964"], ["updated_at", "2024-03-28 04:45:35.278964"]]
  [1m[35m (2.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:45:35.303357"], ["updated_at", "2024-03-28 04:45:35.303357"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 12:45:35 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 12:45:35 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:45:35.358255"], ["updated_at", "2024-03-28 04:45:35.358255"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:45:35.360043"], ["updated_at", "2024-03-28 04:45:35.360043"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:45:35"], ["created_at", "2024-03-28 04:45:35.363112"], ["updated_at", "2024-03-28 04:45:35.363112"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 16ms (Views: 0.6ms | ActiveRecord: 1.4ms | Allocations: 2918)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 12:45:35 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 04:45:35.387480"], ["updated_at", "2024-03-28 04:45:35.387480"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 04:45:35.389910"], ["updated_at", "2024-03-28 04:45:35.389910"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 04:45:35.392569"], ["updated_at", "2024-03-28 04:45:35.392569"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 8ms (Views: 0.5ms | ActiveRecord: 1.5ms | Allocations: 2277)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 6ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 12:51:24 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:51:24.371606"], ["updated_at", "2024-03-28 04:51:24.371606"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:51:24.403384"], ["updated_at", "2024-03-28 04:51:24.403384"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:51:24"], ["created_at", "2024-03-28 04:51:24.422231"], ["updated_at", "2024-03-28 04:51:24.422231"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 65ms (Views: 0.7ms | ActiveRecord: 2.9ms | Allocations: 16853)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 12:51:24 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.9ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:51:24.433738"], ["updated_at", "2024-03-28 04:51:24.433738"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:51:24.436784"], ["updated_at", "2024-03-28 04:51:24.436784"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:51:24"], ["created_at", "2024-03-28 04:51:24.441445"], ["updated_at", "2024-03-28 04:51:24.441445"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 12ms (Views: 2.3ms | ActiveRecord: 2.0ms | Allocations: 2633)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 04:51:24.451185"], ["updated_at", "2024-03-28 04:51:24.451185"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 04:51:24.453028"], ["updated_at", "2024-03-28 04:51:24.453028"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 04:51:24.456953"], ["updated_at", "2024-03-28 04:51:24.456953"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 9ms (Views: 0.9ms | ActiveRecord: 1.5ms | Allocations: 2264)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 1ms (Views: 0.7ms | ActiveRecord: 0.3ms | Allocations: 324)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:51:24.477983"], ["updated_at", "2024-03-28 04:51:24.477983"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:51:24.481663"], ["updated_at", "2024-03-28 04:51:24.481663"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:51:24.483382"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:51:24.483382"], ["created_at", "2024-03-28 04:51:24.485604"], ["updated_at", "2024-03-28 04:51:24.485604"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.3ms | Allocations: 553)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:51:24.497715"], ["updated_at", "2024-03-28 04:51:24.497715"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:51:24.500389"], ["updated_at", "2024-03-28 04:51:24.500389"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 12:51:24 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:51:24"], ["created_at", "2024-03-28 04:51:24.508602"], ["updated_at", "2024-03-28 04:51:24.508602"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.3ms | ActiveRecord: 0.6ms | Allocations: 1465)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (2.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (2.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:51:24.522280"], ["updated_at", "2024-03-28 04:51:24.522280"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:51:24.524681"], ["updated_at", "2024-03-28 04:51:24.524681"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 12:51:24 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:51:24"], ["created_at", "2024-03-28 04:51:24.531861"], ["updated_at", "2024-03-28 04:51:24.531861"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 7ms (Views: 0.3ms | ActiveRecord: 0.6ms | Allocations: 1173)
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 12:51:24 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 7ms (Views: 0.5ms | ActiveRecord: 0.0ms | Allocations: 1944)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:51:24.551870"], ["updated_at", "2024-03-28 04:51:24.551870"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:51:24.554899"], ["updated_at", "2024-03-28 04:51:24.554899"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:51:24.555996"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:51:24.555996"], ["created_at", "2024-03-28 04:51:24.557627"], ["updated_at", "2024-03-28 04:51:24.557627"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 12:51:24 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.9ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.4ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 04:51:24"], ["updated_at", "2024-03-28 04:51:24.563736"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.4ms | ActiveRecord: 1.6ms | Allocations: 1422)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:51:24.571707"], ["updated_at", "2024-03-28 04:51:24.571707"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:51:24.573281"], ["updated_at", "2024-03-28 04:51:24.573281"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:51:24.574570"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:51:24.574570"], ["created_at", "2024-03-28 04:51:24.575467"], ["updated_at", "2024-03-28 04:51:24.575467"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 12:51:24 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 04:51:24"], ["updated_at", "2024-03-28 04:51:24.582951"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 1268)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:51:24.589473"], ["updated_at", "2024-03-28 04:51:24.589473"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:51:24.591052"], ["updated_at", "2024-03-28 04:51:24.591052"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:51:24.591939"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:51:24.591939"], ["created_at", "2024-03-28 04:51:24.592947"], ["updated_at", "2024-03-28 04:51:24.592947"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 12:51:24 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 3ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 1040)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:51:24.606341"], ["updated_at", "2024-03-28 04:51:24.606341"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:51:24.607921"], ["updated_at", "2024-03-28 04:51:24.607921"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:51:24.609304"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:51:24.609304"], ["created_at", "2024-03-28 04:51:24.611809"], ["updated_at", "2024-03-28 04:51:24.611809"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:51:24.623258"], ["updated_at", "2024-03-28 04:51:24.623258"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:51:24.625274"], ["updated_at", "2024-03-28 04:51:24.625274"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:51:24.626261"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.6ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:51:24.626261"], ["created_at", "2024-03-28 04:51:24.628063"], ["updated_at", "2024-03-28 04:51:24.628063"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 5ms (ActiveRecord: 0.3ms | Allocations: 357)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 6ms (Views: 4.0ms | ActiveRecord: 0.2ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:51:24.659338"], ["updated_at", "2024-03-28 04:51:24.659338"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 5ms (Views: 0.6ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms | Allocations: 481)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 10ms (ActiveRecord: 0.0ms | Allocations: 388)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", ""], ["rule_data", "{}"], ["created_at", "2024-03-28 04:51:24.743602"], ["updated_at", "2024-03-28 04:51:24.743602"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 10ms (Views: 0.6ms | ActiveRecord: 0.9ms | Allocations: 946)
  [1m[35m (1.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (1.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:51:24.756955"], ["updated_at", "2024-03-28 04:51:24.756955"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 04:51:24.773265"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 1219)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (1.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:51:24.783845"], ["updated_at", "2024-03-28 04:51:24.783845"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 04:51:24.790068"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 1181)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:51:24.801412"], ["updated_at", "2024-03-28 04:51:24.801412"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", ""], ["rule_data", "{}"], ["updated_at", "2024-03-28 04:51:24.809173"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.4ms | ActiveRecord: 0.3ms | Allocations: 1047)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:51:24.814884"], ["updated_at", "2024-03-28 04:51:24.814884"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.5ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:51:24.825826"], ["updated_at", "2024-03-28 04:51:24.825826"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 4ms (Views: 1.7ms | ActiveRecord: 0.2ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:51:24.843047"], ["updated_at", "2024-03-28 04:51:24.843047"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 3ms (Views: 1.2ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:51:24.857240"], ["updated_at", "2024-03-28 04:51:24.857240"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 3ms (Views: 0.3ms | ActiveRecord: 0.5ms | Allocations: 763)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:51:24.863962"], ["updated_at", "2024-03-28 04:51:24.863962"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 761)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:51:24.880795"], ["updated_at", "2024-03-28 04:51:24.880795"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.4ms | ActiveRecord: 1.0ms | Allocations: 761)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:51:24.894730"], ["updated_at", "2024-03-28 04:51:24.894730"]]
  [1m[35m (1.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 04:51:24.913894"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.5ms | ActiveRecord: 0.5ms | Allocations: 842)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:51:24.920907"], ["updated_at", "2024-03-28 04:51:24.920907"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 04:51:24.924756"], ["id", 1]]
  [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.5ms | ActiveRecord: 1.0ms | Allocations: 806)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:51:24.932594"], ["updated_at", "2024-03-28 04:51:24.932594"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 04:51:24.938316"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 1.0ms | ActiveRecord: 0.4ms | Allocations: 848)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:51:24.944979"], ["updated_at", "2024-03-28 04:51:24.944979"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:51:24.955709"], ["updated_at", "2024-03-28 04:51:24.955709"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 356)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 12:51:24 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 12:51:24 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.0ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:51:25.011532"], ["updated_at", "2024-03-28 04:51:25.011532"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:51:25.020635"], ["updated_at", "2024-03-28 04:51:25.020635"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:51:24"], ["created_at", "2024-03-28 04:51:25.023402"], ["updated_at", "2024-03-28 04:51:25.023402"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 24ms (Views: 0.6ms | ActiveRecord: 1.8ms | Allocations: 2918)
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 12:51:25 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 04:51:25.043975"], ["updated_at", "2024-03-28 04:51:25.043975"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.3ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 04:51:25.046473"], ["updated_at", "2024-03-28 04:51:25.046473"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 04:51:25.056597"], ["updated_at", "2024-03-28 04:51:25.056597"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 15ms (Views: 0.5ms | ActiveRecord: 2.2ms | Allocations: 2277)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 12:57:30 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:57:30.067132"], ["updated_at", "2024-03-28 04:57:30.067132"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:57:30.098690"], ["updated_at", "2024-03-28 04:57:30.098690"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:57:30"], ["created_at", "2024-03-28 04:57:30.119375"], ["updated_at", "2024-03-28 04:57:30.119375"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 65ms (Views: 0.8ms | ActiveRecord: 2.4ms | Allocations: 16851)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (1.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 12:57:30 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:57:30.131234"], ["updated_at", "2024-03-28 04:57:30.131234"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:57:30.133462"], ["updated_at", "2024-03-28 04:57:30.133462"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:57:30"], ["created_at", "2024-03-28 04:57:30.138080"], ["updated_at", "2024-03-28 04:57:30.138080"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 9ms (Views: 0.6ms | ActiveRecord: 1.5ms | Allocations: 2633)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 04:57:30.146307"], ["updated_at", "2024-03-28 04:57:30.146307"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 04:57:30.148690"], ["updated_at", "2024-03-28 04:57:30.148690"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (9.8ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 04:57:30.152913"], ["updated_at", "2024-03-28 04:57:30.152913"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 21ms (Views: 0.6ms | ActiveRecord: 11.1ms | Allocations: 2264)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 1ms (Views: 0.6ms | ActiveRecord: 0.2ms | Allocations: 324)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:57:30.183762"], ["updated_at", "2024-03-28 04:57:30.183762"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:57:30.187468"], ["updated_at", "2024-03-28 04:57:30.187468"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:57:30.189256"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:57:30.189256"], ["created_at", "2024-03-28 04:57:30.193007"], ["updated_at", "2024-03-28 04:57:30.193007"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 3ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 553)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:57:30.203339"], ["updated_at", "2024-03-28 04:57:30.203339"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:57:30.204866"], ["updated_at", "2024-03-28 04:57:30.204866"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 12:57:30 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:57:30"], ["created_at", "2024-03-28 04:57:30.213411"], ["updated_at", "2024-03-28 04:57:30.213411"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.3ms | ActiveRecord: 0.6ms | Allocations: 1465)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:57:30.218588"], ["updated_at", "2024-03-28 04:57:30.218588"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:57:30.221679"], ["updated_at", "2024-03-28 04:57:30.221679"]]
  [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 12:57:30 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:57:30"], ["created_at", "2024-03-28 04:57:30.231999"], ["updated_at", "2024-03-28 04:57:30.231999"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 1173)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 12:57:30 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 14ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 1944)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.0ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:57:30.256340"], ["updated_at", "2024-03-28 04:57:30.256340"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:57:30.260730"], ["updated_at", "2024-03-28 04:57:30.260730"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:57:30.265378"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (1.0ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:57:30.265378"], ["created_at", "2024-03-28 04:57:30.266826"], ["updated_at", "2024-03-28 04:57:30.266826"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 12:57:30 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.3ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.5ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 04:57:30"], ["updated_at", "2024-03-28 04:57:30.275922"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.3ms | ActiveRecord: 1.2ms | Allocations: 1422)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:57:30.285285"], ["updated_at", "2024-03-28 04:57:30.285285"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:57:30.288595"], ["updated_at", "2024-03-28 04:57:30.288595"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:57:30.290623"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:57:30.290623"], ["created_at", "2024-03-28 04:57:30.291693"], ["updated_at", "2024-03-28 04:57:30.291693"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 12:57:30 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.1ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 04:57:30"], ["updated_at", "2024-03-28 04:57:30.303104"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 1268)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:57:30.309012"], ["updated_at", "2024-03-28 04:57:30.309012"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:57:30.311496"], ["updated_at", "2024-03-28 04:57:30.311496"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:57:30.312604"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:57:30.312604"], ["created_at", "2024-03-28 04:57:30.315175"], ["updated_at", "2024-03-28 04:57:30.315175"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 12:57:30 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 3ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 1040)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:57:30.329088"], ["updated_at", "2024-03-28 04:57:30.329088"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:57:30.333062"], ["updated_at", "2024-03-28 04:57:30.333062"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:57:30.334893"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:57:30.334893"], ["created_at", "2024-03-28 04:57:30.336719"], ["updated_at", "2024-03-28 04:57:30.336719"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:57:30.348152"], ["updated_at", "2024-03-28 04:57:30.348152"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:57:30.354869"], ["updated_at", "2024-03-28 04:57:30.354869"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:57:30.363003"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:57:30.363003"], ["created_at", "2024-03-28 04:57:30.369040"], ["updated_at", "2024-03-28 04:57:30.369040"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 8ms (ActiveRecord: 0.4ms | Allocations: 357)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (2.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 3ms (Views: 0.6ms | ActiveRecord: 2.2ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.9ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:57:30.403439"], ["updated_at", "2024-03-28 04:57:30.403439"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 6ms (Views: 4.7ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms | Allocations: 481)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms | Allocations: 388)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", ""], ["rule_data", "{}"], ["created_at", "2024-03-28 04:57:30.479333"], ["updated_at", "2024-03-28 04:57:30.479333"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.5ms | ActiveRecord: 1.8ms | Allocations: 948)
  [1m[35m (1.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:57:30.489701"], ["updated_at", "2024-03-28 04:57:30.489701"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 04:57:30.495987"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 1219)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:57:30.504591"], ["updated_at", "2024-03-28 04:57:30.504591"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.6ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 04:57:30.511088"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 2.8ms | ActiveRecord: 0.9ms | Allocations: 1181)
  [1m[35m (74.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:57:30.606186"], ["updated_at", "2024-03-28 04:57:30.606186"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", ""], ["rule_data", "{}"], ["updated_at", "2024-03-28 04:57:30.612318"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 22ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 1047)
  [1m[35m (1.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:57:30.637579"], ["updated_at", "2024-03-28 04:57:30.637579"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (19.6ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:57:30.683161"], ["updated_at", "2024-03-28 04:57:30.683161"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.5ms | Allocations: 356)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 1ms (Views: 0.6ms | ActiveRecord: 0.2ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:57:30.709365"], ["updated_at", "2024-03-28 04:57:30.709365"]]
  [1m[35m (1.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 480)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (2.0ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:57:30.723353"], ["updated_at", "2024-03-28 04:57:30.723353"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.4ms | ActiveRecord: 2.2ms | Allocations: 763)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:57:30.733136"], ["updated_at", "2024-03-28 04:57:30.733136"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 3ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 761)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:57:30.744729"], ["updated_at", "2024-03-28 04:57:30.744729"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 17ms (Views: 8.5ms | ActiveRecord: 0.8ms | Allocations: 761)
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:57:30.766305"], ["updated_at", "2024-03-28 04:57:30.766305"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 04:57:30.772493"], ["id", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 14ms (Views: 0.6ms | ActiveRecord: 0.6ms | Allocations: 842)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (4.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:57:30.789921"], ["updated_at", "2024-03-28 04:57:30.789921"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 04:57:30.799914"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 806)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.9ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:57:30.805627"], ["updated_at", "2024-03-28 04:57:30.805627"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (3.0ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 04:57:30.828531"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 11ms (Views: 2.4ms | ActiveRecord: 3.5ms | Allocations: 848)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (5.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:57:30.838260"], ["updated_at", "2024-03-28 04:57:30.838260"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.4ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (1.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.9ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:57:30.863894"], ["updated_at", "2024-03-28 04:57:30.863894"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 12:57:30 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 12:57:30 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 04:57:30.932641"], ["updated_at", "2024-03-28 04:57:30.932641"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 04:57:30.935079"], ["updated_at", "2024-03-28 04:57:30.935079"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 04:57:30"], ["created_at", "2024-03-28 04:57:30.937998"], ["updated_at", "2024-03-28 04:57:30.937998"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 18ms (Views: 0.7ms | ActiveRecord: 1.6ms | Allocations: 2918)
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 12:57:30 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 04:57:30.955274"], ["updated_at", "2024-03-28 04:57:30.955274"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 04:57:30.956716"], ["updated_at", "2024-03-28 04:57:30.956716"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 04:57:30.958736"], ["updated_at", "2024-03-28 04:57:30.958736"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.5ms | ActiveRecord: 1.1ms | Allocations: 2277)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:03:39 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.0ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:03:39.537745"], ["updated_at", "2024-03-28 05:03:39.537745"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:03:39.572066"], ["updated_at", "2024-03-28 05:03:39.572066"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:03:39"], ["created_at", "2024-03-28 05:03:39.593318"], ["updated_at", "2024-03-28 05:03:39.593318"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 67ms (Views: 1.0ms | ActiveRecord: 3.2ms | Allocations: 16853)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (2.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:03:39 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.0ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:03:39.607176"], ["updated_at", "2024-03-28 05:03:39.607176"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:03:39.612167"], ["updated_at", "2024-03-28 05:03:39.612167"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.3ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (1.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:03:39"], ["created_at", "2024-03-28 05:03:39.616270"], ["updated_at", "2024-03-28 05:03:39.616270"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 13ms (Views: 0.7ms | ActiveRecord: 4.2ms | Allocations: 2633)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 05:03:39.627721"], ["updated_at", "2024-03-28 05:03:39.627721"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 05:03:39.631003"], ["updated_at", "2024-03-28 05:03:39.631003"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 05:03:39.635181"], ["updated_at", "2024-03-28 05:03:39.635181"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 10ms (Views: 0.7ms | ActiveRecord: 1.4ms | Allocations: 2264)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 324)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:03:39.655295"], ["updated_at", "2024-03-28 05:03:39.655295"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:03:39.661100"], ["updated_at", "2024-03-28 05:03:39.661100"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:03:39.662682"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:03:39.662682"], ["created_at", "2024-03-28 05:03:39.665969"], ["updated_at", "2024-03-28 05:03:39.665969"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 1.3ms | ActiveRecord: 0.1ms | Allocations: 553)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:03:39.675720"], ["updated_at", "2024-03-28 05:03:39.675720"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.9ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:03:39.678071"], ["updated_at", "2024-03-28 05:03:39.678071"]]
  [1m[35m (2.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 13:03:39 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:03:39"], ["created_at", "2024-03-28 05:03:39.689540"], ["updated_at", "2024-03-28 05:03:39.689540"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.5ms | ActiveRecord: 1.0ms | Allocations: 1465)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:03:39.696248"], ["updated_at", "2024-03-28 05:03:39.696248"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:03:39.700756"], ["updated_at", "2024-03-28 05:03:39.700756"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 13:03:39 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.7ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:03:39"], ["created_at", "2024-03-28 05:03:39.706825"], ["updated_at", "2024-03-28 05:03:39.706825"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.4ms | ActiveRecord: 1.1ms | Allocations: 1173)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:03:39 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 5ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 1944)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:03:39.726737"], ["updated_at", "2024-03-28 05:03:39.726737"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:03:39.728975"], ["updated_at", "2024-03-28 05:03:39.728975"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:03:39.733168"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:03:39.733168"], ["created_at", "2024-03-28 05:03:39.734609"], ["updated_at", "2024-03-28 05:03:39.734609"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:03:39 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 05:03:39"], ["updated_at", "2024-03-28 05:03:39.741472"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 1422)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:03:39.750169"], ["updated_at", "2024-03-28 05:03:39.750169"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:03:39.752425"], ["updated_at", "2024-03-28 05:03:39.752425"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:03:39.753702"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:03:39.753702"], ["created_at", "2024-03-28 05:03:39.756751"], ["updated_at", "2024-03-28 05:03:39.756751"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:03:39 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.5ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 05:03:39"], ["updated_at", "2024-03-28 05:03:39.765513"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 1.0ms | Allocations: 1268)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:03:39.770350"], ["updated_at", "2024-03-28 05:03:39.770350"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:03:39.772964"], ["updated_at", "2024-03-28 05:03:39.772964"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:03:39.776624"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:03:39.776624"], ["created_at", "2024-03-28 05:03:39.778588"], ["updated_at", "2024-03-28 05:03:39.778588"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:03:39 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 2ms (Views: 0.2ms | ActiveRecord: 0.2ms | Allocations: 1040)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:03:39.787415"], ["updated_at", "2024-03-28 05:03:39.787415"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:03:39.789912"], ["updated_at", "2024-03-28 05:03:39.789912"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:03:39.793055"], ["LIMIT", 1]]
  [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (1.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:03:39.793055"], ["created_at", "2024-03-28 05:03:39.794521"], ["updated_at", "2024-03-28 05:03:39.794521"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:03:39.805074"], ["updated_at", "2024-03-28 05:03:39.805074"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:03:39.807744"], ["updated_at", "2024-03-28 05:03:39.807744"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:03:39.811690"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:03:39.811690"], ["created_at", "2024-03-28 05:03:39.817362"], ["updated_at", "2024-03-28 05:03:39.817362"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.6ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 5ms (ActiveRecord: 0.9ms | Allocations: 357)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 4ms (Views: 3.1ms | ActiveRecord: 0.2ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:03:39.857560"], ["updated_at", "2024-03-28 05:03:39.857560"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 4ms (Views: 0.6ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms | Allocations: 503)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms | Allocations: 410)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", ""], ["rule_data", "{}"], ["created_at", "2024-03-28 05:03:39.935271"], ["updated_at", "2024-03-28 05:03:39.935271"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 948)
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:03:39.944543"], ["updated_at", "2024-03-28 05:03:39.944543"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 05:03:39.954029"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 1219)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:03:39.961162"], ["updated_at", "2024-03-28 05:03:39.961162"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 05:03:39.970325"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 1181)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:03:39.976825"], ["updated_at", "2024-03-28 05:03:39.976825"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", ""], ["rule_data", "{}"], ["updated_at", "2024-03-28 05:03:39.984590"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 1047)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.9ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:03:39.989833"], ["updated_at", "2024-03-28 05:03:39.989833"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.6ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:03:40.003172"], ["updated_at", "2024-03-28 05:03:40.003172"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 1ms (Views: 0.7ms | ActiveRecord: 0.2ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:03:40.021320"], ["updated_at", "2024-03-28 05:03:40.021320"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 3ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (7.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:03:40.045654"], ["updated_at", "2024-03-28 05:03:40.045654"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 32ms (Views: 1.2ms | ActiveRecord: 7.9ms | Allocations: 763)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:03:40.083481"], ["updated_at", "2024-03-28 05:03:40.083481"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 3ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 761)
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:03:40.094371"], ["updated_at", "2024-03-28 05:03:40.094371"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.7ms | ActiveRecord: 0.9ms | Allocations: 761)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:03:40.102368"], ["updated_at", "2024-03-28 05:03:40.102368"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 05:03:40.106199"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.5ms | ActiveRecord: 0.4ms | Allocations: 842)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:03:40.113642"], ["updated_at", "2024-03-28 05:03:40.113642"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 05:03:40.119580"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 806)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:03:40.125602"], ["updated_at", "2024-03-28 05:03:40.125602"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 05:03:40.179751"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 43ms (Views: 0.6ms | ActiveRecord: 0.5ms | Allocations: 848)
  [1m[35m (2.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:03:40.227554"], ["updated_at", "2024-03-28 05:03:40.227554"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 363)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:03:40.241196"], ["updated_at", "2024-03-28 05:03:40.241196"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 356)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 13:03:40 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 13:03:40 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:03:40.329058"], ["updated_at", "2024-03-28 05:03:40.329058"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:03:40.331586"], ["updated_at", "2024-03-28 05:03:40.331586"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:03:40"], ["created_at", "2024-03-28 05:03:40.334533"], ["updated_at", "2024-03-28 05:03:40.334533"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 21ms (Views: 1.3ms | ActiveRecord: 1.4ms | Allocations: 2918)
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 13:03:40 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 05:03:40.354312"], ["updated_at", "2024-03-28 05:03:40.354312"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 05:03:40.357167"], ["updated_at", "2024-03-28 05:03:40.357167"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 05:03:40.361285"], ["updated_at", "2024-03-28 05:03:40.361285"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 10ms (Views: 0.8ms | ActiveRecord: 2.2ms | Allocations: 2277)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 8ms (Views: 0.6ms | ActiveRecord: 1.1ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:04:49 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:04:49.292275"], ["updated_at", "2024-03-28 05:04:49.292275"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:04:49.326412"], ["updated_at", "2024-03-28 05:04:49.326412"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:04:49"], ["created_at", "2024-03-28 05:04:49.348691"], ["updated_at", "2024-03-28 05:04:49.348691"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 70ms (Views: 0.9ms | ActiveRecord: 3.0ms | Allocations: 16854)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:04:49 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:04:49.360042"], ["updated_at", "2024-03-28 05:04:49.360042"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:04:49.363899"], ["updated_at", "2024-03-28 05:04:49.363899"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:04:49"], ["created_at", "2024-03-28 05:04:49.367706"], ["updated_at", "2024-03-28 05:04:49.367706"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 12ms (Views: 2.4ms | ActiveRecord: 2.6ms | Allocations: 2633)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 05:04:49.377013"], ["updated_at", "2024-03-28 05:04:49.377013"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 05:04:49.379386"], ["updated_at", "2024-03-28 05:04:49.379386"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 05:04:49.384504"], ["updated_at", "2024-03-28 05:04:49.384504"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 10ms (Views: 0.6ms | ActiveRecord: 1.6ms | Allocations: 2264)
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (1.5ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 3ms (Views: 0.8ms | ActiveRecord: 1.5ms | Allocations: 324)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:04:49.407324"], ["updated_at", "2024-03-28 05:04:49.407324"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:04:49.409468"], ["updated_at", "2024-03-28 05:04:49.409468"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:04:49.413435"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.7ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:04:49.413435"], ["created_at", "2024-03-28 05:04:49.416417"], ["updated_at", "2024-03-28 05:04:49.416417"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.4ms | ActiveRecord: 0.2ms | Allocations: 553)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (1.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (2.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:04:49.431851"], ["updated_at", "2024-03-28 05:04:49.431851"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:04:49.440239"], ["updated_at", "2024-03-28 05:04:49.440239"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 13:04:49 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:04:49"], ["created_at", "2024-03-28 05:04:49.448499"], ["updated_at", "2024-03-28 05:04:49.448499"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 1465)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:04:49.455207"], ["updated_at", "2024-03-28 05:04:49.455207"]]
  [1m[35m (1.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:04:49.460161"], ["updated_at", "2024-03-28 05:04:49.460161"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 13:04:49 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:04:49"], ["created_at", "2024-03-28 05:04:49.468326"], ["updated_at", "2024-03-28 05:04:49.468326"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 1173)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:04:49 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 7ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 1944)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:04:49.487524"], ["updated_at", "2024-03-28 05:04:49.487524"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:04:49.489840"], ["updated_at", "2024-03-28 05:04:49.489840"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:04:49.491169"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.5ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:04:49.491169"], ["created_at", "2024-03-28 05:04:49.492497"], ["updated_at", "2024-03-28 05:04:49.492497"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:04:49 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.3ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 05:04:49"], ["updated_at", "2024-03-28 05:04:49.499508"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.6ms | ActiveRecord: 0.7ms | Allocations: 1422)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:04:49.510600"], ["updated_at", "2024-03-28 05:04:49.510600"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:04:49.513086"], ["updated_at", "2024-03-28 05:04:49.513086"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:04:49.515543"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.6ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:04:49.515543"], ["created_at", "2024-03-28 05:04:49.517731"], ["updated_at", "2024-03-28 05:04:49.517731"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:04:49 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.1ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 05:04:49"], ["updated_at", "2024-03-28 05:04:49.523858"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.5ms | ActiveRecord: 0.5ms | Allocations: 1268)
  [1m[35m (2.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:04:49.531752"], ["updated_at", "2024-03-28 05:04:49.531752"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:04:49.533543"], ["updated_at", "2024-03-28 05:04:49.533543"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:04:49.535425"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.5ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:04:49.535425"], ["created_at", "2024-03-28 05:04:49.537472"], ["updated_at", "2024-03-28 05:04:49.537472"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:04:49 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 3ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 1040)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:04:49.550274"], ["updated_at", "2024-03-28 05:04:49.550274"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:04:49.554287"], ["updated_at", "2024-03-28 05:04:49.554287"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:04:49.556965"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.5ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:04:49.556965"], ["created_at", "2024-03-28 05:04:49.559441"], ["updated_at", "2024-03-28 05:04:49.559441"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (1.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:04:49.569803"], ["updated_at", "2024-03-28 05:04:49.569803"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:04:49.573761"], ["updated_at", "2024-03-28 05:04:49.573761"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:04:49.577414"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:04:49.577414"], ["created_at", "2024-03-28 05:04:49.579373"], ["updated_at", "2024-03-28 05:04:49.579373"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.5ms | Allocations: 357)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.5ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 5ms (Views: 3.5ms | ActiveRecord: 0.5ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:04:49.611220"], ["updated_at", "2024-03-28 05:04:49.611220"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 5ms (Views: 3.6ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 6ms (ActiveRecord: 0.0ms | Allocations: 503)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (3.0ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 10ms (ActiveRecord: 0.0ms | Allocations: 410)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", ""], ["rule_data", "{}"], ["created_at", "2024-03-28 05:04:49.703609"], ["updated_at", "2024-03-28 05:04:49.703609"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 946)
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:04:49.715185"], ["updated_at", "2024-03-28 05:04:49.715185"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 05:04:49.722259"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.6ms | ActiveRecord: 0.3ms | Allocations: 1220)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:04:49.731202"], ["updated_at", "2024-03-28 05:04:49.731202"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 05:04:49.739788"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 1181)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:04:49.746084"], ["updated_at", "2024-03-28 05:04:49.746084"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", ""], ["rule_data", "{}"], ["updated_at", "2024-03-28 05:04:49.756367"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 1047)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:04:49.762463"], ["updated_at", "2024-03-28 05:04:49.762463"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.8ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 8ms (ActiveRecord: 1.2ms | Allocations: 363)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:04:49.779998"], ["updated_at", "2024-03-28 05:04:49.779998"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (5.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.5ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 8ms (ActiveRecord: 6.5ms | Allocations: 356)
  [1m[35m (2.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:04:49.812734"], ["updated_at", "2024-03-28 05:04:49.812734"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.6ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:04:49.834720"], ["updated_at", "2024-03-28 05:04:49.834720"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.6ms | ActiveRecord: 0.8ms | Allocations: 763)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (2.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:04:49.860545"], ["updated_at", "2024-03-28 05:04:49.860545"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.8ms | ActiveRecord: 0.8ms | Allocations: 761)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:04:49.869812"], ["updated_at", "2024-03-28 05:04:49.869812"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.5ms | ActiveRecord: 0.8ms | Allocations: 761)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:04:49.878278"], ["updated_at", "2024-03-28 05:04:49.878278"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.3ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 05:04:49.883478"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 842)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:04:49.890321"], ["updated_at", "2024-03-28 05:04:49.890321"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 05:04:49.895093"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 806)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:04:49.901010"], ["updated_at", "2024-03-28 05:04:49.901010"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 05:04:49.906583"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.4ms | ActiveRecord: 0.3ms | Allocations: 848)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:04:49.912687"], ["updated_at", "2024-03-28 05:04:49.912687"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:04:49.923378"], ["updated_at", "2024-03-28 05:04:49.923378"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (5.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 9ms (ActiveRecord: 5.4ms | Allocations: 356)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 13:04:49 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 13:04:49 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:04:49.999542"], ["updated_at", "2024-03-28 05:04:49.999542"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:04:50.001906"], ["updated_at", "2024-03-28 05:04:50.001906"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:04:49"], ["created_at", "2024-03-28 05:04:50.005152"], ["updated_at", "2024-03-28 05:04:50.005152"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 22ms (Views: 1.0ms | ActiveRecord: 1.6ms | Allocations: 2918)
  [1m[35m (1.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 13:04:50 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 05:04:50.025827"], ["updated_at", "2024-03-28 05:04:50.025827"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 05:04:50.031057"], ["updated_at", "2024-03-28 05:04:50.031057"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 05:04:50.033823"], ["updated_at", "2024-03-28 05:04:50.033823"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 12ms (Views: 0.8ms | ActiveRecord: 2.1ms | Allocations: 2277)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:17:20 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.0ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:17:20.957155"], ["updated_at", "2024-03-28 05:17:20.957155"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:17:20.990666"], ["updated_at", "2024-03-28 05:17:20.990666"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:17:20"], ["created_at", "2024-03-28 05:17:21.013877"], ["updated_at", "2024-03-28 05:17:21.013877"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 68ms (Views: 0.7ms | ActiveRecord: 3.0ms | Allocations: 16853)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (1.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:17:21 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:17:21.027137"], ["updated_at", "2024-03-28 05:17:21.027137"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:17:21.029721"], ["updated_at", "2024-03-28 05:17:21.029721"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:17:21"], ["created_at", "2024-03-28 05:17:21.032721"], ["updated_at", "2024-03-28 05:17:21.032721"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 11ms (Views: 1.7ms | ActiveRecord: 1.4ms | Allocations: 2633)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 05:17:21.040772"], ["updated_at", "2024-03-28 05:17:21.040772"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 05:17:21.043737"], ["updated_at", "2024-03-28 05:17:21.043737"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 05:17:21.049003"], ["updated_at", "2024-03-28 05:17:21.049003"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 11ms (Views: 1.0ms | ActiveRecord: 1.8ms | Allocations: 2264)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 2ms (Views: 0.8ms | ActiveRecord: 0.3ms | Allocations: 324)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:17:21.073668"], ["updated_at", "2024-03-28 05:17:21.073668"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:17:21.076910"], ["updated_at", "2024-03-28 05:17:21.076910"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.4ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:17:21.079971"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:17:21.079971"], ["created_at", "2024-03-28 05:17:21.083659"], ["updated_at", "2024-03-28 05:17:21.083659"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.7ms | ActiveRecord: 0.2ms | Allocations: 553)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:17:21.095873"], ["updated_at", "2024-03-28 05:17:21.095873"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:17:21.099599"], ["updated_at", "2024-03-28 05:17:21.099599"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 13:17:21 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:17:21"], ["created_at", "2024-03-28 05:17:21.109595"], ["updated_at", "2024-03-28 05:17:21.109595"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.6ms | ActiveRecord: 0.7ms | Allocations: 1465)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (1.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:17:21.118564"], ["updated_at", "2024-03-28 05:17:21.118564"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:17:21.121500"], ["updated_at", "2024-03-28 05:17:21.121500"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 13:17:21 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:17:21"], ["created_at", "2024-03-28 05:17:21.127657"], ["updated_at", "2024-03-28 05:17:21.127657"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.9ms | ActiveRecord: 0.8ms | Allocations: 1173)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:17:21 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 7ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 1944)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:17:21.150858"], ["updated_at", "2024-03-28 05:17:21.150858"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:17:21.153898"], ["updated_at", "2024-03-28 05:17:21.153898"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.4ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:17:21.156062"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:17:21.156062"], ["created_at", "2024-03-28 05:17:21.159574"], ["updated_at", "2024-03-28 05:17:21.159574"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:17:21 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.4ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 05:17:21"], ["updated_at", "2024-03-28 05:17:21.171366"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 11ms (Views: 0.6ms | ActiveRecord: 1.2ms | Allocations: 1422)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:17:21.185555"], ["updated_at", "2024-03-28 05:17:21.185555"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:17:21.187649"], ["updated_at", "2024-03-28 05:17:21.187649"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:17:21.189215"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:17:21.189215"], ["created_at", "2024-03-28 05:17:21.191390"], ["updated_at", "2024-03-28 05:17:21.191390"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:17:21 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 05:17:21"], ["updated_at", "2024-03-28 05:17:21.200834"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 11ms (Views: 3.3ms | ActiveRecord: 0.7ms | Allocations: 1268)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.0ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:17:21.210430"], ["updated_at", "2024-03-28 05:17:21.210430"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:17:21.220064"], ["updated_at", "2024-03-28 05:17:21.220064"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:17:21.222053"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:17:21.222053"], ["created_at", "2024-03-28 05:17:21.223500"], ["updated_at", "2024-03-28 05:17:21.223500"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:17:21 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 5ms (Views: 0.6ms | ActiveRecord: 0.5ms | Allocations: 1040)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:17:21.235726"], ["updated_at", "2024-03-28 05:17:21.235726"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:17:21.241160"], ["updated_at", "2024-03-28 05:17:21.241160"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:17:21.242436"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:17:21.242436"], ["created_at", "2024-03-28 05:17:21.244079"], ["updated_at", "2024-03-28 05:17:21.244079"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.4ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:17:21.256136"], ["updated_at", "2024-03-28 05:17:21.256136"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:17:21.259255"], ["updated_at", "2024-03-28 05:17:21.259255"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:17:21.263473"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:17:21.263473"], ["created_at", "2024-03-28 05:17:21.266614"], ["updated_at", "2024-03-28 05:17:21.266614"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.7ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 5ms (ActiveRecord: 1.1ms | Allocations: 357)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 3ms (Views: 2.0ms | ActiveRecord: 0.2ms | Allocations: 314)
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:17:21.299666"], ["updated_at", "2024-03-28 05:17:21.299666"]]
  [1m[35m (1.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 4ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 7ms (ActiveRecord: 0.0ms | Allocations: 481)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 5ms (ActiveRecord: 0.0ms | Allocations: 388)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (2.8ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", ""], ["rule_data", "{}"], ["created_at", "2024-03-28 05:17:21.385901"], ["updated_at", "2024-03-28 05:17:21.385901"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 9ms (Views: 2.8ms | ActiveRecord: 0.8ms | Allocations: 946)
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:17:21.403420"], ["updated_at", "2024-03-28 05:17:21.403420"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 05:17:21.408135"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 2.5ms | ActiveRecord: 0.3ms | Allocations: 1220)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:17:21.418408"], ["updated_at", "2024-03-28 05:17:21.418408"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 05:17:21.426782"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 2.5ms | ActiveRecord: 0.5ms | Allocations: 1181)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:17:21.436376"], ["updated_at", "2024-03-28 05:17:21.436376"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.3ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", ""], ["rule_data", "{}"], ["updated_at", "2024-03-28 05:17:21.444817"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.6ms | ActiveRecord: 0.7ms | Allocations: 1047)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:17:21.454421"], ["updated_at", "2024-03-28 05:17:21.454421"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.6ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 9ms (ActiveRecord: 1.0ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:17:21.473572"], ["updated_at", "2024-03-28 05:17:21.473572"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (2.6ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 10ms (ActiveRecord: 3.9ms | Allocations: 356)
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:17:21.525258"], ["updated_at", "2024-03-28 05:17:21.525258"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:17:21.542302"], ["updated_at", "2024-03-28 05:17:21.542302"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.6ms | ActiveRecord: 0.9ms | Allocations: 763)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.9ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:17:21.553183"], ["updated_at", "2024-03-28 05:17:21.553183"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.4ms | ActiveRecord: 1.9ms | Allocations: 761)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:17:21.563209"], ["updated_at", "2024-03-28 05:17:21.563209"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.6ms | ActiveRecord: 1.4ms | Allocations: 761)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:17:21.570821"], ["updated_at", "2024-03-28 05:17:21.570821"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.9ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 05:17:21.574936"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 1.1ms | Allocations: 842)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.0ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:17:21.582425"], ["updated_at", "2024-03-28 05:17:21.582425"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 05:17:21.588409"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 806)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:17:21.593841"], ["updated_at", "2024-03-28 05:17:21.593841"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 05:17:21.605812"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 848)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:17:21.611014"], ["updated_at", "2024-03-28 05:17:21.611014"]]
  [1m[35m (3.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:17:21.625809"], ["updated_at", "2024-03-28 05:17:21.625809"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.9ms | Allocations: 356)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 13:17:21 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 13:17:21 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:17:21.706402"], ["updated_at", "2024-03-28 05:17:21.706402"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:17:21.708476"], ["updated_at", "2024-03-28 05:17:21.708476"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.6ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:17:21"], ["created_at", "2024-03-28 05:17:21.710705"], ["updated_at", "2024-03-28 05:17:21.710705"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 18ms (Views: 0.7ms | ActiveRecord: 1.6ms | Allocations: 2918)
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 13:17:21 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 05:17:21.728257"], ["updated_at", "2024-03-28 05:17:21.728257"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.3ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 05:17:21.730560"], ["updated_at", "2024-03-28 05:17:21.730560"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 05:17:21.734561"], ["updated_at", "2024-03-28 05:17:21.734561"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 9ms (Views: 0.5ms | ActiveRecord: 1.8ms | Allocations: 2277)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:20:16 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:20:16.650002"], ["updated_at", "2024-03-28 05:20:16.650002"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:20:16.681568"], ["updated_at", "2024-03-28 05:20:16.681568"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:20:16"], ["created_at", "2024-03-28 05:20:16.703198"], ["updated_at", "2024-03-28 05:20:16.703198"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 66ms (Views: 0.7ms | ActiveRecord: 2.4ms | Allocations: 16854)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:20:16 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:20:16.713983"], ["updated_at", "2024-03-28 05:20:16.713983"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:20:16.716485"], ["updated_at", "2024-03-28 05:20:16.716485"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:20:16"], ["created_at", "2024-03-28 05:20:16.719935"], ["updated_at", "2024-03-28 05:20:16.719935"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 11ms (Views: 2.2ms | ActiveRecord: 1.5ms | Allocations: 2633)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 05:20:16.728607"], ["updated_at", "2024-03-28 05:20:16.728607"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 05:20:16.730521"], ["updated_at", "2024-03-28 05:20:16.730521"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 05:20:16.735427"], ["updated_at", "2024-03-28 05:20:16.735427"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 9ms (Views: 0.6ms | ActiveRecord: 1.4ms | Allocations: 2264)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.4ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 1ms (Views: 0.7ms | ActiveRecord: 0.3ms | Allocations: 324)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:20:16.751547"], ["updated_at", "2024-03-28 05:20:16.751547"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:20:16.754644"], ["updated_at", "2024-03-28 05:20:16.754644"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:20:16.758100"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:20:16.758100"], ["created_at", "2024-03-28 05:20:16.759762"], ["updated_at", "2024-03-28 05:20:16.759762"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.7ms | ActiveRecord: 0.1ms | Allocations: 553)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:20:16.769389"], ["updated_at", "2024-03-28 05:20:16.769389"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:20:16.772257"], ["updated_at", "2024-03-28 05:20:16.772257"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 13:20:16 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:20:16"], ["created_at", "2024-03-28 05:20:16.779299"], ["updated_at", "2024-03-28 05:20:16.779299"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 1465)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:20:16.785729"], ["updated_at", "2024-03-28 05:20:16.785729"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:20:16.788698"], ["updated_at", "2024-03-28 05:20:16.788698"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 13:20:16 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:20:16"], ["created_at", "2024-03-28 05:20:16.797267"], ["updated_at", "2024-03-28 05:20:16.797267"]]
  [1m[35m (1.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 7ms (Views: 0.4ms | ActiveRecord: 2.0ms | Allocations: 1173)
  [1m[35m (2.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:20:16 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 7ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 1944)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:20:16.819489"], ["updated_at", "2024-03-28 05:20:16.819489"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:20:16.823112"], ["updated_at", "2024-03-28 05:20:16.823112"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:20:16.824703"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:20:16.824703"], ["created_at", "2024-03-28 05:20:16.825795"], ["updated_at", "2024-03-28 05:20:16.825795"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:20:16 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.3ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.3ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 05:20:16"], ["updated_at", "2024-03-28 05:20:16.832895"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 1.0ms | Allocations: 1422)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:20:16.840965"], ["updated_at", "2024-03-28 05:20:16.840965"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:20:16.842895"], ["updated_at", "2024-03-28 05:20:16.842895"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:20:16.844714"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:20:16.844714"], ["created_at", "2024-03-28 05:20:16.847306"], ["updated_at", "2024-03-28 05:20:16.847306"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:20:16 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.1ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 05:20:16"], ["updated_at", "2024-03-28 05:20:16.853998"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 1268)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:20:16.859480"], ["updated_at", "2024-03-28 05:20:16.859480"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:20:16.861162"], ["updated_at", "2024-03-28 05:20:16.861162"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:20:16.862063"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:20:16.862063"], ["created_at", "2024-03-28 05:20:16.863872"], ["updated_at", "2024-03-28 05:20:16.863872"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:20:16 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 4ms (Views: 0.2ms | ActiveRecord: 0.5ms | Allocations: 1040)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:20:16.877001"], ["updated_at", "2024-03-28 05:20:16.877001"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:20:16.879192"], ["updated_at", "2024-03-28 05:20:16.879192"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:20:16.882459"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:20:16.882459"], ["created_at", "2024-03-28 05:20:16.884093"], ["updated_at", "2024-03-28 05:20:16.884093"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:20:16.894140"], ["updated_at", "2024-03-28 05:20:16.894140"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:20:16.896958"], ["updated_at", "2024-03-28 05:20:16.896958"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:20:16.899552"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:20:16.899552"], ["created_at", "2024-03-28 05:20:16.900778"], ["updated_at", "2024-03-28 05:20:16.900778"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 357)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 1ms (Views: 0.6ms | ActiveRecord: 0.2ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (3.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:20:16.933308"], ["updated_at", "2024-03-28 05:20:16.933308"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 4ms (Views: 2.6ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 5ms (ActiveRecord: 0.0ms | Allocations: 481)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 6ms (ActiveRecord: 0.0ms | Allocations: 388)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", ""], ["rule_data", "{}"], ["created_at", "2024-03-28 05:20:17.012325"], ["updated_at", "2024-03-28 05:20:17.012325"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.4ms | ActiveRecord: 0.8ms | Allocations: 946)
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:20:17.029847"], ["updated_at", "2024-03-28 05:20:17.029847"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 05:20:17.035525"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.3ms | ActiveRecord: 0.3ms | Allocations: 1220)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:20:17.043133"], ["updated_at", "2024-03-28 05:20:17.043133"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (1.0ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 05:20:17.046725"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.6ms | ActiveRecord: 1.2ms | Allocations: 1181)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (2.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:20:17.053924"], ["updated_at", "2024-03-28 05:20:17.053924"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", ""], ["rule_data", "{}"], ["updated_at", "2024-03-28 05:20:17.062151"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 1047)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:20:17.067632"], ["updated_at", "2024-03-28 05:20:17.067632"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:20:17.079679"], ["updated_at", "2024-03-28 05:20:17.079679"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.5ms | Allocations: 356)
  [1m[35m (2.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:20:17.105769"], ["updated_at", "2024-03-28 05:20:17.105769"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 1ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:20:17.118148"], ["updated_at", "2024-03-28 05:20:17.118148"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.5ms | ActiveRecord: 0.8ms | Allocations: 763)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:20:17.127938"], ["updated_at", "2024-03-28 05:20:17.127938"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 2ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 761)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:20:17.138925"], ["updated_at", "2024-03-28 05:20:17.138925"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.4ms | ActiveRecord: 1.5ms | Allocations: 761)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:20:17.145422"], ["updated_at", "2024-03-28 05:20:17.145422"]]
  [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 05:20:17.151325"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.5ms | ActiveRecord: 0.4ms | Allocations: 842)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:20:17.159549"], ["updated_at", "2024-03-28 05:20:17.159549"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.4ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 05:20:17.164437"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.5ms | ActiveRecord: 0.7ms | Allocations: 806)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:20:17.172175"], ["updated_at", "2024-03-28 05:20:17.172175"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 05:20:17.183284"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 848)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:20:17.198517"], ["updated_at", "2024-03-28 05:20:17.198517"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (3.9ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 8ms (ActiveRecord: 4.2ms | Allocations: 363)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (1.6ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:20:17.230720"], ["updated_at", "2024-03-28 05:20:17.230720"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 13:20:17 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 13:20:17 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:20:17.284663"], ["updated_at", "2024-03-28 05:20:17.284663"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:20:17.287052"], ["updated_at", "2024-03-28 05:20:17.287052"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:20:17"], ["created_at", "2024-03-28 05:20:17.290001"], ["updated_at", "2024-03-28 05:20:17.290001"]]
  [1m[35m (1.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 29ms (Views: 11.1ms | ActiveRecord: 3.0ms | Allocations: 2918)
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 13:20:17 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 05:20:17.323886"], ["updated_at", "2024-03-28 05:20:17.323886"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 05:20:17.325744"], ["updated_at", "2024-03-28 05:20:17.325744"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 05:20:17.328404"], ["updated_at", "2024-03-28 05:20:17.328404"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 7ms (Views: 0.9ms | ActiveRecord: 1.4ms | Allocations: 2277)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.4ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:24:03 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.9ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:24:04.014295"], ["updated_at", "2024-03-28 05:24:04.014295"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:24:04.049314"], ["updated_at", "2024-03-28 05:24:04.049314"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:24:03"], ["created_at", "2024-03-28 05:24:04.071207"], ["updated_at", "2024-03-28 05:24:04.071207"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 69ms (Views: 0.8ms | ActiveRecord: 3.0ms | Allocations: 16853)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:24:04 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:24:04.083323"], ["updated_at", "2024-03-28 05:24:04.083323"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:24:04.086074"], ["updated_at", "2024-03-28 05:24:04.086074"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:24:04"], ["created_at", "2024-03-28 05:24:04.090785"], ["updated_at", "2024-03-28 05:24:04.090785"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 12ms (Views: 2.0ms | ActiveRecord: 2.0ms | Allocations: 2633)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 05:24:04.102392"], ["updated_at", "2024-03-28 05:24:04.102392"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 05:24:04.105273"], ["updated_at", "2024-03-28 05:24:04.105273"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 05:24:04.111471"], ["updated_at", "2024-03-28 05:24:04.111471"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 12ms (Views: 0.6ms | ActiveRecord: 1.9ms | Allocations: 2264)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 1ms (Views: 0.6ms | ActiveRecord: 0.3ms | Allocations: 324)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:24:04.128736"], ["updated_at", "2024-03-28 05:24:04.128736"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:24:04.132769"], ["updated_at", "2024-03-28 05:24:04.132769"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:24:04.136000"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:24:04.136000"], ["created_at", "2024-03-28 05:24:04.138279"], ["updated_at", "2024-03-28 05:24:04.138279"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.4ms | ActiveRecord: 0.2ms | Allocations: 553)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:24:04.148415"], ["updated_at", "2024-03-28 05:24:04.148415"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:24:04.151229"], ["updated_at", "2024-03-28 05:24:04.151229"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 13:24:04 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.5ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:24:04"], ["created_at", "2024-03-28 05:24:04.160764"], ["updated_at", "2024-03-28 05:24:04.160764"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 8ms (Views: 0.6ms | ActiveRecord: 1.0ms | Allocations: 1465)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:24:04.167272"], ["updated_at", "2024-03-28 05:24:04.167272"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:24:04.168856"], ["updated_at", "2024-03-28 05:24:04.168856"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 13:24:04 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:24:04"], ["created_at", "2024-03-28 05:24:04.175238"], ["updated_at", "2024-03-28 05:24:04.175238"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.5ms | ActiveRecord: 0.8ms | Allocations: 1173)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:24:04 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 6ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 1944)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:24:04.194689"], ["updated_at", "2024-03-28 05:24:04.194689"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:24:04.198862"], ["updated_at", "2024-03-28 05:24:04.198862"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:24:04.200529"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:24:04.200529"], ["created_at", "2024-03-28 05:24:04.202091"], ["updated_at", "2024-03-28 05:24:04.202091"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:24:04 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 05:24:04"], ["updated_at", "2024-03-28 05:24:04.209176"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.7ms | ActiveRecord: 0.6ms | Allocations: 1422)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:24:04.216784"], ["updated_at", "2024-03-28 05:24:04.216784"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:24:04.219145"], ["updated_at", "2024-03-28 05:24:04.219145"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:24:04.221313"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:24:04.221313"], ["created_at", "2024-03-28 05:24:04.224996"], ["updated_at", "2024-03-28 05:24:04.224996"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:24:04 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 05:24:04"], ["updated_at", "2024-03-28 05:24:04.230800"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 1268)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (3.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:24:04.236807"], ["updated_at", "2024-03-28 05:24:04.236807"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:24:04.243002"], ["updated_at", "2024-03-28 05:24:04.243002"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:24:04.244933"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:24:04.244933"], ["created_at", "2024-03-28 05:24:04.248189"], ["updated_at", "2024-03-28 05:24:04.248189"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:24:04 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 4ms (Views: 0.4ms | ActiveRecord: 0.3ms | Allocations: 1040)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:24:04.259933"], ["updated_at", "2024-03-28 05:24:04.259933"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:24:04.262891"], ["updated_at", "2024-03-28 05:24:04.262891"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:24:04.266184"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:24:04.266184"], ["created_at", "2024-03-28 05:24:04.268177"], ["updated_at", "2024-03-28 05:24:04.268177"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.5ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:24:04.280621"], ["updated_at", "2024-03-28 05:24:04.280621"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:24:04.283720"], ["updated_at", "2024-03-28 05:24:04.283720"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:24:04.285959"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.8ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:24:04.285959"], ["created_at", "2024-03-28 05:24:04.287470"], ["updated_at", "2024-03-28 05:24:04.287470"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 357)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.3ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 2ms (Views: 1.3ms | ActiveRecord: 0.3ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (2.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:24:04.319502"], ["updated_at", "2024-03-28 05:24:04.319502"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 6ms (Views: 3.3ms | ActiveRecord: 0.2ms | Allocations: 496)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms | Allocations: 481)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 7ms (ActiveRecord: 0.0ms | Allocations: 388)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (2.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", ""], ["rule_data", "{}"], ["created_at", "2024-03-28 05:24:04.399718"], ["updated_at", "2024-03-28 05:24:04.399718"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.3ms | ActiveRecord: 2.4ms | Allocations: 946)
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:24:04.414830"], ["updated_at", "2024-03-28 05:24:04.414830"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 05:24:04.422491"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 1222)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:24:04.435176"], ["updated_at", "2024-03-28 05:24:04.435176"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 05:24:04.440698"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.5ms | ActiveRecord: 0.4ms | Allocations: 1181)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:24:04.447663"], ["updated_at", "2024-03-28 05:24:04.447663"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", ""], ["rule_data", "{}"], ["updated_at", "2024-03-28 05:24:04.454080"], ["id", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 1047)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.9ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:24:04.460096"], ["updated_at", "2024-03-28 05:24:04.460096"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:24:04.470929"], ["updated_at", "2024-03-28 05:24:04.470929"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.7ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 1.0ms | Allocations: 356)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 1ms (Views: 0.7ms | ActiveRecord: 0.2ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:24:04.492388"], ["updated_at", "2024-03-28 05:24:04.492388"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 6ms (Views: 0.7ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (2.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (9.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:24:04.513796"], ["updated_at", "2024-03-28 05:24:04.513796"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 14ms (Views: 0.7ms | ActiveRecord: 9.6ms | Allocations: 763)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:24:04.539810"], ["updated_at", "2024-03-28 05:24:04.539810"]]
  [1m[35m (1.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 16ms (Views: 1.1ms | ActiveRecord: 2.2ms | Allocations: 761)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:24:04.561281"], ["updated_at", "2024-03-28 05:24:04.561281"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.8ms | ActiveRecord: 0.8ms | Allocations: 761)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:24:04.570115"], ["updated_at", "2024-03-28 05:24:04.570115"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 05:24:04.573754"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 842)
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:24:04.581760"], ["updated_at", "2024-03-28 05:24:04.581760"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.9ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 05:24:04.585672"], ["id", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.8ms | ActiveRecord: 1.5ms | Allocations: 806)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:24:04.592705"], ["updated_at", "2024-03-28 05:24:04.592705"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 05:24:04.597151"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 848)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:24:04.604214"], ["updated_at", "2024-03-28 05:24:04.604214"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.4ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.9ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:24:04.614606"], ["updated_at", "2024-03-28 05:24:04.614606"]]
  [1m[35m (1.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.5ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.9ms | Allocations: 356)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 13:24:04 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 13:24:04 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:24:04.686803"], ["updated_at", "2024-03-28 05:24:04.686803"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:24:04.691636"], ["updated_at", "2024-03-28 05:24:04.691636"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:24:04"], ["created_at", "2024-03-28 05:24:04.695582"], ["updated_at", "2024-03-28 05:24:04.695582"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 19ms (Views: 0.6ms | ActiveRecord: 1.9ms | Allocations: 2918)
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 13:24:04 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 05:24:04.715222"], ["updated_at", "2024-03-28 05:24:04.715222"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 05:24:04.717798"], ["updated_at", "2024-03-28 05:24:04.717798"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.5ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 05:24:04.721045"], ["updated_at", "2024-03-28 05:24:04.721045"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 12ms (Views: 1.0ms | ActiveRecord: 2.2ms | Allocations: 2277)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:25:27 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms | Allocations: 1423)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:25:27 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms | Allocations: 1234)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
Completed 500 Internal Server Error in 23ms (ActiveRecord: 0.0ms | Allocations: 1036)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 336)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:25:27.688512"], ["updated_at", "2024-03-28 05:25:27.688512"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:25:27.700612"], ["updated_at", "2024-03-28 05:25:27.700612"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:25:27.702443"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:25:27.702443"], ["created_at", "2024-03-28 05:25:27.716406"], ["updated_at", "2024-03-28 05:25:27.716406"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 662)
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:25:27.725231"], ["updated_at", "2024-03-28 05:25:27.725231"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:25:27.727507"], ["updated_at", "2024-03-28 05:25:27.727507"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 13:25:27 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.5ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:25:27"], ["created_at", "2024-03-28 05:25:27.738095"], ["updated_at", "2024-03-28 05:25:27.738095"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 10ms (Views: 0.5ms | ActiveRecord: 0.9ms | Allocations: 2177)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:25:27.744679"], ["updated_at", "2024-03-28 05:25:27.744679"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:25:27.746504"], ["updated_at", "2024-03-28 05:25:27.746504"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 13:25:27 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:25:27"], ["created_at", "2024-03-28 05:25:27.752582"], ["updated_at", "2024-03-28 05:25:27.752582"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.5ms | ActiveRecord: 0.5ms | Allocations: 1173)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:25:27 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 6ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 1948)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:25:27.769852"], ["updated_at", "2024-03-28 05:25:27.769852"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:25:27.771497"], ["updated_at", "2024-03-28 05:25:27.771497"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:25:27.773572"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:25:27.773572"], ["created_at", "2024-03-28 05:25:27.776148"], ["updated_at", "2024-03-28 05:25:27.776148"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:25:27 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 05:25:27"], ["updated_at", "2024-03-28 05:25:27.784395"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.3ms | ActiveRecord: 0.5ms | Allocations: 1428)
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:25:27.790085"], ["updated_at", "2024-03-28 05:25:27.790085"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:25:27.792851"], ["updated_at", "2024-03-28 05:25:27.792851"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:25:27.794159"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:25:27.794159"], ["created_at", "2024-03-28 05:25:27.796959"], ["updated_at", "2024-03-28 05:25:27.796959"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:25:27 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.1ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 05:25:27"], ["updated_at", "2024-03-28 05:25:27.803243"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 1268)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:25:27.808275"], ["updated_at", "2024-03-28 05:25:27.808275"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:25:27.810568"], ["updated_at", "2024-03-28 05:25:27.810568"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:25:27.812350"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:25:27.812350"], ["created_at", "2024-03-28 05:25:27.814525"], ["updated_at", "2024-03-28 05:25:27.814525"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:25:27 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 3ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 1040)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.0ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:25:27.830130"], ["updated_at", "2024-03-28 05:25:27.830130"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:25:27.833294"], ["updated_at", "2024-03-28 05:25:27.833294"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:25:27.835031"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:25:27.835031"], ["created_at", "2024-03-28 05:25:27.836922"], ["updated_at", "2024-03-28 05:25:27.836922"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:25:27.846633"], ["updated_at", "2024-03-28 05:25:27.846633"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:25:27.849320"], ["updated_at", "2024-03-28 05:25:27.849320"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:25:27.850480"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:25:27.850480"], ["created_at", "2024-03-28 05:25:27.851744"], ["updated_at", "2024-03-28 05:25:27.851744"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.6ms | Allocations: 357)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 1ms (Views: 0.6ms | ActiveRecord: 0.2ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:25:27.866666"], ["updated_at", "2024-03-28 05:25:27.866666"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.8ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 3ms (Views: 0.8ms | ActiveRecord: 0.8ms | Allocations: 512)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.0ms | Allocations: 479)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 6ms (ActiveRecord: 0.0ms | Allocations: 388)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (1.7ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.9ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", ""], ["rule_data", "{}"], ["created_at", "2024-03-28 05:25:27.910542"], ["updated_at", "2024-03-28 05:25:27.910542"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 9ms (Views: 0.4ms | ActiveRecord: 1.1ms | Allocations: 957)
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:25:27.941349"], ["updated_at", "2024-03-28 05:25:27.941349"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 05:25:27.956835"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 18ms (Views: 2.6ms | ActiveRecord: 0.4ms | Allocations: 1220)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:25:27.975648"], ["updated_at", "2024-03-28 05:25:27.975648"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (1.3ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 05:25:27.989419"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.4ms | ActiveRecord: 1.7ms | Allocations: 1181)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:25:28.000041"], ["updated_at", "2024-03-28 05:25:28.000041"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", ""], ["rule_data", "{}"], ["updated_at", "2024-03-28 05:25:28.004789"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 1047)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:25:28.013234"], ["updated_at", "2024-03-28 05:25:28.013234"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.4ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:25:28.024166"], ["updated_at", "2024-03-28 05:25:28.024166"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.4ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.8ms | Allocations: 356)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:25:28.038951"], ["updated_at", "2024-03-28 05:25:28.038951"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 1ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:25:28.052848"], ["updated_at", "2024-03-28 05:25:28.052848"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.4ms | ActiveRecord: 0.8ms | Allocations: 772)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:25:28.063423"], ["updated_at", "2024-03-28 05:25:28.063423"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.6ms | ActiveRecord: 1.3ms | Allocations: 761)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:25:28.072516"], ["updated_at", "2024-03-28 05:25:28.072516"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.4ms | ActiveRecord: 0.9ms | Allocations: 761)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:25:28.079907"], ["updated_at", "2024-03-28 05:25:28.079907"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.3ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 05:25:28.086156"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.7ms | ActiveRecord: 0.6ms | Allocations: 842)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:25:28.093586"], ["updated_at", "2024-03-28 05:25:28.093586"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.3ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 05:25:28.099697"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 806)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:25:28.105031"], ["updated_at", "2024-03-28 05:25:28.105031"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 05:25:28.110163"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.9ms | ActiveRecord: 0.6ms | Allocations: 852)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:25:28.118309"], ["updated_at", "2024-03-28 05:25:28.118309"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (1.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:25:28.127838"], ["updated_at", "2024-03-28 05:25:28.127838"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.5ms | Allocations: 356)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 13:25:28 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 13:25:28 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
Completed 500 Internal Server Error in 11ms (ActiveRecord: 0.0ms | Allocations: 2126)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 13:25:28 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms | Allocations: 1761)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:26:27 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:26:27.550165"], ["updated_at", "2024-03-28 05:26:27.550165"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:26:27.582495"], ["updated_at", "2024-03-28 05:26:27.582495"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:26:27"], ["created_at", "2024-03-28 05:26:27.601323"], ["updated_at", "2024-03-28 05:26:27.601323"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 63ms (Views: 0.7ms | ActiveRecord: 2.6ms | Allocations: 16857)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:26:27 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:26:27.614105"], ["updated_at", "2024-03-28 05:26:27.614105"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:26:27.618662"], ["updated_at", "2024-03-28 05:26:27.618662"]]
  [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:26:27"], ["created_at", "2024-03-28 05:26:27.624319"], ["updated_at", "2024-03-28 05:26:27.624319"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 14ms (Views: 0.6ms | ActiveRecord: 3.5ms | Allocations: 2636)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 05:26:27.632727"], ["updated_at", "2024-03-28 05:26:27.632727"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.0ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 05:26:27.634299"], ["updated_at", "2024-03-28 05:26:27.634299"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 05:26:27.639600"], ["updated_at", "2024-03-28 05:26:27.639600"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 10ms (Views: 0.6ms | ActiveRecord: 2.3ms | Allocations: 2267)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 324)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:26:27.658498"], ["updated_at", "2024-03-28 05:26:27.658498"]]
  [1m[35m (2.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:26:27.663688"], ["updated_at", "2024-03-28 05:26:27.663688"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:26:27.666356"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:26:27.666356"], ["created_at", "2024-03-28 05:26:27.667613"], ["updated_at", "2024-03-28 05:26:27.667613"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.4ms | ActiveRecord: 0.2ms | Allocations: 553)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:26:27.678574"], ["updated_at", "2024-03-28 05:26:27.678574"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:26:27.681458"], ["updated_at", "2024-03-28 05:26:27.681458"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 13:26:27 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:26:27"], ["created_at", "2024-03-28 05:26:27.688523"], ["updated_at", "2024-03-28 05:26:27.688523"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.3ms | ActiveRecord: 0.6ms | Allocations: 1465)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (1.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:26:27.696884"], ["updated_at", "2024-03-28 05:26:27.696884"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:26:27.698789"], ["updated_at", "2024-03-28 05:26:27.698789"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 13:26:27 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:26:27"], ["created_at", "2024-03-28 05:26:27.705549"], ["updated_at", "2024-03-28 05:26:27.705549"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 1173)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:26:27 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 5ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 1944)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.9ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:26:27.726289"], ["updated_at", "2024-03-28 05:26:27.726289"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:26:27.731056"], ["updated_at", "2024-03-28 05:26:27.731056"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:26:27.733393"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:26:27.733393"], ["created_at", "2024-03-28 05:26:27.734731"], ["updated_at", "2024-03-28 05:26:27.734731"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:26:27 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 05:26:27"], ["updated_at", "2024-03-28 05:26:27.741983"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 1422)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:26:27.749638"], ["updated_at", "2024-03-28 05:26:27.749638"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:26:27.751413"], ["updated_at", "2024-03-28 05:26:27.751413"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:26:27.752398"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:26:27.752398"], ["created_at", "2024-03-28 05:26:27.754984"], ["updated_at", "2024-03-28 05:26:27.754984"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:26:27 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.1ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 05:26:27"], ["updated_at", "2024-03-28 05:26:27.764309"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.3ms | ActiveRecord: 0.6ms | Allocations: 1268)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:26:27.770399"], ["updated_at", "2024-03-28 05:26:27.770399"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:26:27.772631"], ["updated_at", "2024-03-28 05:26:27.772631"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:26:27.773742"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.6ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:26:27.773742"], ["created_at", "2024-03-28 05:26:27.777401"], ["updated_at", "2024-03-28 05:26:27.777401"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:26:27 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 2ms (Views: 0.2ms | ActiveRecord: 0.2ms | Allocations: 1040)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:26:27.787517"], ["updated_at", "2024-03-28 05:26:27.787517"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:26:27.789457"], ["updated_at", "2024-03-28 05:26:27.789457"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:26:27.792228"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:26:27.792228"], ["created_at", "2024-03-28 05:26:27.795895"], ["updated_at", "2024-03-28 05:26:27.795895"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:26:27.803993"], ["updated_at", "2024-03-28 05:26:27.803993"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:26:27.806305"], ["updated_at", "2024-03-28 05:26:27.806305"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:26:27.807549"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:26:27.807549"], ["created_at", "2024-03-28 05:26:27.811122"], ["updated_at", "2024-03-28 05:26:27.811122"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 357)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.4ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 1ms (Views: 0.6ms | ActiveRecord: 0.4ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:26:27.844978"], ["updated_at", "2024-03-28 05:26:27.844978"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 5ms (Views: 3.6ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms | Allocations: 481)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 5ms (ActiveRecord: 0.0ms | Allocations: 388)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", ""], ["rule_data", "{}"], ["created_at", "2024-03-28 05:26:27.925061"], ["updated_at", "2024-03-28 05:26:27.925061"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 9ms (Views: 0.4ms | ActiveRecord: 0.8ms | Allocations: 946)
  [1m[35m (1.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:26:27.940614"], ["updated_at", "2024-03-28 05:26:27.940614"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 05:26:27.944790"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.6ms | ActiveRecord: 0.4ms | Allocations: 1220)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:26:27.952341"], ["updated_at", "2024-03-28 05:26:27.952341"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 05:26:27.961463"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 0.5ms | Allocations: 1181)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:26:27.966749"], ["updated_at", "2024-03-28 05:26:27.966749"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (1.7ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", ""], ["rule_data", "{}"], ["updated_at", "2024-03-28 05:26:27.973379"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.4ms | ActiveRecord: 1.9ms | Allocations: 1047)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:26:27.981502"], ["updated_at", "2024-03-28 05:26:27.981502"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:26:27.992867"], ["updated_at", "2024-03-28 05:26:27.992867"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 356)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 2ms (Views: 0.9ms | ActiveRecord: 0.2ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:26:28.015218"], ["updated_at", "2024-03-28 05:26:28.015218"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 3ms (Views: 0.8ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:26:28.031585"], ["updated_at", "2024-03-28 05:26:28.031585"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 3ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 763)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (7.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:26:28.040452"], ["updated_at", "2024-03-28 05:26:28.040452"]]
  [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 10ms (Views: 0.5ms | ActiveRecord: 7.9ms | Allocations: 761)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.0ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:26:28.093656"], ["updated_at", "2024-03-28 05:26:28.093656"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.5ms | ActiveRecord: 1.3ms | Allocations: 761)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:26:28.101382"], ["updated_at", "2024-03-28 05:26:28.101382"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 05:26:28.109262"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 842)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:26:28.115424"], ["updated_at", "2024-03-28 05:26:28.115424"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 05:26:28.119469"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 806)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:26:28.126079"], ["updated_at", "2024-03-28 05:26:28.126079"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 05:26:28.132461"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.3ms | ActiveRecord: 0.3ms | Allocations: 848)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:26:28.137196"], ["updated_at", "2024-03-28 05:26:28.137196"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:26:28.146298"], ["updated_at", "2024-03-28 05:26:28.146298"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 356)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 13:26:28 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 13:26:28 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.9ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:26:28.323037"], ["updated_at", "2024-03-28 05:26:28.323037"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:26:28.325663"], ["updated_at", "2024-03-28 05:26:28.325663"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:26:28"], ["created_at", "2024-03-28 05:26:28.329434"], ["updated_at", "2024-03-28 05:26:28.329434"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 23ms (Views: 0.7ms | ActiveRecord: 1.9ms | Allocations: 2921)
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 13:26:28 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 05:26:28.346893"], ["updated_at", "2024-03-28 05:26:28.346893"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 05:26:28.348733"], ["updated_at", "2024-03-28 05:26:28.348733"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 05:26:28.350833"], ["updated_at", "2024-03-28 05:26:28.350833"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 6ms (Views: 0.2ms | ActiveRecord: 1.2ms | Allocations: 2181)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:28:15 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.0ms | Allocations: 520)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:28:15 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.0ms | Allocations: 396)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.0ms | Allocations: 309)
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 2ms (Views: 0.8ms | ActiveRecord: 0.3ms | Allocations: 336)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:15.136194"], ["updated_at", "2024-03-28 05:28:15.136194"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:15.148901"], ["updated_at", "2024-03-28 05:28:15.148901"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:15.150460"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:15.150460"], ["created_at", "2024-03-28 05:28:15.164236"], ["updated_at", "2024-03-28 05:28:15.164236"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 662)
  [1m[35m (1.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:15.174926"], ["updated_at", "2024-03-28 05:28:15.174926"]]
  [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:15.178297"], ["updated_at", "2024-03-28 05:28:15.178297"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 13:28:15 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:15"], ["created_at", "2024-03-28 05:28:15.190885"], ["updated_at", "2024-03-28 05:28:15.190885"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 11ms (Views: 0.4ms | ActiveRecord: 0.8ms | Allocations: 2177)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:15.198862"], ["updated_at", "2024-03-28 05:28:15.198862"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:15.200670"], ["updated_at", "2024-03-28 05:28:15.200670"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 13:28:15 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:15"], ["created_at", "2024-03-28 05:28:15.205390"], ["updated_at", "2024-03-28 05:28:15.205390"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 1173)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:28:15 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 8ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 1948)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:15.225821"], ["updated_at", "2024-03-28 05:28:15.225821"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:15.227859"], ["updated_at", "2024-03-28 05:28:15.227859"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:15.233559"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:15.233559"], ["created_at", "2024-03-28 05:28:15.235111"], ["updated_at", "2024-03-28 05:28:15.235111"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:28:15 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 05:28:15"], ["updated_at", "2024-03-28 05:28:15.242166"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 1.2ms | ActiveRecord: 0.7ms | Allocations: 1428)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:15.249582"], ["updated_at", "2024-03-28 05:28:15.249582"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:15.252694"], ["updated_at", "2024-03-28 05:28:15.252694"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:15.255209"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:15.255209"], ["created_at", "2024-03-28 05:28:15.256495"], ["updated_at", "2024-03-28 05:28:15.256495"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:28:15 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.1ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 05:28:15"], ["updated_at", "2024-03-28 05:28:15.264747"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 1268)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:15.271019"], ["updated_at", "2024-03-28 05:28:15.271019"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:15.275154"], ["updated_at", "2024-03-28 05:28:15.275154"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:15.277280"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:15.277280"], ["created_at", "2024-03-28 05:28:15.280748"], ["updated_at", "2024-03-28 05:28:15.280748"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:28:15 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 5ms (Views: 0.2ms | ActiveRecord: 0.4ms | Allocations: 1040)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:15.292874"], ["updated_at", "2024-03-28 05:28:15.292874"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:15.296181"], ["updated_at", "2024-03-28 05:28:15.296181"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:15.299363"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.8ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:15.299363"], ["created_at", "2024-03-28 05:28:15.300676"], ["updated_at", "2024-03-28 05:28:15.300676"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:15.308778"], ["updated_at", "2024-03-28 05:28:15.308778"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:15.311510"], ["updated_at", "2024-03-28 05:28:15.311510"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:15.313392"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:15.313392"], ["created_at", "2024-03-28 05:28:15.316001"], ["updated_at", "2024-03-28 05:28:15.316001"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 0.5ms | Allocations: 357)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (1.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 2ms (Views: 0.6ms | ActiveRecord: 1.0ms | Allocations: 314)
  [1m[35m (1.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:15.333886"], ["updated_at", "2024-03-28 05:28:15.333886"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 512)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms | Allocations: 479)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.0ms | Allocations: 388)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.9ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", ""], ["rule_data", "{}"], ["created_at", "2024-03-28 05:28:15.370702"], ["updated_at", "2024-03-28 05:28:15.370702"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 11ms (Views: 0.4ms | ActiveRecord: 1.0ms | Allocations: 957)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (2.0ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:15.405953"], ["updated_at", "2024-03-28 05:28:15.405953"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.3ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 05:28:15.421656"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 13ms (Views: 3.4ms | ActiveRecord: 0.6ms | Allocations: 1220)
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.9ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:15.440267"], ["updated_at", "2024-03-28 05:28:15.440267"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 05:28:15.457843"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 14ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 1181)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (3.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:15.475710"], ["updated_at", "2024-03-28 05:28:15.475710"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", ""], ["rule_data", "{}"], ["updated_at", "2024-03-28 05:28:15.491400"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.3ms | ActiveRecord: 0.5ms | Allocations: 1049)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (2.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:15.497378"], ["updated_at", "2024-03-28 05:28:15.497378"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:15.508468"], ["updated_at", "2024-03-28 05:28:15.508468"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.7ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 2ms (Views: 0.6ms | ActiveRecord: 0.7ms | Allocations: 282)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:15.526869"], ["updated_at", "2024-03-28 05:28:15.526869"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 3ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:15.541324"], ["updated_at", "2024-03-28 05:28:15.541324"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 3ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 772)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:15.550524"], ["updated_at", "2024-03-28 05:28:15.550524"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 2.5ms | ActiveRecord: 0.7ms | Allocations: 761)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:15.563163"], ["updated_at", "2024-03-28 05:28:15.563163"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 761)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:15.572242"], ["updated_at", "2024-03-28 05:28:15.572242"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 05:28:15.577167"], ["id", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.5ms | ActiveRecord: 0.6ms | Allocations: 842)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:15.584434"], ["updated_at", "2024-03-28 05:28:15.584434"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 05:28:15.593672"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.6ms | ActiveRecord: 0.4ms | Allocations: 806)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:15.599653"], ["updated_at", "2024-03-28 05:28:15.599653"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 05:28:15.607187"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 852)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:15.612372"], ["updated_at", "2024-03-28 05:28:15.612372"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 1.0ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:15.623532"], ["updated_at", "2024-03-28 05:28:15.623532"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (1.4ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 13:28:15 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 13:28:15 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
Completed 500 Internal Server Error in 10ms (ActiveRecord: 0.0ms | Allocations: 606)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 13:28:15 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.0ms | Allocations: 384)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.4ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:28:55 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:55.622342"], ["updated_at", "2024-03-28 05:28:55.622342"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:55.668134"], ["updated_at", "2024-03-28 05:28:55.668134"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:55"], ["created_at", "2024-03-28 05:28:55.690709"], ["updated_at", "2024-03-28 05:28:55.690709"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 82ms (Views: 0.7ms | ActiveRecord: 2.9ms | Allocations: 16890)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:28:55 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:55.703074"], ["updated_at", "2024-03-28 05:28:55.703074"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:55.705696"], ["updated_at", "2024-03-28 05:28:55.705696"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:55"], ["created_at", "2024-03-28 05:28:55.709139"], ["updated_at", "2024-03-28 05:28:55.709139"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 10ms (Views: 1.7ms | ActiveRecord: 1.7ms | Allocations: 2665)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 05:28:55.719703"], ["updated_at", "2024-03-28 05:28:55.719703"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 05:28:55.723022"], ["updated_at", "2024-03-28 05:28:55.723022"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 05:28:55.729284"], ["updated_at", "2024-03-28 05:28:55.729284"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 13ms (Views: 0.7ms | ActiveRecord: 1.9ms | Allocations: 2277)
  [1m[35m (1.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 2ms (Views: 0.8ms | ActiveRecord: 0.3ms | Allocations: 324)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:55.752812"], ["updated_at", "2024-03-28 05:28:55.752812"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:55.755562"], ["updated_at", "2024-03-28 05:28:55.755562"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:55.757644"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.5ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:55.757644"], ["created_at", "2024-03-28 05:28:55.759785"], ["updated_at", "2024-03-28 05:28:55.759785"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.6ms | ActiveRecord: 0.2ms | Allocations: 553)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:55.774525"], ["updated_at", "2024-03-28 05:28:55.774525"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:55.778062"], ["updated_at", "2024-03-28 05:28:55.778062"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 13:28:55 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:55"], ["created_at", "2024-03-28 05:28:55.786522"], ["updated_at", "2024-03-28 05:28:55.786522"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 1465)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:55.791736"], ["updated_at", "2024-03-28 05:28:55.791736"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.9ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:55.794170"], ["updated_at", "2024-03-28 05:28:55.794170"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 13:28:55 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.6ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:55"], ["created_at", "2024-03-28 05:28:55.803423"], ["updated_at", "2024-03-28 05:28:55.803423"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 7ms (Views: 0.8ms | ActiveRecord: 1.1ms | Allocations: 1173)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:28:55 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 6ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 1944)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.9ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:55.824261"], ["updated_at", "2024-03-28 05:28:55.824261"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:55.828872"], ["updated_at", "2024-03-28 05:28:55.828872"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:55.830830"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:55.830830"], ["created_at", "2024-03-28 05:28:55.832139"], ["updated_at", "2024-03-28 05:28:55.832139"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:28:55 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 05:28:55"], ["updated_at", "2024-03-28 05:28:55.840332"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.5ms | ActiveRecord: 0.9ms | Allocations: 1422)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:55.848355"], ["updated_at", "2024-03-28 05:28:55.848355"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:55.851588"], ["updated_at", "2024-03-28 05:28:55.851588"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:55.855043"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.5ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:55.855043"], ["created_at", "2024-03-28 05:28:55.856917"], ["updated_at", "2024-03-28 05:28:55.856917"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:28:55 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.1ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 05:28:55"], ["updated_at", "2024-03-28 05:28:55.865604"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 1268)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:55.872043"], ["updated_at", "2024-03-28 05:28:55.872043"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:55.876242"], ["updated_at", "2024-03-28 05:28:55.876242"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:55.878241"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:55.878241"], ["created_at", "2024-03-28 05:28:55.880740"], ["updated_at", "2024-03-28 05:28:55.880740"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:28:55 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 4ms (Views: 0.2ms | ActiveRecord: 0.4ms | Allocations: 1040)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.9ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:55.894157"], ["updated_at", "2024-03-28 05:28:55.894157"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:55.898428"], ["updated_at", "2024-03-28 05:28:55.898428"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:55.900553"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:55.900553"], ["created_at", "2024-03-28 05:28:55.903064"], ["updated_at", "2024-03-28 05:28:55.903064"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.5ms | Allocations: 426)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:55.913964"], ["updated_at", "2024-03-28 05:28:55.913964"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:55.916476"], ["updated_at", "2024-03-28 05:28:55.916476"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:55.919024"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:55.919024"], ["created_at", "2024-03-28 05:28:55.921201"], ["updated_at", "2024-03-28 05:28:55.921201"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 357)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.3ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 2ms (Views: 0.8ms | ActiveRecord: 0.3ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:55.956407"], ["updated_at", "2024-03-28 05:28:55.956407"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 5ms (Views: 3.5ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 6ms (ActiveRecord: 0.0ms | Allocations: 481)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 10ms (ActiveRecord: 0.0ms | Allocations: 388)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", ""], ["rule_data", "{}"], ["created_at", "2024-03-28 05:28:56.037660"], ["updated_at", "2024-03-28 05:28:56.037660"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.6ms | ActiveRecord: 0.7ms | Allocations: 946)
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (3.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:56.050788"], ["updated_at", "2024-03-28 05:28:56.050788"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 05:28:56.060148"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.8ms | ActiveRecord: 0.4ms | Allocations: 1220)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (1.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:56.071060"], ["updated_at", "2024-03-28 05:28:56.071060"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 05:28:56.078865"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 1.4ms | ActiveRecord: 0.6ms | Allocations: 1181)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:56.086626"], ["updated_at", "2024-03-28 05:28:56.086626"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.3ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", ""], ["rule_data", "{}"], ["updated_at", "2024-03-28 05:28:56.094702"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 1047)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:56.101253"], ["updated_at", "2024-03-28 05:28:56.101253"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.4ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.7ms | Allocations: 363)
  [1m[35m (2.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (11.9ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:56.119014"], ["updated_at", "2024-03-28 05:28:56.119014"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.5ms | Allocations: 356)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 2ms (Views: 0.7ms | ActiveRecord: 0.2ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:56.161193"], ["updated_at", "2024-03-28 05:28:56.161193"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 4ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 480)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:56.175606"], ["updated_at", "2024-03-28 05:28:56.175606"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 763)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:56.185778"], ["updated_at", "2024-03-28 05:28:56.185778"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 3ms (Views: 0.9ms | ActiveRecord: 0.7ms | Allocations: 761)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:56.195117"], ["updated_at", "2024-03-28 05:28:56.195117"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 1.3ms | ActiveRecord: 0.7ms | Allocations: 761)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:56.203383"], ["updated_at", "2024-03-28 05:28:56.203383"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 05:28:56.207330"], ["id", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.5ms | ActiveRecord: 0.8ms | Allocations: 842)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:56.218494"], ["updated_at", "2024-03-28 05:28:56.218494"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 05:28:56.226573"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.7ms | ActiveRecord: 0.7ms | Allocations: 806)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:56.236001"], ["updated_at", "2024-03-28 05:28:56.236001"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 05:28:56.250216"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 10ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 848)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:56.256285"], ["updated_at", "2024-03-28 05:28:56.256285"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 9ms (ActiveRecord: 0.6ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:56.271873"], ["updated_at", "2024-03-28 05:28:56.271873"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (2.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 13:28:56 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 13:28:56 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:28:56.339281"], ["updated_at", "2024-03-28 05:28:56.339281"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:28:56.341993"], ["updated_at", "2024-03-28 05:28:56.341993"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:28:56"], ["created_at", "2024-03-28 05:28:56.344926"], ["updated_at", "2024-03-28 05:28:56.344926"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 22ms (Views: 0.7ms | ActiveRecord: 1.7ms | Allocations: 2950)
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 13:28:56 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 05:28:56.369525"], ["updated_at", "2024-03-28 05:28:56.369525"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.3ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 05:28:56.371319"], ["updated_at", "2024-03-28 05:28:56.371319"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 05:28:56.377936"], ["updated_at", "2024-03-28 05:28:56.377936"]]
  [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 13ms (Views: 0.2ms | ActiveRecord: 2.4ms | Allocations: 2190)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:31:02 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:31:02.149489"], ["updated_at", "2024-03-28 05:31:02.149489"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:31:02.196502"], ["updated_at", "2024-03-28 05:31:02.196502"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:31:02"], ["created_at", "2024-03-28 05:31:02.221021"], ["updated_at", "2024-03-28 05:31:02.221021"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 85ms (Views: 1.2ms | ActiveRecord: 2.8ms | Allocations: 16889)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (2.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:31:02 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:31:02.235153"], ["updated_at", "2024-03-28 05:31:02.235153"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:31:02.237960"], ["updated_at", "2024-03-28 05:31:02.237960"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:31:02"], ["created_at", "2024-03-28 05:31:02.242784"], ["updated_at", "2024-03-28 05:31:02.242784"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 12ms (Views: 0.8ms | ActiveRecord: 1.6ms | Allocations: 2665)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 05:31:02.314910"], ["updated_at", "2024-03-28 05:31:02.314910"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 05:31:02.317281"], ["updated_at", "2024-03-28 05:31:02.317281"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 05:31:02.320802"], ["updated_at", "2024-03-28 05:31:02.320802"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 71ms (Views: 0.3ms | ActiveRecord: 1.7ms | Allocations: 2140)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.6ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 2ms (Views: 0.7ms | ActiveRecord: 0.6ms | Allocations: 323)
  [1m[35m (10.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:31:02.432039"], ["updated_at", "2024-03-28 05:31:02.432039"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:31:02.434951"], ["updated_at", "2024-03-28 05:31:02.434951"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (16.8ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:31:02.436802"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:31:02.436802"], ["created_at", "2024-03-28 05:31:02.455956"], ["updated_at", "2024-03-28 05:31:02.455956"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.6ms | ActiveRecord: 0.2ms | Allocations: 553)
  [1m[35m (1.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:31:02.467585"], ["updated_at", "2024-03-28 05:31:02.467585"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:31:02.470283"], ["updated_at", "2024-03-28 05:31:02.470283"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 13:31:02 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:31:02"], ["created_at", "2024-03-28 05:31:02.480120"], ["updated_at", "2024-03-28 05:31:02.480120"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 7ms (Views: 1.7ms | ActiveRecord: 0.6ms | Allocations: 1465)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (1.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:31:02.488694"], ["updated_at", "2024-03-28 05:31:02.488694"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:31:02.494202"], ["updated_at", "2024-03-28 05:31:02.494202"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 13:31:02 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:31:02"], ["created_at", "2024-03-28 05:31:02.611666"], ["updated_at", "2024-03-28 05:31:02.611666"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 115ms (Views: 0.6ms | ActiveRecord: 0.9ms | Allocations: 1173)
  [1m[35m (9.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:31:02 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 27ms (Views: 0.8ms | ActiveRecord: 0.0ms | Allocations: 1946)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (7.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:31:02.686671"], ["updated_at", "2024-03-28 05:31:02.686671"]]
  [1m[35m (1.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:31:02.700564"], ["updated_at", "2024-03-28 05:31:02.700564"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:31:02.704508"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:31:02.704508"], ["created_at", "2024-03-28 05:31:02.706633"], ["updated_at", "2024-03-28 05:31:02.706633"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:31:02 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.3ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 05:31:02"], ["updated_at", "2024-03-28 05:31:02.749759"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 47ms (Views: 0.4ms | ActiveRecord: 1.3ms | Allocations: 1422)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (1.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:31:02.764804"], ["updated_at", "2024-03-28 05:31:02.764804"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:31:02.768072"], ["updated_at", "2024-03-28 05:31:02.768072"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:31:02.770266"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (38.0ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:31:02.770266"], ["created_at", "2024-03-28 05:31:02.773182"], ["updated_at", "2024-03-28 05:31:02.773182"]]
  [1m[35m (1.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:31:02 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.1ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 05:31:02"], ["updated_at", "2024-03-28 05:31:02.832900"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.9ms | ActiveRecord: 0.7ms | Allocations: 1268)
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (2.0ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:31:02.840938"], ["updated_at", "2024-03-28 05:31:02.840938"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:31:02.845961"], ["updated_at", "2024-03-28 05:31:02.845961"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:31:02.848079"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:31:02.848079"], ["created_at", "2024-03-28 05:31:02.850342"], ["updated_at", "2024-03-28 05:31:02.850342"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 13:31:02 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 3ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 1040)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:31:02.862915"], ["updated_at", "2024-03-28 05:31:02.862915"]]
  [1m[35m (1.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:31:02.866477"], ["updated_at", "2024-03-28 05:31:02.866477"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:31:02.868674"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:31:02.868674"], ["created_at", "2024-03-28 05:31:02.870034"], ["updated_at", "2024-03-28 05:31:02.870034"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (1.7ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 1.9ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:31:02.882532"], ["updated_at", "2024-03-28 05:31:02.882532"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:31:02.884613"], ["updated_at", "2024-03-28 05:31:02.884613"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:31:02.885863"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:31:02.885863"], ["created_at", "2024-03-28 05:31:02.887684"], ["updated_at", "2024-03-28 05:31:02.887684"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.4ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 0.8ms | Allocations: 357)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.3ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 2ms (Views: 0.9ms | ActiveRecord: 0.3ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:31:02.922148"], ["updated_at", "2024-03-28 05:31:02.922148"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 13ms (Views: 5.9ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 4ms (ActiveRecord: 0.0ms | Allocations: 471)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 4ms (ActiveRecord: 0.0ms | Allocations: 388)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (2.5ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", ""], ["rule_data", "{}"], ["created_at", "2024-03-28 05:31:03.030613"], ["updated_at", "2024-03-28 05:31:03.030613"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 12ms (Views: 0.5ms | ActiveRecord: 0.7ms | Allocations: 946)
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:31:03.064620"], ["updated_at", "2024-03-28 05:31:03.064620"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.3ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 05:31:03.074431"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.8ms | ActiveRecord: 0.6ms | Allocations: 1222)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:31:03.084829"], ["updated_at", "2024-03-28 05:31:03.084829"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 05:31:03.090855"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 1.2ms | Allocations: 1181)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:31:03.100479"], ["updated_at", "2024-03-28 05:31:03.100479"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (1.3ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", ""], ["rule_data", "{}"], ["updated_at", "2024-03-28 05:31:03.107948"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 1.7ms | Allocations: 1047)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:31:03.117664"], ["updated_at", "2024-03-28 05:31:03.117664"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 0.5ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:31:03.131909"], ["updated_at", "2024-03-28 05:31:03.131909"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.3ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 2ms (Views: 0.8ms | ActiveRecord: 0.3ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:31:03.158056"], ["updated_at", "2024-03-28 05:31:03.158056"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:31:03.173860"], ["updated_at", "2024-03-28 05:31:03.173860"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 8ms (Views: 1.7ms | ActiveRecord: 0.8ms | Allocations: 763)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (1.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:31:03.190811"], ["updated_at", "2024-03-28 05:31:03.190811"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 7ms (Views: 0.7ms | ActiveRecord: 2.1ms | Allocations: 761)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:31:03.202405"], ["updated_at", "2024-03-28 05:31:03.202405"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.4ms | ActiveRecord: 1.7ms | Allocations: 761)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:31:03.214053"], ["updated_at", "2024-03-28 05:31:03.214053"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 05:31:03.219726"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 842)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:31:03.228354"], ["updated_at", "2024-03-28 05:31:03.228354"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 05:31:03.234854"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.4ms | ActiveRecord: 0.3ms | Allocations: 806)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:31:03.239687"], ["updated_at", "2024-03-28 05:31:03.239687"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.3ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 05:31:03.433197"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.6ms | ActiveRecord: 0.6ms | Allocations: 848)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.5ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:31:03.443976"], ["updated_at", "2024-03-28 05:31:03.443976"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.4ms | Allocations: 363)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:31:03.460731"], ["updated_at", "2024-03-28 05:31:03.460731"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 0.6ms | Allocations: 356)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 13:31:03 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 13:31:03 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 05:31:03.601741"], ["updated_at", "2024-03-28 05:31:03.601741"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 05:31:03.604849"], ["updated_at", "2024-03-28 05:31:03.604849"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 05:31:03"], ["created_at", "2024-03-28 05:31:03.611461"], ["updated_at", "2024-03-28 05:31:03.611461"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 27ms (Views: 0.7ms | ActiveRecord: 2.0ms | Allocations: 2950)
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 13:31:03 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 05:31:03.647009"], ["updated_at", "2024-03-28 05:31:03.647009"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.3ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 05:31:03.649940"], ["updated_at", "2024-03-28 05:31:03.649940"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.5ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 05:31:03.656984"], ["updated_at", "2024-03-28 05:31:03.656984"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 15ms (Views: 0.3ms | ActiveRecord: 2.5ms | Allocations: 2174)
  [1m[35m (1.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (1.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:04:40 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:04:40.742222"], ["updated_at", "2024-03-28 07:04:40.742222"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:04:40.783726"], ["updated_at", "2024-03-28 07:04:40.783726"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:04:40"], ["created_at", "2024-03-28 07:04:40.809374"], ["updated_at", "2024-03-28 07:04:40.809374"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 80ms (Views: 0.7ms | ActiveRecord: 2.8ms | Allocations: 16890)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:04:40 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:04:40.819900"], ["updated_at", "2024-03-28 07:04:40.819900"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:04:40.822220"], ["updated_at", "2024-03-28 07:04:40.822220"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:04:40"], ["created_at", "2024-03-28 07:04:40.825861"], ["updated_at", "2024-03-28 07:04:40.825861"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 10ms (Views: 0.7ms | ActiveRecord: 1.4ms | Allocations: 2665)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 07:04:40.836097"], ["updated_at", "2024-03-28 07:04:40.836097"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 07:04:40.837595"], ["updated_at", "2024-03-28 07:04:40.837595"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:04:40.841272"], ["updated_at", "2024-03-28 07:04:40.841272"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 8ms (Views: 0.2ms | ActiveRecord: 1.2ms | Allocations: 2140)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.4ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.4ms | Allocations: 323)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:04:40.855609"], ["updated_at", "2024-03-28 07:04:40.855609"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:04:40.859496"], ["updated_at", "2024-03-28 07:04:40.859496"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:04:40.862929"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:04:40.862929"], ["created_at", "2024-03-28 07:04:40.864574"], ["updated_at", "2024-03-28 07:04:40.864574"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 4ms (Views: 0.6ms | ActiveRecord: 0.2ms | Allocations: 553)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:04:40.875903"], ["updated_at", "2024-03-28 07:04:40.875903"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:04:40.878133"], ["updated_at", "2024-03-28 07:04:40.878133"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 15:04:40 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.3ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.6ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:04:40"], ["created_at", "2024-03-28 07:04:40.888099"], ["updated_at", "2024-03-28 07:04:40.888099"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 7ms (Views: 0.5ms | ActiveRecord: 1.2ms | Allocations: 1465)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.0ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:04:40.895564"], ["updated_at", "2024-03-28 07:04:40.895564"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:04:40.898453"], ["updated_at", "2024-03-28 07:04:40.898453"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 15:04:40 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:04:40"], ["created_at", "2024-03-28 07:04:40.905199"], ["updated_at", "2024-03-28 07:04:40.905199"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.3ms | ActiveRecord: 0.6ms | Allocations: 1173)
  [1m[35m (1.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:04:40 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 9ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 1946)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:04:40.923667"], ["updated_at", "2024-03-28 07:04:40.923667"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:04:40.925951"], ["updated_at", "2024-03-28 07:04:40.925951"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:04:40.928005"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:04:40.928005"], ["created_at", "2024-03-28 07:04:40.929626"], ["updated_at", "2024-03-28 07:04:40.929626"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:04:40 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.3ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 07:04:40"], ["updated_at", "2024-03-28 07:04:40.936525"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.7ms | ActiveRecord: 0.8ms | Allocations: 1422)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.4ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:04:40.944458"], ["updated_at", "2024-03-28 07:04:40.944458"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:04:40.946770"], ["updated_at", "2024-03-28 07:04:40.946770"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.8ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:04:40.948872"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:04:40.948872"], ["created_at", "2024-03-28 07:04:40.952210"], ["updated_at", "2024-03-28 07:04:40.952210"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:04:40 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 07:04:40"], ["updated_at", "2024-03-28 07:04:40.958681"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.3ms | ActiveRecord: 0.5ms | Allocations: 1268)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:04:40.962944"], ["updated_at", "2024-03-28 07:04:40.962944"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:04:40.966001"], ["updated_at", "2024-03-28 07:04:40.966001"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:04:40.968100"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:04:40.968100"], ["created_at", "2024-03-28 07:04:40.969929"], ["updated_at", "2024-03-28 07:04:40.969929"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:04:40 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 4ms (Views: 0.3ms | ActiveRecord: 0.3ms | Allocations: 1040)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:04:40.981945"], ["updated_at", "2024-03-28 07:04:40.981945"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:04:40.985339"], ["updated_at", "2024-03-28 07:04:40.985339"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:04:40.986976"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:04:40.986976"], ["created_at", "2024-03-28 07:04:40.988183"], ["updated_at", "2024-03-28 07:04:40.988183"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.5ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:04:40.997805"], ["updated_at", "2024-03-28 07:04:40.997805"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:04:41.001009"], ["updated_at", "2024-03-28 07:04:41.001009"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:04:41.002978"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:04:41.002978"], ["created_at", "2024-03-28 07:04:41.004405"], ["updated_at", "2024-03-28 07:04:41.004405"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 357)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.3ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 5ms (Views: 3.7ms | ActiveRecord: 0.3ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (2.9ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:04:41.025797"], ["updated_at", "2024-03-28 07:04:41.025797"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 5ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 6ms (ActiveRecord: 0.0ms | Allocations: 471)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 5ms (ActiveRecord: 0.0ms | Allocations: 388)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (2.8ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", ""], ["rule_data", "{}"], ["created_at", "2024-03-28 07:04:41.104660"], ["updated_at", "2024-03-28 07:04:41.104660"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.7ms | ActiveRecord: 0.8ms | Allocations: 946)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (2.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.9ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:04:41.142440"], ["updated_at", "2024-03-28 07:04:41.142440"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:04:41.150332"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 2.2ms | ActiveRecord: 0.5ms | Allocations: 1220)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:04:41.158580"], ["updated_at", "2024-03-28 07:04:41.158580"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:04:41.164070"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 1181)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:04:41.169266"], ["updated_at", "2024-03-28 07:04:41.169266"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.5ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", ""], ["rule_data", "{}"], ["updated_at", "2024-03-28 07:04:41.177548"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.3ms | ActiveRecord: 0.7ms | Allocations: 1047)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:04:41.184289"], ["updated_at", "2024-03-28 07:04:41.184289"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.2ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:04:41.192569"], ["updated_at", "2024-03-28 07:04:41.192569"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.7ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 1.0ms | Allocations: 356)
  [1m[35m (1.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 1ms (Views: 0.6ms | ActiveRecord: 0.2ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:04:41.211072"], ["updated_at", "2024-03-28 07:04:41.211072"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 8ms (Views: 1.2ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (6.0ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:04:41.231762"], ["updated_at", "2024-03-28 07:04:41.231762"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 14ms (Views: 2.2ms | ActiveRecord: 6.2ms | Allocations: 763)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (2.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:04:41.257386"], ["updated_at", "2024-03-28 07:04:41.257386"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 17ms (Views: 0.9ms | ActiveRecord: 3.6ms | Allocations: 761)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (2.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:04:41.280460"], ["updated_at", "2024-03-28 07:04:41.280460"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.5ms | ActiveRecord: 2.3ms | Allocations: 761)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:04:41.288847"], ["updated_at", "2024-03-28 07:04:41.288847"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:04:41.294901"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.6ms | ActiveRecord: 0.6ms | Allocations: 842)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:04:41.302387"], ["updated_at", "2024-03-28 07:04:41.302387"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:04:41.307059"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 806)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:04:41.312812"], ["updated_at", "2024-03-28 07:04:41.312812"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 07:04:41.320156"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.5ms | ActiveRecord: 0.5ms | Allocations: 848)
  [1m[35m (1.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (4.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:04:41.327625"], ["updated_at", "2024-03-28 07:04:41.327625"]]
  [1m[35m (2.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 0.9ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:04:41.347972"], ["updated_at", "2024-03-28 07:04:41.347972"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:04:41 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 15:04:41 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:04:41.428103"], ["updated_at", "2024-03-28 07:04:41.428103"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:04:41.433984"], ["updated_at", "2024-03-28 07:04:41.433984"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:04:41"], ["created_at", "2024-03-28 07:04:41.438122"], ["updated_at", "2024-03-28 07:04:41.438122"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 23ms (Views: 0.6ms | ActiveRecord: 2.0ms | Allocations: 2950)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:04:41 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:04:41.463376"], ["updated_at", "2024-03-28 07:04:41.463376"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:04:41.470773"], ["updated_at", "2024-03-28 07:04:41.470773"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (1.6ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:04:41.473805"], ["updated_at", "2024-03-28 07:04:41.473805"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 20ms (Views: 3.8ms | ActiveRecord: 3.0ms | Allocations: 2174)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (1.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:11:39 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:11:39.978609"], ["updated_at", "2024-03-28 07:11:39.978609"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:11:40.014196"], ["updated_at", "2024-03-28 07:11:40.014196"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:11:39"], ["created_at", "2024-03-28 07:11:40.038696"], ["updated_at", "2024-03-28 07:11:40.038696"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 71ms (Views: 0.7ms | ActiveRecord: 2.7ms | Allocations: 16861)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:11:40 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:11:40.048366"], ["updated_at", "2024-03-28 07:11:40.048366"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:11:40.050486"], ["updated_at", "2024-03-28 07:11:40.050486"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:11:40"], ["created_at", "2024-03-28 07:11:40.054843"], ["updated_at", "2024-03-28 07:11:40.054843"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 13ms (Views: 3.9ms | ActiveRecord: 1.5ms | Allocations: 2639)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 07:11:40.066683"], ["updated_at", "2024-03-28 07:11:40.066683"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 07:11:40.068187"], ["updated_at", "2024-03-28 07:11:40.068187"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:11:40.072112"], ["updated_at", "2024-03-28 07:11:40.072112"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 8ms (Views: 0.2ms | ActiveRecord: 1.4ms | Allocations: 2133)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 3ms (Views: 0.8ms | ActiveRecord: 0.3ms | Allocations: 323)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:11:40.089845"], ["updated_at", "2024-03-28 07:11:40.089845"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:11:40.094390"], ["updated_at", "2024-03-28 07:11:40.094390"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:11:40.096484"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.6ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:11:40.096484"], ["created_at", "2024-03-28 07:11:40.098001"], ["updated_at", "2024-03-28 07:11:40.098001"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 4ms (Views: 0.5ms | ActiveRecord: 0.3ms | Allocations: 553)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:11:40.110149"], ["updated_at", "2024-03-28 07:11:40.110149"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:11:40.114869"], ["updated_at", "2024-03-28 07:11:40.114869"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 15:11:40 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.3ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:11:40"], ["created_at", "2024-03-28 07:11:40.122756"], ["updated_at", "2024-03-28 07:11:40.122756"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.4ms | ActiveRecord: 1.0ms | Allocations: 1465)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:11:40.129312"], ["updated_at", "2024-03-28 07:11:40.129312"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:11:40.132372"], ["updated_at", "2024-03-28 07:11:40.132372"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 15:11:40 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:11:40"], ["created_at", "2024-03-28 07:11:40.138919"], ["updated_at", "2024-03-28 07:11:40.138919"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 1173)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:11:40 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 10ms (Views: 0.4ms | ActiveRecord: 0.0ms | Allocations: 1946)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:11:40.159418"], ["updated_at", "2024-03-28 07:11:40.159418"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:11:40.161705"], ["updated_at", "2024-03-28 07:11:40.161705"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:11:40.163744"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:11:40.163744"], ["created_at", "2024-03-28 07:11:40.165045"], ["updated_at", "2024-03-28 07:11:40.165045"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:11:40 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 07:11:40"], ["updated_at", "2024-03-28 07:11:40.172647"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 1422)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (2.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:11:40.182556"], ["updated_at", "2024-03-28 07:11:40.182556"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:11:40.184543"], ["updated_at", "2024-03-28 07:11:40.184543"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:11:40.187100"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.5ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:11:40.187100"], ["created_at", "2024-03-28 07:11:40.188601"], ["updated_at", "2024-03-28 07:11:40.188601"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:11:40 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 07:11:40"], ["updated_at", "2024-03-28 07:11:40.196292"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 1268)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:11:40.204884"], ["updated_at", "2024-03-28 07:11:40.204884"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:11:40.206998"], ["updated_at", "2024-03-28 07:11:40.206998"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:11:40.208336"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.6ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:11:40.208336"], ["created_at", "2024-03-28 07:11:40.211233"], ["updated_at", "2024-03-28 07:11:40.211233"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:11:40 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 2ms (Views: 0.2ms | ActiveRecord: 0.2ms | Allocations: 1040)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:11:40.223284"], ["updated_at", "2024-03-28 07:11:40.223284"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.9ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:11:40.225465"], ["updated_at", "2024-03-28 07:11:40.225465"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:11:40.229584"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:11:40.229584"], ["created_at", "2024-03-28 07:11:40.230943"], ["updated_at", "2024-03-28 07:11:40.230943"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:11:40.238886"], ["updated_at", "2024-03-28 07:11:40.238886"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:11:40.240976"], ["updated_at", "2024-03-28 07:11:40.240976"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:11:40.243549"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:11:40.243549"], ["created_at", "2024-03-28 07:11:40.245956"], ["updated_at", "2024-03-28 07:11:40.245956"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 1.2ms | Allocations: 357)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:11:40.271995"], ["updated_at", "2024-03-28 07:11:40.271995"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 5ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms | Allocations: 471)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 5ms (ActiveRecord: 0.0ms | Allocations: 388)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
  [1m[35m (2.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", ""], ["rule_data", "{}"], ["created_at", "2024-03-28 07:11:40.350102"], ["updated_at", "2024-03-28 07:11:40.350102"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 10ms (Views: 0.4ms | ActiveRecord: 3.4ms | Allocations: 946)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:11:40.390040"], ["updated_at", "2024-03-28 07:11:40.390040"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.4ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:11:40.396561"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 2.3ms | ActiveRecord: 0.8ms | Allocations: 1220)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:11:40.406301"], ["updated_at", "2024-03-28 07:11:40.406301"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:11:40.412744"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 1181)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:11:40.417854"], ["updated_at", "2024-03-28 07:11:40.417854"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", ""], ["rule_data", "{}"], ["updated_at", "2024-03-28 07:11:40.423982"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.4ms | ActiveRecord: 0.3ms | Allocations: 1047)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:11:40.430338"], ["updated_at", "2024-03-28 07:11:40.430338"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:11:40.442670"], ["updated_at", "2024-03-28 07:11:40.442670"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (1.7ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 2ms (Views: 0.7ms | ActiveRecord: 0.2ms | Allocations: 280)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:11:40.462885"], ["updated_at", "2024-03-28 07:11:40.462885"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.6ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:11:40.480801"], ["updated_at", "2024-03-28 07:11:40.480801"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.5ms | ActiveRecord: 0.9ms | Allocations: 763)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:11:40.492800"], ["updated_at", "2024-03-28 07:11:40.492800"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.6ms | ActiveRecord: 1.7ms | Allocations: 761)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:11:40.506235"], ["updated_at", "2024-03-28 07:11:40.506235"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.8ms | ActiveRecord: 0.7ms | Allocations: 761)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:11:40.513845"], ["updated_at", "2024-03-28 07:11:40.513845"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.4ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:11:40.521377"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 0.7ms | Allocations: 842)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:11:40.527535"], ["updated_at", "2024-03-28 07:11:40.527535"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:11:40.532125"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.3ms | Allocations: 806)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:11:40.540675"], ["updated_at", "2024-03-28 07:11:40.540675"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 07:11:40.546585"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 848)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:11:40.554719"], ["updated_at", "2024-03-28 07:11:40.554719"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.5ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:11:40.566170"], ["updated_at", "2024-03-28 07:11:40.566170"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.5ms | Allocations: 356)
  [1m[35m (1.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:11:40 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 15:11:40 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:11:40.657300"], ["updated_at", "2024-03-28 07:11:40.657300"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:11:40.660090"], ["updated_at", "2024-03-28 07:11:40.660090"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:11:40"], ["created_at", "2024-03-28 07:11:40.673009"], ["updated_at", "2024-03-28 07:11:40.673009"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 30ms (Views: 1.0ms | ActiveRecord: 2.4ms | Allocations: 2924)
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:11:40 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:11:40.717513"], ["updated_at", "2024-03-28 07:11:40.717513"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:11:40.719385"], ["updated_at", "2024-03-28 07:11:40.719385"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:11:40.723463"], ["updated_at", "2024-03-28 07:11:40.723463"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 14ms (Views: 0.2ms | ActiveRecord: 1.9ms | Allocations: 2168)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 2423)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:19:48 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:19:48.034025"], ["updated_at", "2024-03-28 07:19:48.034025"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:19:48.050672"], ["updated_at", "2024-03-28 07:19:48.050672"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.5ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:19:48"], ["created_at", "2024-03-28 07:19:48.075524"], ["updated_at", "2024-03-28 07:19:48.075524"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 55ms (Views: 0.9ms | ActiveRecord: 3.1ms | Allocations: 16840)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:19:48 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:19:48.102036"], ["updated_at", "2024-03-28 07:19:48.102036"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (17.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:19:48.105397"], ["updated_at", "2024-03-28 07:19:48.105397"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.7ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:19:48"], ["created_at", "2024-03-28 07:19:48.132865"], ["updated_at", "2024-03-28 07:19:48.132865"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 50ms (Views: 14.7ms | ActiveRecord: 19.8ms | Allocations: 2639)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 07:19:48.188743"], ["updated_at", "2024-03-28 07:19:48.188743"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 07:19:48.194579"], ["updated_at", "2024-03-28 07:19:48.194579"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:19:48.198940"], ["updated_at", "2024-03-28 07:19:48.198940"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 14ms (Views: 0.2ms | ActiveRecord: 2.5ms | Allocations: 2133)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.4ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 3ms (Views: 2.5ms | ActiveRecord: 0.4ms | Allocations: 316)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:19:48.215536"], ["updated_at", "2024-03-28 07:19:48.215536"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 536)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 4ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 844)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 1ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 759)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", ""], ["rule_data", "{}"], ["created_at", "2024-03-28 07:19:48.245509"], ["updated_at", "2024-03-28 07:19:48.245509"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 7ms (Views: 0.2ms | ActiveRecord: 0.7ms | Allocations: 1364)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:19:48.254197"], ["updated_at", "2024-03-28 07:19:48.254197"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:19:48.262433"], ["id", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.5ms | ActiveRecord: 0.7ms | Allocations: 1359)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:19:48.271687"], ["updated_at", "2024-03-28 07:19:48.271687"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:19:48.279058"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.7ms | ActiveRecord: 0.4ms | Allocations: 1181)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:19:48.286041"], ["updated_at", "2024-03-28 07:19:48.286041"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", ""], ["rule_data", "{}"], ["updated_at", "2024-03-28 07:19:48.308244"], ["id", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 21ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 1048)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:19:48.320898"], ["updated_at", "2024-03-28 07:19:48.320898"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 425)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:19:48.334456"], ["updated_at", "2024-03-28 07:19:48.334456"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 0.5ms | Allocations: 356)
  [1m[35m (1.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 1ms (Views: 0.7ms | ActiveRecord: 0.2ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:19:48.352865"], ["updated_at", "2024-03-28 07:19:48.352865"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 3ms (Views: 1.8ms | ActiveRecord: 0.2ms | Allocations: 539)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:19:48.369479"], ["updated_at", "2024-03-28 07:19:48.369479"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.6ms | ActiveRecord: 0.7ms | Allocations: 857)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (2.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:19:48.379435"], ["updated_at", "2024-03-28 07:19:48.379435"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 7ms (Views: 0.5ms | ActiveRecord: 2.8ms | Allocations: 855)
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:19:48.394320"], ["updated_at", "2024-03-28 07:19:48.394320"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 6ms (Views: 0.3ms | ActiveRecord: 0.7ms | Allocations: 890)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:19:48.403108"], ["updated_at", "2024-03-28 07:19:48.403108"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:19:48.410432"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.3ms | ActiveRecord: 0.5ms | Allocations: 842)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (1.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:19:48.417144"], ["updated_at", "2024-03-28 07:19:48.417144"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:19:48.421835"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.3ms | ActiveRecord: 0.3ms | Allocations: 806)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:19:48.428436"], ["updated_at", "2024-03-28 07:19:48.428436"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 07:19:48.435349"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.4ms | ActiveRecord: 0.3ms | Allocations: 848)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.0ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:19:48.440283"], ["updated_at", "2024-03-28 07:19:48.440283"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.4ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 0.7ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:19:48.453586"], ["updated_at", "2024-03-28 07:19:48.453586"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:19:48 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 15:19:48 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:19:48.511039"], ["updated_at", "2024-03-28 07:19:48.511039"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:19:48.513345"], ["updated_at", "2024-03-28 07:19:48.513345"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:19:48"], ["created_at", "2024-03-28 07:19:48.515818"], ["updated_at", "2024-03-28 07:19:48.515818"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 16ms (Views: 0.6ms | ActiveRecord: 1.2ms | Allocations: 2924)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:19:48 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:19:48.545087"], ["updated_at", "2024-03-28 07:19:48.545087"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:19:48.549858"], ["updated_at", "2024-03-28 07:19:48.549858"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (3.6ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:19:48.559763"], ["updated_at", "2024-03-28 07:19:48.559763"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 31ms (Views: 0.2ms | ActiveRecord: 4.8ms | Allocations: 2167)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (2.7ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (4.3ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 56ms (Views: 0.4ms | ActiveRecord: 4.7ms | Allocations: 3436)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (2.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:21:29 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:21:29.064794"], ["updated_at", "2024-03-28 07:21:29.064794"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:21:29.076526"], ["updated_at", "2024-03-28 07:21:29.076526"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:21:29"], ["created_at", "2024-03-28 07:21:29.111023"], ["updated_at", "2024-03-28 07:21:29.111023"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 58ms (Views: 0.8ms | ActiveRecord: 2.7ms | Allocations: 20088)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:21:29 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:21:29.119559"], ["updated_at", "2024-03-28 07:21:29.119559"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:21:29.121285"], ["updated_at", "2024-03-28 07:21:29.121285"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.3ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:21:29"], ["created_at", "2024-03-28 07:21:29.125596"], ["updated_at", "2024-03-28 07:21:29.125596"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 157ms (Views: 147.7ms | ActiveRecord: 1.8ms | Allocations: 2639)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 07:21:29.289740"], ["updated_at", "2024-03-28 07:21:29.289740"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 07:21:29.293896"], ["updated_at", "2024-03-28 07:21:29.293896"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:21:29.306509"], ["updated_at", "2024-03-28 07:21:29.306509"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 20ms (Views: 0.2ms | ActiveRecord: 1.8ms | Allocations: 2133)
  [1m[35m (2.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.3ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 8ms (Views: 0.8ms | ActiveRecord: 0.3ms | Allocations: 316)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (7.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:21:29.326145"], ["updated_at", "2024-03-28 07:21:29.326145"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 536)
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 4ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 844)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 2ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 759)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", ""], ["rule_data", "{}"], ["created_at", "2024-03-28 07:21:29.435109"], ["updated_at", "2024-03-28 07:21:29.435109"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 5ms (Views: 0.2ms | ActiveRecord: 0.7ms | Allocations: 1364)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:21:29.451391"], ["updated_at", "2024-03-28 07:21:29.451391"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:21:29.458217"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.6ms | ActiveRecord: 0.7ms | Allocations: 1359)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:21:29.471189"], ["updated_at", "2024-03-28 07:21:29.471189"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:21:29.481088"], ["id", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.6ms | ActiveRecord: 0.5ms | Allocations: 1181)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:21:29.493307"], ["updated_at", "2024-03-28 07:21:29.493307"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", ""], ["rule_data", "{}"], ["updated_at", "2024-03-28 07:21:29.502796"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 1047)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:21:29.540558"], ["updated_at", "2024-03-28 07:21:29.540558"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 425)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:21:29.550566"], ["updated_at", "2024-03-28 07:21:29.550566"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 356)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 1ms (Views: 0.6ms | ActiveRecord: 0.2ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:21:29.564335"], ["updated_at", "2024-03-28 07:21:29.564335"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.4ms | ActiveRecord: 0.2ms | Allocations: 539)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:21:29.576219"], ["updated_at", "2024-03-28 07:21:29.576219"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.5ms | ActiveRecord: 0.6ms | Allocations: 857)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:21:29.588352"], ["updated_at", "2024-03-28 07:21:29.588352"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 855)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:21:29.596729"], ["updated_at", "2024-03-28 07:21:29.596729"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 7ms (Views: 0.2ms | ActiveRecord: 0.6ms | Allocations: 890)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:21:29.606078"], ["updated_at", "2024-03-28 07:21:29.606078"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:21:29.610046"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 842)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:21:29.619215"], ["updated_at", "2024-03-28 07:21:29.619215"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:21:29.624563"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.3ms | Allocations: 806)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:21:29.629930"], ["updated_at", "2024-03-28 07:21:29.629930"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 07:21:29.637422"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.5ms | ActiveRecord: 0.4ms | Allocations: 848)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:21:29.642658"], ["updated_at", "2024-03-28 07:21:29.642658"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.5ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:21:29.655394"], ["updated_at", "2024-03-28 07:21:29.655394"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 356)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:21:29 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 15:21:29 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:21:29.716558"], ["updated_at", "2024-03-28 07:21:29.716558"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:21:29.719250"], ["updated_at", "2024-03-28 07:21:29.719250"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.5ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:21:29"], ["created_at", "2024-03-28 07:21:29.722292"], ["updated_at", "2024-03-28 07:21:29.722292"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 17ms (Views: 0.6ms | ActiveRecord: 1.7ms | Allocations: 2924)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:21:29 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:21:29.738686"], ["updated_at", "2024-03-28 07:21:29.738686"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:21:29.740717"], ["updated_at", "2024-03-28 07:21:29.740717"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.6ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:21:29.743222"], ["updated_at", "2024-03-28 07:21:29.743222"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 9ms (Views: 0.2ms | ActiveRecord: 1.7ms | Allocations: 2167)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 7ms (Views: 0.5ms | ActiveRecord: 0.4ms | Allocations: 2423)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:23:10 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:23:10.921888"], ["updated_at", "2024-03-28 07:23:10.921888"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:23:10.935572"], ["updated_at", "2024-03-28 07:23:10.935572"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:23:10"], ["created_at", "2024-03-28 07:23:10.955342"], ["updated_at", "2024-03-28 07:23:10.955342"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 44ms (Views: 0.7ms | ActiveRecord: 2.9ms | Allocations: 16839)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:23:10 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:23:10.966712"], ["updated_at", "2024-03-28 07:23:10.966712"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:23:10.969433"], ["updated_at", "2024-03-28 07:23:10.969433"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.9ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:23:10"], ["created_at", "2024-03-28 07:23:10.974790"], ["updated_at", "2024-03-28 07:23:10.974790"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 13ms (Views: 0.6ms | ActiveRecord: 2.5ms | Allocations: 2639)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 07:23:10.984117"], ["updated_at", "2024-03-28 07:23:10.984117"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 07:23:10.986513"], ["updated_at", "2024-03-28 07:23:10.986513"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:23:10.989983"], ["updated_at", "2024-03-28 07:23:10.989983"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 8ms (Views: 0.2ms | ActiveRecord: 1.5ms | Allocations: 2133)
  [1m[35m (1.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 2ms (Views: 0.8ms | ActiveRecord: 0.2ms | Allocations: 316)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:23:11.003998"], ["updated_at", "2024-03-28 07:23:11.003998"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 536)
  [1m[35m (2.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 4ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 844)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 5ms (Views: 1.9ms | ActiveRecord: 0.0ms | Allocations: 759)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", ""], ["rule_data", "{}"], ["created_at", "2024-03-28 07:23:11.039437"], ["updated_at", "2024-03-28 07:23:11.039437"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 7ms (Views: 0.3ms | ActiveRecord: 0.6ms | Allocations: 1364)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:23:11.047981"], ["updated_at", "2024-03-28 07:23:11.047981"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:23:11.055539"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 1359)
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:23:11.062623"], ["updated_at", "2024-03-28 07:23:11.062623"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:23:11.070398"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 1181)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (2.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:23:11.074581"], ["updated_at", "2024-03-28 07:23:11.074581"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", ""], ["rule_data", "{}"], ["updated_at", "2024-03-28 07:23:11.085074"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.6ms | ActiveRecord: 0.4ms | Allocations: 1047)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:23:11.100973"], ["updated_at", "2024-03-28 07:23:11.100973"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 425)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (2.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:23:11.116475"], ["updated_at", "2024-03-28 07:23:11.116475"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 356)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 3ms (Views: 2.4ms | ActiveRecord: 0.2ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:23:11.137689"], ["updated_at", "2024-03-28 07:23:11.137689"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.4ms | ActiveRecord: 0.2ms | Allocations: 539)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:23:11.155538"], ["updated_at", "2024-03-28 07:23:11.155538"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 3ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 911)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:23:11.167784"], ["updated_at", "2024-03-28 07:23:11.167784"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 7ms (Views: 0.5ms | ActiveRecord: 0.8ms | Allocations: 905)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:23:11.184840"], ["updated_at", "2024-03-28 07:23:11.184840"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 6ms (Views: 0.3ms | ActiveRecord: 0.9ms | Allocations: 941)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:23:11.194820"], ["updated_at", "2024-03-28 07:23:11.194820"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:23:11.202223"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.6ms | ActiveRecord: 0.4ms | Allocations: 842)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:23:11.207514"], ["updated_at", "2024-03-28 07:23:11.207514"]]
  [1m[35m (1.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:23:11.215105"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 1.8ms | ActiveRecord: 0.5ms | Allocations: 806)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:23:11.222461"], ["updated_at", "2024-03-28 07:23:11.222461"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 07:23:11.230631"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.9ms | ActiveRecord: 0.5ms | Allocations: 848)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:23:11.238439"], ["updated_at", "2024-03-28 07:23:11.238439"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 5ms (ActiveRecord: 0.6ms | Allocations: 363)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:23:11.253467"], ["updated_at", "2024-03-28 07:23:11.253467"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.8ms | Allocations: 356)
  [1m[35m (1.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (8.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:23:11 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 15:23:11 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:23:11.321242"], ["updated_at", "2024-03-28 07:23:11.321242"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:23:11.323269"], ["updated_at", "2024-03-28 07:23:11.323269"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:23:11"], ["created_at", "2024-03-28 07:23:11.327741"], ["updated_at", "2024-03-28 07:23:11.327741"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 17ms (Views: 0.7ms | ActiveRecord: 1.5ms | Allocations: 2924)
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:23:11 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:23:11.344907"], ["updated_at", "2024-03-28 07:23:11.344907"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:23:11.346856"], ["updated_at", "2024-03-28 07:23:11.346856"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:23:11.350914"], ["updated_at", "2024-03-28 07:23:11.350914"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 9ms (Views: 0.3ms | ActiveRecord: 1.5ms | Allocations: 2167)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:24:08 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:24:08.247732"], ["updated_at", "2024-03-28 07:24:08.247732"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:24:08.282939"], ["updated_at", "2024-03-28 07:24:08.282939"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:24:08"], ["created_at", "2024-03-28 07:24:08.302850"], ["updated_at", "2024-03-28 07:24:08.302850"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 67ms (Views: 0.7ms | ActiveRecord: 2.7ms | Allocations: 16860)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:24:08 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:24:08.313350"], ["updated_at", "2024-03-28 07:24:08.313350"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:24:08.315965"], ["updated_at", "2024-03-28 07:24:08.315965"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:24:08"], ["created_at", "2024-03-28 07:24:08.320049"], ["updated_at", "2024-03-28 07:24:08.320049"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 10ms (Views: 0.8ms | ActiveRecord: 1.7ms | Allocations: 2639)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 07:24:08.328994"], ["updated_at", "2024-03-28 07:24:08.328994"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 07:24:08.331405"], ["updated_at", "2024-03-28 07:24:08.331405"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.6ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:24:08.336640"], ["updated_at", "2024-03-28 07:24:08.336640"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 12ms (Views: 0.2ms | ActiveRecord: 2.2ms | Allocations: 2133)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 1ms (Views: 0.6ms | ActiveRecord: 0.3ms | Allocations: 323)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:24:08.350745"], ["updated_at", "2024-03-28 07:24:08.350745"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:24:08.354314"], ["updated_at", "2024-03-28 07:24:08.354314"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:24:08.356716"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:24:08.356716"], ["created_at", "2024-03-28 07:24:08.358066"], ["updated_at", "2024-03-28 07:24:08.358066"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 3ms (Views: 0.7ms | ActiveRecord: 0.2ms | Allocations: 553)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:24:08.369754"], ["updated_at", "2024-03-28 07:24:08.369754"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:24:08.372283"], ["updated_at", "2024-03-28 07:24:08.372283"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 15:24:08 +0800", "tour_id"=>"1"}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.4ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:24:08"], ["created_at", "2024-03-28 07:24:08.380009"], ["updated_at", "2024-03-28 07:24:08.380009"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 7ms (Views: 0.4ms | ActiveRecord: 1.0ms | Allocations: 1541)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:24:08.385782"], ["updated_at", "2024-03-28 07:24:08.385782"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:24:08.389189"], ["updated_at", "2024-03-28 07:24:08.389189"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 15:24:08 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:24:08"], ["created_at", "2024-03-28 07:24:08.398432"], ["updated_at", "2024-03-28 07:24:08.398432"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.5ms | ActiveRecord: 0.9ms | Allocations: 1249)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:24:08 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 21ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 3200)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.0ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:24:08.432104"], ["updated_at", "2024-03-28 07:24:08.432104"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:24:08.436028"], ["updated_at", "2024-03-28 07:24:08.436028"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:24:08.438306"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (1.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:24:08.438306"], ["created_at", "2024-03-28 07:24:08.441524"], ["updated_at", "2024-03-28 07:24:08.441524"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:24:08 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 07:24:08"], ["updated_at", "2024-03-28 07:24:08.448706"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 1422)
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:24:08.459993"], ["updated_at", "2024-03-28 07:24:08.459993"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:24:08.462470"], ["updated_at", "2024-03-28 07:24:08.462470"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:24:08.464038"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:24:08.464038"], ["created_at", "2024-03-28 07:24:08.465758"], ["updated_at", "2024-03-28 07:24:08.465758"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:24:08 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.0ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 07:24:08"], ["updated_at", "2024-03-28 07:24:08.471468"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 1268)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.9ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:24:08.479662"], ["updated_at", "2024-03-28 07:24:08.479662"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:24:08.483323"], ["updated_at", "2024-03-28 07:24:08.483323"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:24:08.484758"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:24:08.484758"], ["created_at", "2024-03-28 07:24:08.487617"], ["updated_at", "2024-03-28 07:24:08.487617"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:24:08 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 3ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 1040)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:24:08.499337"], ["updated_at", "2024-03-28 07:24:08.499337"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:24:08.501670"], ["updated_at", "2024-03-28 07:24:08.501670"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:24:08.502753"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:24:08.502753"], ["created_at", "2024-03-28 07:24:08.503706"], ["updated_at", "2024-03-28 07:24:08.503706"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.5ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:24:08.514698"], ["updated_at", "2024-03-28 07:24:08.514698"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:24:08.517049"], ["updated_at", "2024-03-28 07:24:08.517049"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:24:08.518772"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:24:08.518772"], ["created_at", "2024-03-28 07:24:08.520584"], ["updated_at", "2024-03-28 07:24:08.520584"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.6ms | Allocations: 357)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.3ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 7ms (Views: 0.8ms | ActiveRecord: 0.3ms | Allocations: 314)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:24:08.550801"], ["updated_at", "2024-03-28 07:24:08.550801"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 4ms (Views: 2.7ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 13ms (Views: 2.9ms | ActiveRecord: 0.0ms | Allocations: 843)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 9ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 759)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", ""], ["rule_data", "{}"], ["created_at", "2024-03-28 07:24:08.642899"], ["updated_at", "2024-03-28 07:24:08.642899"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 13ms (Views: 3.6ms | ActiveRecord: 0.8ms | Allocations: 1364)
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:24:08.658232"], ["updated_at", "2024-03-28 07:24:08.658232"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:24:08.665870"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.7ms | ActiveRecord: 0.4ms | Allocations: 1222)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:24:08.676377"], ["updated_at", "2024-03-28 07:24:08.676377"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:24:08.683066"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.3ms | ActiveRecord: 0.3ms | Allocations: 1181)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:24:08.690992"], ["updated_at", "2024-03-28 07:24:08.690992"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (1.0ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", ""], ["rule_data", "{}"], ["updated_at", "2024-03-28 07:24:08.698608"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.4ms | ActiveRecord: 1.3ms | Allocations: 1047)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:24:08.714987"], ["updated_at", "2024-03-28 07:24:08.714987"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:24:08.727181"], ["updated_at", "2024-03-28 07:24:08.727181"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.5ms | Allocations: 356)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.4ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 2ms (Views: 0.9ms | ActiveRecord: 0.4ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:24:08.749044"], ["updated_at", "2024-03-28 07:24:08.749044"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 3ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:24:08.764619"], ["updated_at", "2024-03-28 07:24:08.764619"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 911)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.9ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:24:08.776259"], ["updated_at", "2024-03-28 07:24:08.776259"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.6ms | ActiveRecord: 1.1ms | Allocations: 905)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.9ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:24:08.786265"], ["updated_at", "2024-03-28 07:24:08.786265"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 4ms (Views: 0.2ms | ActiveRecord: 1.1ms | Allocations: 941)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:24:08.794172"], ["updated_at", "2024-03-28 07:24:08.794172"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:24:08.802871"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.7ms | ActiveRecord: 0.6ms | Allocations: 842)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (2.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:24:08.813126"], ["updated_at", "2024-03-28 07:24:08.813126"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (2.0ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:24:08.821242"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.4ms | ActiveRecord: 2.3ms | Allocations: 806)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:24:08.828552"], ["updated_at", "2024-03-28 07:24:08.828552"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 07:24:08.840253"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.6ms | ActiveRecord: 0.5ms | Allocations: 848)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:24:08.854685"], ["updated_at", "2024-03-28 07:24:08.854685"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (4.8ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 17ms (ActiveRecord: 5.2ms | Allocations: 363)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:24:08.893595"], ["updated_at", "2024-03-28 07:24:08.893595"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (3.9ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (1.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 8ms (ActiveRecord: 5.8ms | Allocations: 356)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:24:08 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 15:24:08 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (3.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:24:08.993624"], ["updated_at", "2024-03-28 07:24:08.993624"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (4.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:24:09.004526"], ["updated_at", "2024-03-28 07:24:09.004526"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.5ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:24:08"], ["created_at", "2024-03-28 07:24:09.022547"], ["updated_at", "2024-03-28 07:24:09.022547"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 58ms (Views: 1.1ms | ActiveRecord: 9.4ms | Allocations: 2924)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:24:09 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:24:09.091472"], ["updated_at", "2024-03-28 07:24:09.091472"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.0ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:24:09.094473"], ["updated_at", "2024-03-28 07:24:09.094473"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:24:09.116187"], ["updated_at", "2024-03-28 07:24:09.116187"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 31ms (Views: 0.3ms | ActiveRecord: 3.2ms | Allocations: 2167)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:25:14 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:25:14.750372"], ["updated_at", "2024-03-28 07:25:14.750372"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:25:14.783628"], ["updated_at", "2024-03-28 07:25:14.783628"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:25:14"], ["created_at", "2024-03-28 07:25:14.806279"], ["updated_at", "2024-03-28 07:25:14.806279"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 68ms (Views: 0.7ms | ActiveRecord: 2.7ms | Allocations: 16860)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:25:14 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:25:14.816749"], ["updated_at", "2024-03-28 07:25:14.816749"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:25:14.820646"], ["updated_at", "2024-03-28 07:25:14.820646"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:25:14"], ["created_at", "2024-03-28 07:25:14.825370"], ["updated_at", "2024-03-28 07:25:14.825370"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 12ms (Views: 1.0ms | ActiveRecord: 1.9ms | Allocations: 2639)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 07:25:14.835015"], ["updated_at", "2024-03-28 07:25:14.835015"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 07:25:14.836729"], ["updated_at", "2024-03-28 07:25:14.836729"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:25:14.839439"], ["updated_at", "2024-03-28 07:25:14.839439"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 7ms (Views: 0.2ms | ActiveRecord: 1.2ms | Allocations: 2133)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 2ms (Views: 0.7ms | ActiveRecord: 0.3ms | Allocations: 323)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:25:14.852377"], ["updated_at", "2024-03-28 07:25:14.852377"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:25:14.856109"], ["updated_at", "2024-03-28 07:25:14.856109"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:25:14.858427"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:25:14.858427"], ["created_at", "2024-03-28 07:25:14.861072"], ["updated_at", "2024-03-28 07:25:14.861072"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 553)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:25:14.872768"], ["updated_at", "2024-03-28 07:25:14.872768"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:25:14.874970"], ["updated_at", "2024-03-28 07:25:14.874970"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 15:25:14 +0800", "tour_id"=>"1"}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (1.4ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:25:14"], ["created_at", "2024-03-28 07:25:14.885047"], ["updated_at", "2024-03-28 07:25:14.885047"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 9ms (Views: 0.4ms | ActiveRecord: 2.1ms | Allocations: 1541)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:25:14.891418"], ["updated_at", "2024-03-28 07:25:14.891418"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:25:14.893125"], ["updated_at", "2024-03-28 07:25:14.893125"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 15:25:14 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:25:14"], ["created_at", "2024-03-28 07:25:14.902352"], ["updated_at", "2024-03-28 07:25:14.902352"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 3ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 1249)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:25:14 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 7ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 2014)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:25:14.919390"], ["updated_at", "2024-03-28 07:25:14.919390"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:25:14.922716"], ["updated_at", "2024-03-28 07:25:14.922716"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:25:14.924010"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:25:14.924010"], ["created_at", "2024-03-28 07:25:14.925004"], ["updated_at", "2024-03-28 07:25:14.925004"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:25:14 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 07:25:14"], ["updated_at", "2024-03-28 07:25:14.931670"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 1422)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:25:14.939500"], ["updated_at", "2024-03-28 07:25:14.939500"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:25:14.941719"], ["updated_at", "2024-03-28 07:25:14.941719"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:25:14.942724"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (1.7ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:25:14.942724"], ["created_at", "2024-03-28 07:25:14.945907"], ["updated_at", "2024-03-28 07:25:14.945907"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:25:14 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 07:25:14"], ["updated_at", "2024-03-28 07:25:14.954655"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 0.6ms | Allocations: 1268)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:25:14.959683"], ["updated_at", "2024-03-28 07:25:14.959683"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:25:14.961900"], ["updated_at", "2024-03-28 07:25:14.961900"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:25:14.965276"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:25:14.965276"], ["created_at", "2024-03-28 07:25:14.967292"], ["updated_at", "2024-03-28 07:25:14.967292"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:25:14 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 2ms (Views: 0.2ms | ActiveRecord: 0.2ms | Allocations: 1040)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:25:14.975566"], ["updated_at", "2024-03-28 07:25:14.975566"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:25:14.977793"], ["updated_at", "2024-03-28 07:25:14.977793"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:25:14.981501"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:25:14.981501"], ["created_at", "2024-03-28 07:25:14.982993"], ["updated_at", "2024-03-28 07:25:14.982993"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:25:14.993101"], ["updated_at", "2024-03-28 07:25:14.993101"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:25:14.995424"], ["updated_at", "2024-03-28 07:25:14.995424"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:25:15.000034"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:25:15.000034"], ["created_at", "2024-03-28 07:25:15.001452"], ["updated_at", "2024-03-28 07:25:15.001452"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 0.4ms | Allocations: 357)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.3ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 2ms (Views: 0.8ms | ActiveRecord: 0.3ms | Allocations: 314)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (2.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:25:15.028212"], ["updated_at", "2024-03-28 07:25:15.028212"]]
  [1m[35m (2.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 5ms (Views: 0.6ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 5ms (Views: 0.4ms | ActiveRecord: 0.0ms | Allocations: 843)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 11ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 759)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (3.4ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", ""], ["rule_data", "{}"], ["created_at", "2024-03-28 07:25:15.115670"], ["updated_at", "2024-03-28 07:25:15.115670"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 15ms (Views: 0.5ms | ActiveRecord: 1.4ms | Allocations: 1364)
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (2.8ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (1.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:25:15.133564"], ["updated_at", "2024-03-28 07:25:15.133564"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:25:15.146030"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 1222)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:25:15.153436"], ["updated_at", "2024-03-28 07:25:15.153436"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:25:15.160772"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.5ms | ActiveRecord: 0.5ms | Allocations: 1181)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:25:15.168830"], ["updated_at", "2024-03-28 07:25:15.168830"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.7ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", ""], ["rule_data", "{}"], ["updated_at", "2024-03-28 07:25:15.175402"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.5ms | ActiveRecord: 0.9ms | Allocations: 1047)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:25:15.189930"], ["updated_at", "2024-03-28 07:25:15.189930"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.7ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:25:15.201054"], ["updated_at", "2024-03-28 07:25:15.201054"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 356)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 1ms (Views: 0.7ms | ActiveRecord: 0.2ms | Allocations: 280)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:25:15.217592"], ["updated_at", "2024-03-28 07:25:15.217592"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 4ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:25:15.232968"], ["updated_at", "2024-03-28 07:25:15.232968"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.5ms | ActiveRecord: 0.6ms | Allocations: 857)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:25:15.241846"], ["updated_at", "2024-03-28 07:25:15.241846"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 3ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 855)
  [1m[35m (1.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:25:15.253410"], ["updated_at", "2024-03-28 07:25:15.253410"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 7ms (Views: 0.2ms | ActiveRecord: 1.0ms | Allocations: 946)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:25:15.261778"], ["updated_at", "2024-03-28 07:25:15.261778"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:25:15.268918"], ["id", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.7ms | ActiveRecord: 0.8ms | Allocations: 842)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:25:15.276686"], ["updated_at", "2024-03-28 07:25:15.276686"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:25:15.286477"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 806)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (3.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:25:15.293686"], ["updated_at", "2024-03-28 07:25:15.293686"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 07:25:15.306151"], ["id", 1]]
  [1m[35m (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 3.8ms | ActiveRecord: 1.2ms | Allocations: 848)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:25:15.320822"], ["updated_at", "2024-03-28 07:25:15.320822"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (1.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 10ms (ActiveRecord: 1.7ms | Allocations: 363)
  [1m[35m (2.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.0ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:25:15.346591"], ["updated_at", "2024-03-28 07:25:15.346591"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 356)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (3.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:25:15 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 15:25:15 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:25:15.409922"], ["updated_at", "2024-03-28 07:25:15.409922"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:25:15.415176"], ["updated_at", "2024-03-28 07:25:15.415176"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.3ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:25:15"], ["created_at", "2024-03-28 07:25:15.420404"], ["updated_at", "2024-03-28 07:25:15.420404"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 21ms (Views: 0.7ms | ActiveRecord: 2.3ms | Allocations: 2924)
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:25:15 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:25:15.443907"], ["updated_at", "2024-03-28 07:25:15.443907"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:25:15.451208"], ["updated_at", "2024-03-28 07:25:15.451208"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:25:15.454057"], ["updated_at", "2024-03-28 07:25:15.454057"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 14ms (Views: 1.3ms | ActiveRecord: 1.6ms | Allocations: 2167)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (1.2ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:31:03 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.9ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:03.136536"], ["updated_at", "2024-03-28 07:31:03.136536"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:03.167810"], ["updated_at", "2024-03-28 07:31:03.167810"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:03"], ["created_at", "2024-03-28 07:31:03.193141"], ["updated_at", "2024-03-28 07:31:03.193141"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 71ms (Views: 0.8ms | ActiveRecord: 3.0ms | Allocations: 16860)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:31:03 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:03.203040"], ["updated_at", "2024-03-28 07:31:03.203040"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:03.205882"], ["updated_at", "2024-03-28 07:31:03.205882"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:03"], ["created_at", "2024-03-28 07:31:03.210764"], ["updated_at", "2024-03-28 07:31:03.210764"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 12ms (Views: 2.5ms | ActiveRecord: 1.8ms | Allocations: 2639)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 07:31:03.219981"], ["updated_at", "2024-03-28 07:31:03.219981"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 07:31:03.221732"], ["updated_at", "2024-03-28 07:31:03.221732"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:31:03.225041"], ["updated_at", "2024-03-28 07:31:03.225041"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 7ms (Views: 0.2ms | ActiveRecord: 1.3ms | Allocations: 2133)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.4ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 3ms (Views: 2.3ms | ActiveRecord: 0.4ms | Allocations: 323)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:03.238698"], ["updated_at", "2024-03-28 07:31:03.238698"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:03.240786"], ["updated_at", "2024-03-28 07:31:03.240786"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:03.241897"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:03.241897"], ["created_at", "2024-03-28 07:31:03.243947"], ["updated_at", "2024-03-28 07:31:03.243947"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 3ms (Views: 1.2ms | ActiveRecord: 0.2ms | Allocations: 553)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:03.255723"], ["updated_at", "2024-03-28 07:31:03.255723"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:03.257264"], ["updated_at", "2024-03-28 07:31:03.257264"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 15:31:03 +0800", "tour_id"=>"1"}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.3ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:03"], ["created_at", "2024-03-28 07:31:03.269073"], ["updated_at", "2024-03-28 07:31:03.269073"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 8ms (Views: 0.4ms | ActiveRecord: 1.0ms | Allocations: 1541)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (4.0ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:03.279359"], ["updated_at", "2024-03-28 07:31:03.279359"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:03.287007"], ["updated_at", "2024-03-28 07:31:03.287007"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 15:31:03 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.8ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:03"], ["created_at", "2024-03-28 07:31:03.291988"], ["updated_at", "2024-03-28 07:31:03.291988"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 8ms (Views: 0.5ms | ActiveRecord: 1.1ms | Allocations: 1249)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:31:03 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 12ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 2014)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:03.320088"], ["updated_at", "2024-03-28 07:31:03.320088"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:03.322807"], ["updated_at", "2024-03-28 07:31:03.322807"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:03.324437"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:03.324437"], ["created_at", "2024-03-28 07:31:03.328930"], ["updated_at", "2024-03-28 07:31:03.328930"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:31:03 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 07:31:03"], ["updated_at", "2024-03-28 07:31:03.334783"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.5ms | ActiveRecord: 0.6ms | Allocations: 1422)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:03.345326"], ["updated_at", "2024-03-28 07:31:03.345326"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:03.349207"], ["updated_at", "2024-03-28 07:31:03.349207"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:03.351043"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:03.351043"], ["created_at", "2024-03-28 07:31:03.353055"], ["updated_at", "2024-03-28 07:31:03.353055"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:31:03 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.0ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.1ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 07:31:03"], ["updated_at", "2024-03-28 07:31:03.357586"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.3ms | ActiveRecord: 0.3ms | Allocations: 1268)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (2.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:03.365068"], ["updated_at", "2024-03-28 07:31:03.365068"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.0ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:03.369970"], ["updated_at", "2024-03-28 07:31:03.369970"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:03.372875"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:03.372875"], ["created_at", "2024-03-28 07:31:03.374127"], ["updated_at", "2024-03-28 07:31:03.374127"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:31:03 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 5ms (Views: 0.2ms | ActiveRecord: 1.1ms | Allocations: 1040)
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:03.389427"], ["updated_at", "2024-03-28 07:31:03.389427"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:03.391277"], ["updated_at", "2024-03-28 07:31:03.391277"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:03.392191"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:03.392191"], ["created_at", "2024-03-28 07:31:03.393119"], ["updated_at", "2024-03-28 07:31:03.393119"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:03.405065"], ["updated_at", "2024-03-28 07:31:03.405065"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:03.407275"], ["updated_at", "2024-03-28 07:31:03.407275"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:03.408275"], ["LIMIT", 1]]
  [1m[35m (1.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.5ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:03.408275"], ["created_at", "2024-03-28 07:31:03.409592"], ["updated_at", "2024-03-28 07:31:03.409592"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.7ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 1.1ms | Allocations: 357)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.3ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 9ms (Views: 4.9ms | ActiveRecord: 0.3ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (2.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:03.441919"], ["updated_at", "2024-03-28 07:31:03.441919"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 7ms (Views: 5.5ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 4ms (Views: 2.5ms | ActiveRecord: 0.0ms | Allocations: 843)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 7ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 759)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", ""], ["rule_data", "{}"], ["created_at", "2024-03-28 07:31:03.544072"], ["updated_at", "2024-03-28 07:31:03.544072"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 13ms (Views: 0.2ms | ActiveRecord: 0.8ms | Allocations: 1364)
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (2.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:03.557949"], ["updated_at", "2024-03-28 07:31:03.557949"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:31:03.567267"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 1222)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (1.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:03.575523"], ["updated_at", "2024-03-28 07:31:03.575523"]]
  [1m[35m (1.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:31:03.583920"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.9ms | ActiveRecord: 0.5ms | Allocations: 1181)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:03.589931"], ["updated_at", "2024-03-28 07:31:03.589931"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", ""], ["rule_data", "{}"], ["updated_at", "2024-03-28 07:31:03.594006"], ["id", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.6ms | ActiveRecord: 0.8ms | Allocations: 1047)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:03.618825"], ["updated_at", "2024-03-28 07:31:03.618825"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (3.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:03.631027"], ["updated_at", "2024-03-28 07:31:03.631027"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.3ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 7ms (ActiveRecord: 0.7ms | Allocations: 356)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (4.9ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 6ms (Views: 1.0ms | ActiveRecord: 4.9ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:03.674101"], ["updated_at", "2024-03-28 07:31:03.674101"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 5ms (Views: 3.7ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (6.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:03.702622"], ["updated_at", "2024-03-28 07:31:03.702622"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 857)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:03.709931"], ["updated_at", "2024-03-28 07:31:03.709931"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 1.3ms | ActiveRecord: 1.3ms | Allocations: 855)
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:03.720212"], ["updated_at", "2024-03-28 07:31:03.720212"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 5ms (Views: 0.2ms | ActiveRecord: 1.1ms | Allocations: 890)
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:03.728601"], ["updated_at", "2024-03-28 07:31:03.728601"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:31:03.732491"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 842)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:03.739447"], ["updated_at", "2024-03-28 07:31:03.739447"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:31:03.743706"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 806)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:03.749988"], ["updated_at", "2024-03-28 07:31:03.749988"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.8ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 07:31:03.755489"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.3ms | ActiveRecord: 1.0ms | Allocations: 848)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:03.760807"], ["updated_at", "2024-03-28 07:31:03.760807"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 0.5ms | Allocations: 363)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:03.774715"], ["updated_at", "2024-03-28 07:31:03.774715"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.5ms | Allocations: 356)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:31:03 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 15:31:03 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:03.841391"], ["updated_at", "2024-03-28 07:31:03.841391"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:03.843724"], ["updated_at", "2024-03-28 07:31:03.843724"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:03"], ["created_at", "2024-03-28 07:31:03.849957"], ["updated_at", "2024-03-28 07:31:03.849957"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 19ms (Views: 0.7ms | ActiveRecord: 1.8ms | Allocations: 2924)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:31:03 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:31:03.871769"], ["updated_at", "2024-03-28 07:31:03.871769"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:31:03.873410"], ["updated_at", "2024-03-28 07:31:03.873410"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:31:03.875611"], ["updated_at", "2024-03-28 07:31:03.875611"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 7ms (Views: 0.2ms | ActiveRecord: 1.2ms | Allocations: 2167)
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:31:55 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:55.284733"], ["updated_at", "2024-03-28 07:31:55.284733"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:55.319026"], ["updated_at", "2024-03-28 07:31:55.319026"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:55"], ["created_at", "2024-03-28 07:31:55.339312"], ["updated_at", "2024-03-28 07:31:55.339312"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 67ms (Views: 0.9ms | ActiveRecord: 2.7ms | Allocations: 16860)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:31:55 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:55.350016"], ["updated_at", "2024-03-28 07:31:55.350016"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:55.352869"], ["updated_at", "2024-03-28 07:31:55.352869"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:55"], ["created_at", "2024-03-28 07:31:55.357155"], ["updated_at", "2024-03-28 07:31:55.357155"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 11ms (Views: 1.8ms | ActiveRecord: 2.0ms | Allocations: 2639)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 07:31:55.366210"], ["updated_at", "2024-03-28 07:31:55.366210"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 07:31:55.369484"], ["updated_at", "2024-03-28 07:31:55.369484"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:31:55.373795"], ["updated_at", "2024-03-28 07:31:55.373795"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 10ms (Views: 0.6ms | ActiveRecord: 1.7ms | Allocations: 2133)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 323)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:55.384881"], ["updated_at", "2024-03-28 07:31:55.384881"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:55.390720"], ["updated_at", "2024-03-28 07:31:55.390720"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:55.393466"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:55.393466"], ["created_at", "2024-03-28 07:31:55.395688"], ["updated_at", "2024-03-28 07:31:55.395688"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 3ms (Views: 0.6ms | ActiveRecord: 0.2ms | Allocations: 553)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:55.406951"], ["updated_at", "2024-03-28 07:31:55.406951"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:55.409983"], ["updated_at", "2024-03-28 07:31:55.409983"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 15:31:55 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.3ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:55"], ["created_at", "2024-03-28 07:31:55.420338"], ["updated_at", "2024-03-28 07:31:55.420338"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 11ms (Views: 0.7ms | ActiveRecord: 1.0ms | Allocations: 1541)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.9ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:55.430980"], ["updated_at", "2024-03-28 07:31:55.430980"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:55.434476"], ["updated_at", "2024-03-28 07:31:55.434476"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 15:31:55 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:55"], ["created_at", "2024-03-28 07:31:55.441868"], ["updated_at", "2024-03-28 07:31:55.441868"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 1249)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:31:55 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 11ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 2014)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:55.462549"], ["updated_at", "2024-03-28 07:31:55.462549"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:55.464447"], ["updated_at", "2024-03-28 07:31:55.464447"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:55.467206"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:55.467206"], ["created_at", "2024-03-28 07:31:55.468982"], ["updated_at", "2024-03-28 07:31:55.468982"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:31:55 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.3ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 07:31:55"], ["updated_at", "2024-03-28 07:31:55.476170"], ["id", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 0.9ms | Allocations: 1422)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (1.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:55.486524"], ["updated_at", "2024-03-28 07:31:55.486524"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:55.491191"], ["updated_at", "2024-03-28 07:31:55.491191"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:55.493063"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:55.493063"], ["created_at", "2024-03-28 07:31:55.494392"], ["updated_at", "2024-03-28 07:31:55.494392"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:31:55 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 07:31:55"], ["updated_at", "2024-03-28 07:31:55.501854"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.6ms | ActiveRecord: 0.8ms | Allocations: 1268)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:55.509417"], ["updated_at", "2024-03-28 07:31:55.509417"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:55.511389"], ["updated_at", "2024-03-28 07:31:55.511389"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:55.514020"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (1.0ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:55.514020"], ["created_at", "2024-03-28 07:31:55.515522"], ["updated_at", "2024-03-28 07:31:55.515522"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:31:55 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 8ms (Views: 0.2ms | ActiveRecord: 0.4ms | Allocations: 1040)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:55.534405"], ["updated_at", "2024-03-28 07:31:55.534405"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:55.539789"], ["updated_at", "2024-03-28 07:31:55.539789"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:55.541157"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:55.541157"], ["created_at", "2024-03-28 07:31:55.542573"], ["updated_at", "2024-03-28 07:31:55.542573"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.2ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:55.550673"], ["updated_at", "2024-03-28 07:31:55.550673"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:55.554968"], ["updated_at", "2024-03-28 07:31:55.554968"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:55.556353"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:55.556353"], ["created_at", "2024-03-28 07:31:55.558678"], ["updated_at", "2024-03-28 07:31:55.558678"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.2ms | Allocations: 357)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.4ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 6ms (Views: 1.3ms | ActiveRecord: 0.4ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:55.588642"], ["updated_at", "2024-03-28 07:31:55.588642"]]
  [1m[35m (2.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 7ms (Views: 1.0ms | ActiveRecord: 0.1ms | Allocations: 497)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 6ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 843)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 10ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 759)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (2.3ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", ""], ["rule_data", "{}"], ["created_at", "2024-03-28 07:31:55.681345"], ["updated_at", "2024-03-28 07:31:55.681345"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 11ms (Views: 1.1ms | ActiveRecord: 0.8ms | Allocations: 1364)
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:55.695362"], ["updated_at", "2024-03-28 07:31:55.695362"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (1.3ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:31:55.704969"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.5ms | ActiveRecord: 1.6ms | Allocations: 1220)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:55.714456"], ["updated_at", "2024-03-28 07:31:55.714456"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:31:55.722158"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 1181)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:55.727741"], ["updated_at", "2024-03-28 07:31:55.727741"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.3ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", ""], ["rule_data", "{}"], ["updated_at", "2024-03-28 07:31:55.734044"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.5ms | ActiveRecord: 0.7ms | Allocations: 1047)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.0ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:55.749751"], ["updated_at", "2024-03-28 07:31:55.749751"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 0.6ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:55.762735"], ["updated_at", "2024-03-28 07:31:55.762735"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.5ms | Allocations: 356)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:55.780606"], ["updated_at", "2024-03-28 07:31:55.780606"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.9ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:55.804132"], ["updated_at", "2024-03-28 07:31:55.804132"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 857)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.9ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:55.831794"], ["updated_at", "2024-03-28 07:31:55.831794"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 13ms (Views: 1.6ms | ActiveRecord: 1.1ms | Allocations: 855)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:55.845216"], ["updated_at", "2024-03-28 07:31:55.845216"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 4ms (Views: 0.2ms | ActiveRecord: 0.7ms | Allocations: 890)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:55.852185"], ["updated_at", "2024-03-28 07:31:55.852185"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:31:55.857963"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 1.3ms | ActiveRecord: 0.5ms | Allocations: 842)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (3.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:55.870660"], ["updated_at", "2024-03-28 07:31:55.870660"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:31:55.877107"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 1.2ms | ActiveRecord: 0.3ms | Allocations: 806)
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:55.887498"], ["updated_at", "2024-03-28 07:31:55.887498"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 07:31:55.899151"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.5ms | ActiveRecord: 0.5ms | Allocations: 848)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (2.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:55.905857"], ["updated_at", "2024-03-28 07:31:55.905857"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (10.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (4.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:55.944909"], ["updated_at", "2024-03-28 07:31:55.944909"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (2.8ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 14ms (ActiveRecord: 3.2ms | Allocations: 356)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:31:56 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 15:31:55 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.9ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:31:56.031005"], ["updated_at", "2024-03-28 07:31:56.031005"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:31:56.034458"], ["updated_at", "2024-03-28 07:31:56.034458"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:31:55"], ["created_at", "2024-03-28 07:31:56.038798"], ["updated_at", "2024-03-28 07:31:56.038798"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 18ms (Views: 0.6ms | ActiveRecord: 1.9ms | Allocations: 2924)
  [1m[35m (1.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:31:56 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:31:56.057591"], ["updated_at", "2024-03-28 07:31:56.057591"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:31:56.059970"], ["updated_at", "2024-03-28 07:31:56.059970"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:31:56.062414"], ["updated_at", "2024-03-28 07:31:56.062414"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 8ms (Views: 0.2ms | ActiveRecord: 1.5ms | Allocations: 2167)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:32:57 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:32:57.107093"], ["updated_at", "2024-03-28 07:32:57.107093"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:32:57.140558"], ["updated_at", "2024-03-28 07:32:57.140558"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:32:57"], ["created_at", "2024-03-28 07:32:57.159423"], ["updated_at", "2024-03-28 07:32:57.159423"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 64ms (Views: 0.7ms | ActiveRecord: 2.3ms | Allocations: 16860)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:32:57 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:32:57.170051"], ["updated_at", "2024-03-28 07:32:57.170051"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:32:57.172499"], ["updated_at", "2024-03-28 07:32:57.172499"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:32:57"], ["created_at", "2024-03-28 07:32:57.176863"], ["updated_at", "2024-03-28 07:32:57.176863"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 10ms (Views: 0.6ms | ActiveRecord: 1.9ms | Allocations: 2639)
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 07:32:57.186081"], ["updated_at", "2024-03-28 07:32:57.186081"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 07:32:57.187598"], ["updated_at", "2024-03-28 07:32:57.187598"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:32:57.190474"], ["updated_at", "2024-03-28 07:32:57.190474"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 7ms (Views: 0.2ms | ActiveRecord: 1.4ms | Allocations: 2133)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 1ms (Views: 0.6ms | ActiveRecord: 0.2ms | Allocations: 323)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:32:57.201953"], ["updated_at", "2024-03-28 07:32:57.201953"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:32:57.204635"], ["updated_at", "2024-03-28 07:32:57.204635"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.5ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:32:57.206977"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:32:57.206977"], ["created_at", "2024-03-28 07:32:57.209709"], ["updated_at", "2024-03-28 07:32:57.209709"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 553)
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:32:57.221029"], ["updated_at", "2024-03-28 07:32:57.221029"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:32:57.223293"], ["updated_at", "2024-03-28 07:32:57.223293"]]
  [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 15:32:57 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:32:57"], ["created_at", "2024-03-28 07:32:57.230972"], ["updated_at", "2024-03-28 07:32:57.230972"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 7ms (Views: 0.5ms | ActiveRecord: 0.7ms | Allocations: 1541)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:32:57.236704"], ["updated_at", "2024-03-28 07:32:57.236704"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:32:57.240216"], ["updated_at", "2024-03-28 07:32:57.240216"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 15:32:57 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.7ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:32:57"], ["created_at", "2024-03-28 07:32:57.246005"], ["updated_at", "2024-03-28 07:32:57.246005"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.4ms | ActiveRecord: 1.1ms | Allocations: 1249)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:32:57 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 10ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 2016)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.9ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:32:57.268088"], ["updated_at", "2024-03-28 07:32:57.268088"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:32:57.271588"], ["updated_at", "2024-03-28 07:32:57.271588"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:32:57.272923"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:32:57.272923"], ["created_at", "2024-03-28 07:32:57.275019"], ["updated_at", "2024-03-28 07:32:57.275019"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:32:57 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.3ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 07:32:57"], ["updated_at", "2024-03-28 07:32:57.280706"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 1.0ms | ActiveRecord: 0.7ms | Allocations: 1422)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:32:57.290343"], ["updated_at", "2024-03-28 07:32:57.290343"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:32:57.292442"], ["updated_at", "2024-03-28 07:32:57.292442"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:32:57.293456"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:32:57.293456"], ["created_at", "2024-03-28 07:32:57.295065"], ["updated_at", "2024-03-28 07:32:57.295065"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:32:57 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.3ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.1ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 07:32:57"], ["updated_at", "2024-03-28 07:32:57.303249"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 0.8ms | Allocations: 1268)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:32:57.308324"], ["updated_at", "2024-03-28 07:32:57.308324"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:32:57.310116"], ["updated_at", "2024-03-28 07:32:57.310116"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:32:57.311039"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.5ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:32:57.311039"], ["created_at", "2024-03-28 07:32:57.312231"], ["updated_at", "2024-03-28 07:32:57.312231"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:32:57 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 3ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 1040)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:32:57.325977"], ["updated_at", "2024-03-28 07:32:57.325977"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:32:57.327786"], ["updated_at", "2024-03-28 07:32:57.327786"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:32:57.329141"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:32:57.329141"], ["created_at", "2024-03-28 07:32:57.335538"], ["updated_at", "2024-03-28 07:32:57.335538"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:32:57.345151"], ["updated_at", "2024-03-28 07:32:57.345151"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:32:57.351074"], ["updated_at", "2024-03-28 07:32:57.351074"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:32:57.352531"], ["LIMIT", 1]]
  [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.6ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:32:57.352531"], ["created_at", "2024-03-28 07:32:57.353643"], ["updated_at", "2024-03-28 07:32:57.353643"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.2ms | Allocations: 357)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 7ms (Views: 5.6ms | ActiveRecord: 0.2ms | Allocations: 314)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:32:57.378256"], ["updated_at", "2024-03-28 07:32:57.378256"]]
  [1m[35m (5.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 4ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 9ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 843)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 7ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 759)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", ""], ["rule_data", "{}"], ["created_at", "2024-03-28 07:32:57.479124"], ["updated_at", "2024-03-28 07:32:57.479124"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 15ms (Views: 0.2ms | ActiveRecord: 0.7ms | Allocations: 1364)
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:32:57.491944"], ["updated_at", "2024-03-28 07:32:57.491944"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:32:57.503078"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.5ms | ActiveRecord: 0.3ms | Allocations: 1222)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:32:57.509481"], ["updated_at", "2024-03-28 07:32:57.509481"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:32:57.515362"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.6ms | ActiveRecord: 0.5ms | Allocations: 1181)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:32:57.522871"], ["updated_at", "2024-03-28 07:32:57.522871"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", ""], ["rule_data", "{}"], ["updated_at", "2024-03-28 07:32:57.528260"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.5ms | ActiveRecord: 0.4ms | Allocations: 1047)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:32:57.541647"], ["updated_at", "2024-03-28 07:32:57.541647"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:32:57.551830"], ["updated_at", "2024-03-28 07:32:57.551830"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.4ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 0.7ms | Allocations: 356)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 2ms (Views: 0.9ms | ActiveRecord: 0.2ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:32:57.569572"], ["updated_at", "2024-03-28 07:32:57.569572"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:32:57.585908"], ["updated_at", "2024-03-28 07:32:57.585908"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 857)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:32:57.597028"], ["updated_at", "2024-03-28 07:32:57.597028"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 855)
  [1m[35m (1.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:32:57.608582"], ["updated_at", "2024-03-28 07:32:57.608582"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 5ms (Views: 0.5ms | ActiveRecord: 0.6ms | Allocations: 890)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:32:57.616185"], ["updated_at", "2024-03-28 07:32:57.616185"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:32:57.622540"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 842)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:32:57.630673"], ["updated_at", "2024-03-28 07:32:57.630673"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (2.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:32:57.638924"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 1.3ms | ActiveRecord: 3.1ms | Allocations: 806)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:32:57.656079"], ["updated_at", "2024-03-28 07:32:57.656079"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 07:32:57.664061"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 10ms (Views: 1.3ms | ActiveRecord: 0.5ms | Allocations: 848)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:32:57.683712"], ["updated_at", "2024-03-28 07:32:57.683712"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.5ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:32:57.694984"], ["updated_at", "2024-03-28 07:32:57.694984"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 356)
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:32:57 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 15:32:57 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:32:57.748180"], ["updated_at", "2024-03-28 07:32:57.748180"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:32:57.751519"], ["updated_at", "2024-03-28 07:32:57.751519"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:32:57"], ["created_at", "2024-03-28 07:32:57.757876"], ["updated_at", "2024-03-28 07:32:57.757876"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 26ms (Views: 0.8ms | ActiveRecord: 2.0ms | Allocations: 2924)
  [1m[35m (29.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:32:57 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:32:57.835389"], ["updated_at", "2024-03-28 07:32:57.835389"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:32:57.843431"], ["updated_at", "2024-03-28 07:32:57.843431"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:32:57.847840"], ["updated_at", "2024-03-28 07:32:57.847840"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 28ms (Views: 0.2ms | ActiveRecord: 2.0ms | Allocations: 2167)
  [1m[35m (5.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:33:54 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:33:54.948269"], ["updated_at", "2024-03-28 07:33:54.948269"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:33:54.982972"], ["updated_at", "2024-03-28 07:33:54.982972"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:33:54"], ["created_at", "2024-03-28 07:33:55.004730"], ["updated_at", "2024-03-28 07:33:55.004730"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 68ms (Views: 0.8ms | ActiveRecord: 2.5ms | Allocations: 16860)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:33:55 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:33:55.017015"], ["updated_at", "2024-03-28 07:33:55.017015"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:33:55.019872"], ["updated_at", "2024-03-28 07:33:55.019872"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.8ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:33:55"], ["created_at", "2024-03-28 07:33:55.023731"], ["updated_at", "2024-03-28 07:33:55.023731"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 12ms (Views: 1.8ms | ActiveRecord: 2.2ms | Allocations: 2639)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 07:33:55.033090"], ["updated_at", "2024-03-28 07:33:55.033090"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 07:33:55.035187"], ["updated_at", "2024-03-28 07:33:55.035187"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:33:55.038782"], ["updated_at", "2024-03-28 07:33:55.038782"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 8ms (Views: 0.3ms | ActiveRecord: 1.4ms | Allocations: 2133)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 323)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:33:55.049795"], ["updated_at", "2024-03-28 07:33:55.049795"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:33:55.053173"], ["updated_at", "2024-03-28 07:33:55.053173"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:33:55.054798"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:33:55.054798"], ["created_at", "2024-03-28 07:33:55.056356"], ["updated_at", "2024-03-28 07:33:55.056356"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 3ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 553)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:33:55.069136"], ["updated_at", "2024-03-28 07:33:55.069136"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:33:55.073186"], ["updated_at", "2024-03-28 07:33:55.073186"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 15:33:55 +0800", "tour_id"=>"1"}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:33:55"], ["created_at", "2024-03-28 07:33:55.085920"], ["updated_at", "2024-03-28 07:33:55.085920"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 7ms (Views: 0.4ms | ActiveRecord: 0.9ms | Allocations: 1541)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:33:55.094284"], ["updated_at", "2024-03-28 07:33:55.094284"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:33:55.096840"], ["updated_at", "2024-03-28 07:33:55.096840"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 15:33:55 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:33:55"], ["created_at", "2024-03-28 07:33:55.105580"], ["updated_at", "2024-03-28 07:33:55.105580"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 1.1ms | ActiveRecord: 0.7ms | Allocations: 1249)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:33:55 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 7ms (Views: 0.6ms | ActiveRecord: 0.0ms | Allocations: 2014)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:33:55.122949"], ["updated_at", "2024-03-28 07:33:55.122949"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:33:55.125779"], ["updated_at", "2024-03-28 07:33:55.125779"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:33:55.127862"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:33:55.127862"], ["created_at", "2024-03-28 07:33:55.129948"], ["updated_at", "2024-03-28 07:33:55.129948"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:33:55 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 07:33:55"], ["updated_at", "2024-03-28 07:33:55.138272"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.6ms | ActiveRecord: 0.6ms | Allocations: 1422)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:33:55.146620"], ["updated_at", "2024-03-28 07:33:55.146620"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:33:55.149090"], ["updated_at", "2024-03-28 07:33:55.149090"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:33:55.151595"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:33:55.151595"], ["created_at", "2024-03-28 07:33:55.153667"], ["updated_at", "2024-03-28 07:33:55.153667"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:33:55 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.1ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 07:33:55"], ["updated_at", "2024-03-28 07:33:55.159191"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 1268)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:33:55.164077"], ["updated_at", "2024-03-28 07:33:55.164077"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:33:55.165976"], ["updated_at", "2024-03-28 07:33:55.165976"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:33:55.167599"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:33:55.167599"], ["created_at", "2024-03-28 07:33:55.169873"], ["updated_at", "2024-03-28 07:33:55.169873"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:33:55 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 4ms (Views: 0.2ms | ActiveRecord: 0.5ms | Allocations: 1040)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:33:55.182481"], ["updated_at", "2024-03-28 07:33:55.182481"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:33:55.184896"], ["updated_at", "2024-03-28 07:33:55.184896"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:33:55.186584"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:33:55.186584"], ["created_at", "2024-03-28 07:33:55.188302"], ["updated_at", "2024-03-28 07:33:55.188302"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.8ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:33:55.197923"], ["updated_at", "2024-03-28 07:33:55.197923"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:33:55.200302"], ["updated_at", "2024-03-28 07:33:55.200302"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.7ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:33:55.202305"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:33:55.202305"], ["created_at", "2024-03-28 07:33:55.204495"], ["updated_at", "2024-03-28 07:33:55.204495"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 357)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.5ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 5ms (Views: 3.8ms | ActiveRecord: 0.5ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:33:55.228431"], ["updated_at", "2024-03-28 07:33:55.228431"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 6ms (Views: 4.2ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 7ms (Views: 0.4ms | ActiveRecord: 0.0ms | Allocations: 843)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 9ms (Views: 0.6ms | ActiveRecord: 0.0ms | Allocations: 759)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (2.7ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", ""], ["rule_data", "{}"], ["created_at", "2024-03-28 07:33:55.320431"], ["updated_at", "2024-03-28 07:33:55.320431"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 16ms (Views: 2.4ms | ActiveRecord: 0.7ms | Allocations: 1364)
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:33:55.335260"], ["updated_at", "2024-03-28 07:33:55.335260"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:33:55.345654"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 1222)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:33:55.353196"], ["updated_at", "2024-03-28 07:33:55.353196"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:33:55.361436"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.3ms | ActiveRecord: 0.3ms | Allocations: 1181)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:33:55.366540"], ["updated_at", "2024-03-28 07:33:55.366540"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.3ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", ""], ["rule_data", "{}"], ["updated_at", "2024-03-28 07:33:55.373716"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.5ms | ActiveRecord: 0.7ms | Allocations: 1047)
  [1m[35m (1.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:33:55.388197"], ["updated_at", "2024-03-28 07:33:55.388197"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.6ms | Allocations: 363)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:33:55.399625"], ["updated_at", "2024-03-28 07:33:55.399625"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 0.5ms | Allocations: 356)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.3ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 5ms (Views: 1.1ms | ActiveRecord: 0.3ms | Allocations: 280)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:33:55.422090"], ["updated_at", "2024-03-28 07:33:55.422090"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 3ms (Views: 1.0ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:33:55.441333"], ["updated_at", "2024-03-28 07:33:55.441333"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 9ms (Views: 0.8ms | ActiveRecord: 1.1ms | Allocations: 857)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:33:55.453967"], ["updated_at", "2024-03-28 07:33:55.453967"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.7ms | ActiveRecord: 0.8ms | Allocations: 855)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (3.9ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:33:55.470856"], ["updated_at", "2024-03-28 07:33:55.470856"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 13ms (Views: 1.3ms | ActiveRecord: 4.3ms | Allocations: 890)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:33:55.493064"], ["updated_at", "2024-03-28 07:33:55.493064"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:33:55.543737"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 10ms (Views: 0.6ms | ActiveRecord: 0.5ms | Allocations: 842)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:33:55.560082"], ["updated_at", "2024-03-28 07:33:55.560082"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.5ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:33:55.577647"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 27ms (Views: 0.5ms | ActiveRecord: 0.8ms | Allocations: 806)
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:33:55.632374"], ["updated_at", "2024-03-28 07:33:55.632374"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 07:33:55.641817"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.5ms | ActiveRecord: 0.6ms | Allocations: 848)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:33:55.755820"], ["updated_at", "2024-03-28 07:33:55.755820"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.5ms | Allocations: 363)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (2.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:33:55.768848"], ["updated_at", "2024-03-28 07:33:55.768848"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.3ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.6ms | Allocations: 356)
  [1m[35m (2.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:33:55 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 15:33:55 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:33:55.872120"], ["updated_at", "2024-03-28 07:33:55.872120"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:33:55.881726"], ["updated_at", "2024-03-28 07:33:55.881726"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:33:55"], ["created_at", "2024-03-28 07:33:55.888097"], ["updated_at", "2024-03-28 07:33:55.888097"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 53ms (Views: 1.4ms | ActiveRecord: 2.4ms | Allocations: 2924)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:33:55 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:33:55.913121"], ["updated_at", "2024-03-28 07:33:55.913121"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:33:55.914912"], ["updated_at", "2024-03-28 07:33:55.914912"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:33:55.917652"], ["updated_at", "2024-03-28 07:33:55.917652"]]
  [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 8ms (Views: 0.2ms | ActiveRecord: 2.1ms | Allocations: 2167)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 6ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:35:20 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:20.254455"], ["updated_at", "2024-03-28 07:35:20.254455"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:20.290213"], ["updated_at", "2024-03-28 07:35:20.290213"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:20"], ["created_at", "2024-03-28 07:35:20.320286"], ["updated_at", "2024-03-28 07:35:20.320286"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 81ms (Views: 0.8ms | ActiveRecord: 3.3ms | Allocations: 16860)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:35:20 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.9ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:20.392084"], ["updated_at", "2024-03-28 07:35:20.392084"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:20.407491"], ["updated_at", "2024-03-28 07:35:20.407491"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:20"], ["created_at", "2024-03-28 07:35:20.412834"], ["updated_at", "2024-03-28 07:35:20.412834"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 29ms (Views: 3.1ms | ActiveRecord: 2.5ms | Allocations: 2639)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 07:35:20.425145"], ["updated_at", "2024-03-28 07:35:20.425145"]]
  [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 07:35:20.441160"], ["updated_at", "2024-03-28 07:35:20.441160"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:35:20.446313"], ["updated_at", "2024-03-28 07:35:20.446313"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 24ms (Views: 0.2ms | ActiveRecord: 2.3ms | Allocations: 2133)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 4ms (Views: 2.9ms | ActiveRecord: 0.3ms | Allocations: 323)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (12.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:20.463875"], ["updated_at", "2024-03-28 07:35:20.463875"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:20.480757"], ["updated_at", "2024-03-28 07:35:20.480757"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:20.482960"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:20.482960"], ["created_at", "2024-03-28 07:35:20.484438"], ["updated_at", "2024-03-28 07:35:20.484438"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 3ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 553)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:20.495289"], ["updated_at", "2024-03-28 07:35:20.495289"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:20.497677"], ["updated_at", "2024-03-28 07:35:20.497677"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 15:35:20 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:20"], ["created_at", "2024-03-28 07:35:20.508000"], ["updated_at", "2024-03-28 07:35:20.508000"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 7ms (Views: 0.4ms | ActiveRecord: 0.8ms | Allocations: 1541)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:20.515090"], ["updated_at", "2024-03-28 07:35:20.515090"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:20.517260"], ["updated_at", "2024-03-28 07:35:20.517260"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 15:35:20 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:20"], ["created_at", "2024-03-28 07:35:20.525370"], ["updated_at", "2024-03-28 07:35:20.525370"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 8ms (Views: 1.2ms | ActiveRecord: 0.7ms | Allocations: 1249)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:35:20 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 8ms (Views: 0.7ms | ActiveRecord: 0.0ms | Allocations: 2014)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:20.545855"], ["updated_at", "2024-03-28 07:35:20.545855"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:20.549742"], ["updated_at", "2024-03-28 07:35:20.549742"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:20.551996"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:20.551996"], ["created_at", "2024-03-28 07:35:20.554061"], ["updated_at", "2024-03-28 07:35:20.554061"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:35:20 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 07:35:20"], ["updated_at", "2024-03-28 07:35:20.561710"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 1422)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:20.569433"], ["updated_at", "2024-03-28 07:35:20.569433"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:20.572012"], ["updated_at", "2024-03-28 07:35:20.572012"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:20.573194"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:20.573194"], ["created_at", "2024-03-28 07:35:20.575603"], ["updated_at", "2024-03-28 07:35:20.575603"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:35:20 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.1ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 07:35:20"], ["updated_at", "2024-03-28 07:35:20.582823"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.3ms | ActiveRecord: 0.5ms | Allocations: 1268)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:20.587321"], ["updated_at", "2024-03-28 07:35:20.587321"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:20.590243"], ["updated_at", "2024-03-28 07:35:20.590243"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:20.593194"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:20.593194"], ["created_at", "2024-03-28 07:35:20.597664"], ["updated_at", "2024-03-28 07:35:20.597664"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:35:20 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 4ms (Views: 0.8ms | ActiveRecord: 0.3ms | Allocations: 1040)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.9ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:20.608346"], ["updated_at", "2024-03-28 07:35:20.608346"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:20.614506"], ["updated_at", "2024-03-28 07:35:20.614506"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:20.616462"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:20.616462"], ["created_at", "2024-03-28 07:35:20.618249"], ["updated_at", "2024-03-28 07:35:20.618249"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 426)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:20.630007"], ["updated_at", "2024-03-28 07:35:20.630007"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:20.632770"], ["updated_at", "2024-03-28 07:35:20.632770"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:20.634161"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.6ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:20.634161"], ["created_at", "2024-03-28 07:35:20.636450"], ["updated_at", "2024-03-28 07:35:20.636450"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 357)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.3ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 4ms (Views: 1.0ms | ActiveRecord: 0.3ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:20.666234"], ["updated_at", "2024-03-28 07:35:20.666234"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 6ms (Views: 1.2ms | ActiveRecord: 0.2ms | Allocations: 496)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 12ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 843)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 8ms (Views: 0.6ms | ActiveRecord: 0.0ms | Allocations: 759)
  [1m[35m (2.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (4.5ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", ""], ["rule_data", "{}"], ["created_at", "2024-03-28 07:35:20.810406"], ["updated_at", "2024-03-28 07:35:20.810406"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 16ms (Views: 1.9ms | ActiveRecord: 0.7ms | Allocations: 1364)
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:20.825921"], ["updated_at", "2024-03-28 07:35:20.825921"]]
  [1m[35m (2.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:35:20.834330"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 1222)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:20.843415"], ["updated_at", "2024-03-28 07:35:20.843415"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:35:20.849675"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 1.4ms | ActiveRecord: 0.5ms | Allocations: 1181)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (2.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:20.858675"], ["updated_at", "2024-03-28 07:35:20.858675"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", ""], ["rule_data", "{}"], ["updated_at", "2024-03-28 07:35:20.871158"], ["id", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.6ms | ActiveRecord: 0.7ms | Allocations: 1047)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (2.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:20.889891"], ["updated_at", "2024-03-28 07:35:20.889891"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:20.906694"], ["updated_at", "2024-03-28 07:35:20.906694"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 0.6ms | Allocations: 356)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 2ms (Views: 0.9ms | ActiveRecord: 0.2ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (4.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:20.940213"], ["updated_at", "2024-03-28 07:35:20.940213"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.7ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:20.960795"], ["updated_at", "2024-03-28 07:35:20.960795"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 8ms (Views: 1.6ms | ActiveRecord: 1.5ms | Allocations: 857)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (3.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:20.972944"], ["updated_at", "2024-03-28 07:35:20.972944"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 7ms (Views: 0.4ms | ActiveRecord: 3.9ms | Allocations: 855)
  [1m[35m (2.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.0ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:20.990281"], ["updated_at", "2024-03-28 07:35:20.990281"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 5ms (Views: 0.2ms | ActiveRecord: 1.2ms | Allocations: 890)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:21.000343"], ["updated_at", "2024-03-28 07:35:21.000343"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:35:21.007671"], ["id", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.8ms | ActiveRecord: 0.7ms | Allocations: 842)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (2.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:21.018872"], ["updated_at", "2024-03-28 07:35:21.018872"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.4ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:35:21.027922"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.4ms | ActiveRecord: 0.9ms | Allocations: 806)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:21.037355"], ["updated_at", "2024-03-28 07:35:21.037355"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 07:35:21.048258"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 848)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:21.055946"], ["updated_at", "2024-03-28 07:35:21.055946"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.3ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 0.7ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:21.069664"], ["updated_at", "2024-03-28 07:35:21.069664"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (1.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (2.9ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 6ms (ActiveRecord: 4.2ms | Allocations: 356)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:35:21 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 15:35:21 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.9ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:21.130035"], ["updated_at", "2024-03-28 07:35:21.130035"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:21.132954"], ["updated_at", "2024-03-28 07:35:21.132954"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:21"], ["created_at", "2024-03-28 07:35:21.135715"], ["updated_at", "2024-03-28 07:35:21.135715"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 19ms (Views: 0.6ms | ActiveRecord: 1.7ms | Allocations: 2924)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:35:21 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:35:21.152591"], ["updated_at", "2024-03-28 07:35:21.152591"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:35:21.154768"], ["updated_at", "2024-03-28 07:35:21.154768"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.5ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:35:21.158041"], ["updated_at", "2024-03-28 07:35:21.158041"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 9ms (Views: 0.2ms | ActiveRecord: 1.9ms | Allocations: 2167)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:35:40 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:40.984957"], ["updated_at", "2024-03-28 07:35:40.984957"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:41.025181"], ["updated_at", "2024-03-28 07:35:41.025181"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:40"], ["created_at", "2024-03-28 07:35:41.054226"], ["updated_at", "2024-03-28 07:35:41.054226"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 82ms (Views: 0.8ms | ActiveRecord: 2.6ms | Allocations: 16860)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:35:41 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:41.064770"], ["updated_at", "2024-03-28 07:35:41.064770"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:41.067635"], ["updated_at", "2024-03-28 07:35:41.067635"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.5ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:41"], ["created_at", "2024-03-28 07:35:41.072998"], ["updated_at", "2024-03-28 07:35:41.072998"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 14ms (Views: 2.6ms | ActiveRecord: 2.1ms | Allocations: 2639)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 07:35:41.083499"], ["updated_at", "2024-03-28 07:35:41.083499"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 07:35:41.085318"], ["updated_at", "2024-03-28 07:35:41.085318"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:35:41.089182"], ["updated_at", "2024-03-28 07:35:41.089182"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 8ms (Views: 0.2ms | ActiveRecord: 1.4ms | Allocations: 2133)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 3ms (Views: 1.0ms | ActiveRecord: 0.3ms | Allocations: 323)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:41.104474"], ["updated_at", "2024-03-28 07:35:41.104474"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:41.106673"], ["updated_at", "2024-03-28 07:35:41.106673"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:41.108029"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:41.108029"], ["created_at", "2024-03-28 07:35:41.110724"], ["updated_at", "2024-03-28 07:35:41.110724"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.6ms | ActiveRecord: 0.2ms | Allocations: 553)
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:41.121797"], ["updated_at", "2024-03-28 07:35:41.121797"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:41.124090"], ["updated_at", "2024-03-28 07:35:41.124090"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 15:35:41 +0800", "tour_id"=>"1"}}
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.3ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.5ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:41"], ["created_at", "2024-03-28 07:35:41.136383"], ["updated_at", "2024-03-28 07:35:41.136383"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 7ms (Views: 0.4ms | ActiveRecord: 1.3ms | Allocations: 1541)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:41.144414"], ["updated_at", "2024-03-28 07:35:41.144414"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:41.147080"], ["updated_at", "2024-03-28 07:35:41.147080"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 15:35:41 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:41"], ["created_at", "2024-03-28 07:35:41.154541"], ["updated_at", "2024-03-28 07:35:41.154541"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 11ms (Views: 1.3ms | ActiveRecord: 0.7ms | Allocations: 1249)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:35:41 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 12ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 2014)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:41.185161"], ["updated_at", "2024-03-28 07:35:41.185161"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:41.187031"], ["updated_at", "2024-03-28 07:35:41.187031"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:41.188468"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:41.188468"], ["created_at", "2024-03-28 07:35:41.194468"], ["updated_at", "2024-03-28 07:35:41.194468"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:35:41 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 07:35:41"], ["updated_at", "2024-03-28 07:35:41.203156"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 1422)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:41.211996"], ["updated_at", "2024-03-28 07:35:41.211996"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:41.215797"], ["updated_at", "2024-03-28 07:35:41.215797"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:41.217659"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:41.217659"], ["created_at", "2024-03-28 07:35:41.219087"], ["updated_at", "2024-03-28 07:35:41.219087"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:35:41 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.1ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 07:35:41"], ["updated_at", "2024-03-28 07:35:41.224548"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.9ms | ActiveRecord: 0.5ms | Allocations: 1268)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:41.233455"], ["updated_at", "2024-03-28 07:35:41.233455"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:41.235914"], ["updated_at", "2024-03-28 07:35:41.235914"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:41.238285"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:41.238285"], ["created_at", "2024-03-28 07:35:41.239688"], ["updated_at", "2024-03-28 07:35:41.239688"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:35:41 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 4ms (Views: 0.2ms | ActiveRecord: 0.8ms | Allocations: 1040)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:41.256122"], ["updated_at", "2024-03-28 07:35:41.256122"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:41.264242"], ["updated_at", "2024-03-28 07:35:41.264242"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:41.266130"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:41.266130"], ["created_at", "2024-03-28 07:35:41.267854"], ["updated_at", "2024-03-28 07:35:41.267854"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 426)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:41.282771"], ["updated_at", "2024-03-28 07:35:41.282771"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:41.286443"], ["updated_at", "2024-03-28 07:35:41.286443"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:41.288238"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.7ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:41.288238"], ["created_at", "2024-03-28 07:35:41.289670"], ["updated_at", "2024-03-28 07:35:41.289670"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 357)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.4ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 6ms (Views: 2.5ms | ActiveRecord: 0.4ms | Allocations: 314)
  [1m[35m (2.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:41.332281"], ["updated_at", "2024-03-28 07:35:41.332281"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 4ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 9ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 843)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 11ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 759)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (2.8ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", ""], ["rule_data", "{}"], ["created_at", "2024-03-28 07:35:41.446939"], ["updated_at", "2024-03-28 07:35:41.446939"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 14ms (Views: 0.3ms | ActiveRecord: 0.9ms | Allocations: 1364)
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:41.463187"], ["updated_at", "2024-03-28 07:35:41.463187"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:35:41.470445"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.3ms | ActiveRecord: 0.3ms | Allocations: 1222)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:41.479404"], ["updated_at", "2024-03-28 07:35:41.479404"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:35:41.487190"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.9ms | ActiveRecord: 0.4ms | Allocations: 1181)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:41.494416"], ["updated_at", "2024-03-28 07:35:41.494416"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", ""], ["rule_data", "{}"], ["updated_at", "2024-03-28 07:35:41.509602"], ["id", 1]]
  [1m[35m (1.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 13ms (Views: 0.7ms | ActiveRecord: 1.9ms | Allocations: 1047)
  [1m[35m (2.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (3.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:41.537182"], ["updated_at", "2024-03-28 07:35:41.537182"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.5ms | Allocations: 363)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:41.559441"], ["updated_at", "2024-03-28 07:35:41.559441"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 0.5ms | Allocations: 356)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 3ms (Views: 1.7ms | ActiveRecord: 0.2ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:41.586155"], ["updated_at", "2024-03-28 07:35:41.586155"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:41.600886"], ["updated_at", "2024-03-28 07:35:41.600886"]]
  [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.4ms | ActiveRecord: 1.4ms | Allocations: 857)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:41.609631"], ["updated_at", "2024-03-28 07:35:41.609631"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 1.3ms | ActiveRecord: 0.6ms | Allocations: 855)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:41.618942"], ["updated_at", "2024-03-28 07:35:41.618942"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 3ms (Views: 0.2ms | ActiveRecord: 0.7ms | Allocations: 890)
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:41.628655"], ["updated_at", "2024-03-28 07:35:41.628655"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:35:41.646290"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 842)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.9ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:41.651603"], ["updated_at", "2024-03-28 07:35:41.651603"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:35:41.655430"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 2ms (Views: 0.4ms | ActiveRecord: 0.2ms | Allocations: 806)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:41.670096"], ["updated_at", "2024-03-28 07:35:41.670096"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.3ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 07:35:41.674710"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.6ms | ActiveRecord: 0.6ms | Allocations: 848)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:41.686893"], ["updated_at", "2024-03-28 07:35:41.686893"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (3.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.5ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (2.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:41.706975"], ["updated_at", "2024-03-28 07:35:41.706975"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 356)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:35:41 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 15:35:41 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:35:41.778437"], ["updated_at", "2024-03-28 07:35:41.778437"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:35:41.781637"], ["updated_at", "2024-03-28 07:35:41.781637"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:35:41"], ["created_at", "2024-03-28 07:35:41.784953"], ["updated_at", "2024-03-28 07:35:41.784953"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 19ms (Views: 0.6ms | ActiveRecord: 1.8ms | Allocations: 2924)
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:35:41 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:35:41.803470"], ["updated_at", "2024-03-28 07:35:41.803470"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:35:41.805145"], ["updated_at", "2024-03-28 07:35:41.805145"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.7ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:35:41.807952"], ["updated_at", "2024-03-28 07:35:41.807952"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 8ms (Views: 0.1ms | ActiveRecord: 1.9ms | Allocations: 2167)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:38:20 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:38:20.474031"], ["updated_at", "2024-03-28 07:38:20.474031"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:38:20.507437"], ["updated_at", "2024-03-28 07:38:20.507437"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:38:20"], ["created_at", "2024-03-28 07:38:20.529181"], ["updated_at", "2024-03-28 07:38:20.529181"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 67ms (Views: 0.7ms | ActiveRecord: 2.3ms | Allocations: 16859)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:38:20 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:38:20.539427"], ["updated_at", "2024-03-28 07:38:20.539427"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:38:20.543231"], ["updated_at", "2024-03-28 07:38:20.543231"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:38:20"], ["created_at", "2024-03-28 07:38:20.548237"], ["updated_at", "2024-03-28 07:38:20.548237"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 13ms (Views: 2.2ms | ActiveRecord: 1.5ms | Allocations: 2639)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 07:38:20.557454"], ["updated_at", "2024-03-28 07:38:20.557454"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 07:38:20.559758"], ["updated_at", "2024-03-28 07:38:20.559758"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:38:20.563020"], ["updated_at", "2024-03-28 07:38:20.563020"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 8ms (Views: 0.2ms | ActiveRecord: 1.3ms | Allocations: 2133)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 323)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:38:20.574474"], ["updated_at", "2024-03-28 07:38:20.574474"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:38:20.576567"], ["updated_at", "2024-03-28 07:38:20.576567"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:38:20.578859"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:38:20.578859"], ["created_at", "2024-03-28 07:38:20.581019"], ["updated_at", "2024-03-28 07:38:20.581019"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 4ms (Views: 0.8ms | ActiveRecord: 0.2ms | Allocations: 553)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:38:20.591744"], ["updated_at", "2024-03-28 07:38:20.591744"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:38:20.593322"], ["updated_at", "2024-03-28 07:38:20.593322"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 15:38:20 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.6ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:38:20"], ["created_at", "2024-03-28 07:38:20.600359"], ["updated_at", "2024-03-28 07:38:20.600359"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 7ms (Views: 0.5ms | ActiveRecord: 1.1ms | Allocations: 1541)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:38:20.609272"], ["updated_at", "2024-03-28 07:38:20.609272"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:38:20.612643"], ["updated_at", "2024-03-28 07:38:20.612643"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 15:38:20 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:38:20"], ["created_at", "2024-03-28 07:38:20.622271"], ["updated_at", "2024-03-28 07:38:20.622271"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 9ms (Views: 1.2ms | ActiveRecord: 0.7ms | Allocations: 1249)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:38:20 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 8ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 2014)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:38:20.642222"], ["updated_at", "2024-03-28 07:38:20.642222"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:38:20.644139"], ["updated_at", "2024-03-28 07:38:20.644139"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:38:20.645133"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:38:20.645133"], ["created_at", "2024-03-28 07:38:20.648116"], ["updated_at", "2024-03-28 07:38:20.648116"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:38:20 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 07:38:20"], ["updated_at", "2024-03-28 07:38:20.656834"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 1482)
  [1m[36mAvailability Load (0.5ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:38:20.664893"], ["updated_at", "2024-03-28 07:38:20.664893"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.0ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:38:20.666772"], ["updated_at", "2024-03-28 07:38:20.666772"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:38:20.670516"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:38:20.670516"], ["created_at", "2024-03-28 07:38:20.672451"], ["updated_at", "2024-03-28 07:38:20.672451"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:38:20 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.0ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.1ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 07:38:20"], ["updated_at", "2024-03-28 07:38:20.678609"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.6ms | ActiveRecord: 0.4ms | Allocations: 1328)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:38:20.684421"], ["updated_at", "2024-03-28 07:38:20.684421"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:38:20.690669"], ["updated_at", "2024-03-28 07:38:20.690669"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:38:20.692875"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:38:20.692875"], ["created_at", "2024-03-28 07:38:20.694875"], ["updated_at", "2024-03-28 07:38:20.694875"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:38:20 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.8ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 5ms (Views: 0.2ms | ActiveRecord: 1.2ms | Allocations: 1108)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:38:20.706862"], ["updated_at", "2024-03-28 07:38:20.706862"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:38:20.709358"], ["updated_at", "2024-03-28 07:38:20.709358"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:38:20.710517"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:38:20.710517"], ["created_at", "2024-03-28 07:38:20.712825"], ["updated_at", "2024-03-28 07:38:20.712825"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:38:20.722424"], ["updated_at", "2024-03-28 07:38:20.722424"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:38:20.724020"], ["updated_at", "2024-03-28 07:38:20.724020"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:38:20.724922"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:38:20.724922"], ["created_at", "2024-03-28 07:38:20.726128"], ["updated_at", "2024-03-28 07:38:20.726128"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 357)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (2.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 6ms (Views: 3.2ms | ActiveRecord: 2.2ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:38:20.754848"], ["updated_at", "2024-03-28 07:38:20.754848"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 4ms (Views: 2.2ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 8ms (Views: 2.5ms | ActiveRecord: 0.0ms | Allocations: 843)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 7ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 759)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", ""], ["rule_data", "{}"], ["created_at", "2024-03-28 07:38:20.850417"], ["updated_at", "2024-03-28 07:38:20.850417"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 14ms (Views: 1.3ms | ActiveRecord: 1.2ms | Allocations: 1366)
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.9ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:38:20.862942"], ["updated_at", "2024-03-28 07:38:20.862942"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:38:20.871577"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 1656)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:38:20.877390"], ["updated_at", "2024-03-28 07:38:20.877390"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:38:20.884042"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 1617)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:38:20.891004"], ["updated_at", "2024-03-28 07:38:20.891004"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", ""], ["rule_data", "{}"], ["updated_at", "2024-03-28 07:38:20.896237"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 4ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 1466)
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:38:20.901171"], ["updated_at", "2024-03-28 07:38:20.901171"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.7ms | Allocations: 363)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:38:20.913955"], ["updated_at", "2024-03-28 07:38:20.913955"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.5ms | Allocations: 356)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:38:20.928469"], ["updated_at", "2024-03-28 07:38:20.928469"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 3ms (Views: 1.5ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:38:20.941505"], ["updated_at", "2024-03-28 07:38:20.941505"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 1.1ms | ActiveRecord: 0.6ms | Allocations: 857)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:38:20.949930"], ["updated_at", "2024-03-28 07:38:20.949930"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.6ms | ActiveRecord: 1.8ms | Allocations: 855)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:38:20.960950"], ["updated_at", "2024-03-28 07:38:20.960950"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 4ms (Views: 0.2ms | ActiveRecord: 0.9ms | Allocations: 890)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:38:20.967821"], ["updated_at", "2024-03-28 07:38:20.967821"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:38:20.976600"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 912)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:38:20.986750"], ["updated_at", "2024-03-28 07:38:20.986750"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:38:20.993772"], ["id", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 1.1ms | ActiveRecord: 0.5ms | Allocations: 876)
  [1m[35m (2.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:38:21.008447"], ["updated_at", "2024-03-28 07:38:21.008447"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.3ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 07:38:21.015036"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 6ms (Views: 0.8ms | ActiveRecord: 1.4ms | Allocations: 973)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:38:21.023323"], ["updated_at", "2024-03-28 07:38:21.023323"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (1.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:38:21.037959"], ["updated_at", "2024-03-28 07:38:21.037959"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.7ms | Allocations: 356)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:38:21 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 15:38:21 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:38:21.106931"], ["updated_at", "2024-03-28 07:38:21.106931"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:38:21.110042"], ["updated_at", "2024-03-28 07:38:21.110042"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:38:21"], ["created_at", "2024-03-28 07:38:21.116097"], ["updated_at", "2024-03-28 07:38:21.116097"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 26ms (Views: 0.8ms | ActiveRecord: 1.8ms | Allocations: 2924)
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:38:21 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:38:21.138415"], ["updated_at", "2024-03-28 07:38:21.138415"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:38:21.140367"], ["updated_at", "2024-03-28 07:38:21.140367"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:38:21.143840"], ["updated_at", "2024-03-28 07:38:21.143840"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 8ms (Views: 0.3ms | ActiveRecord: 1.5ms | Allocations: 2167)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:40:55 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:40:55.493066"], ["updated_at", "2024-03-28 07:40:55.493066"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:40:55.529011"], ["updated_at", "2024-03-28 07:40:55.529011"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:40:55"], ["created_at", "2024-03-28 07:40:55.551883"], ["updated_at", "2024-03-28 07:40:55.551883"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 71ms (Views: 0.8ms | ActiveRecord: 2.6ms | Allocations: 16861)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:40:55 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:40:55.563401"], ["updated_at", "2024-03-28 07:40:55.563401"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:40:55.566239"], ["updated_at", "2024-03-28 07:40:55.566239"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:40:55"], ["created_at", "2024-03-28 07:40:55.571220"], ["updated_at", "2024-03-28 07:40:55.571220"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 12ms (Views: 0.7ms | ActiveRecord: 1.7ms | Allocations: 2639)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 07:40:55.580804"], ["updated_at", "2024-03-28 07:40:55.580804"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 07:40:55.583871"], ["updated_at", "2024-03-28 07:40:55.583871"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:40:55.590425"], ["updated_at", "2024-03-28 07:40:55.590425"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 12ms (Views: 0.2ms | ActiveRecord: 1.9ms | Allocations: 2133)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 1ms (Views: 0.7ms | ActiveRecord: 0.2ms | Allocations: 323)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:40:55.602129"], ["updated_at", "2024-03-28 07:40:55.602129"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:40:55.604390"], ["updated_at", "2024-03-28 07:40:55.604390"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:40:55.607041"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:40:55.607041"], ["created_at", "2024-03-28 07:40:55.610250"], ["updated_at", "2024-03-28 07:40:55.610250"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 3ms (Views: 1.7ms | ActiveRecord: 0.2ms | Allocations: 553)
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:40:55.623334"], ["updated_at", "2024-03-28 07:40:55.623334"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:40:55.625600"], ["updated_at", "2024-03-28 07:40:55.625600"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 15:40:55 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.3ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.3ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.7ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:40:55"], ["created_at", "2024-03-28 07:40:55.637323"], ["updated_at", "2024-03-28 07:40:55.637323"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 9ms (Views: 0.4ms | ActiveRecord: 1.5ms | Allocations: 1541)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:40:55.645865"], ["updated_at", "2024-03-28 07:40:55.645865"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:40:55.650568"], ["updated_at", "2024-03-28 07:40:55.650568"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 15:40:55 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:40:55"], ["created_at", "2024-03-28 07:40:55.658912"], ["updated_at", "2024-03-28 07:40:55.658912"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.3ms | ActiveRecord: 0.5ms | Allocations: 1249)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:40:55 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 8ms (Views: 0.5ms | ActiveRecord: 0.0ms | Allocations: 2014)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:40:55.678674"], ["updated_at", "2024-03-28 07:40:55.678674"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:40:55.680600"], ["updated_at", "2024-03-28 07:40:55.680600"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:40:55.682240"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.5ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:40:55.682240"], ["created_at", "2024-03-28 07:40:55.684960"], ["updated_at", "2024-03-28 07:40:55.684960"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:40:55 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.3ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 07:40:55"], ["updated_at", "2024-03-28 07:40:55.691682"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.5ms | ActiveRecord: 0.7ms | Allocations: 1482)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.4ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:40:55.701488"], ["updated_at", "2024-03-28 07:40:55.701488"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:40:55.704181"], ["updated_at", "2024-03-28 07:40:55.704181"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:40:55.705564"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:40:55.705564"], ["created_at", "2024-03-28 07:40:55.707396"], ["updated_at", "2024-03-28 07:40:55.707396"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:40:55 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 07:40:55"], ["updated_at", "2024-03-28 07:40:55.714805"], ["id", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.6ms | ActiveRecord: 0.7ms | Allocations: 1328)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:40:55.721544"], ["updated_at", "2024-03-28 07:40:55.721544"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:40:55.724316"], ["updated_at", "2024-03-28 07:40:55.724316"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:40:55.728057"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:40:55.728057"], ["created_at", "2024-03-28 07:40:55.729999"], ["updated_at", "2024-03-28 07:40:55.729999"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:40:55 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 5ms (Views: 0.2ms | ActiveRecord: 0.6ms | Allocations: 1108)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:40:55.744086"], ["updated_at", "2024-03-28 07:40:55.744086"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:40:55.746168"], ["updated_at", "2024-03-28 07:40:55.746168"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:40:55.748805"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (1.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:40:55.748805"], ["created_at", "2024-03-28 07:40:55.752623"], ["updated_at", "2024-03-28 07:40:55.752623"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.4ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (1.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.0ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:40:55.766292"], ["updated_at", "2024-03-28 07:40:55.766292"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:40:55.771913"], ["updated_at", "2024-03-28 07:40:55.771913"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:40:55.773174"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:40:55.773174"], ["created_at", "2024-03-28 07:40:55.774323"], ["updated_at", "2024-03-28 07:40:55.774323"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.2ms | Allocations: 357)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.3ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 1ms (Views: 0.7ms | ActiveRecord: 0.3ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:40:55.796718"], ["updated_at", "2024-03-28 07:40:55.796718"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 8ms (Views: 2.9ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 8ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 843)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 500 Internal Server Error in 10ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 759)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (2.5ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", ""], ["rule_data", "{}"], ["created_at", "2024-03-28 07:40:55.894245"], ["updated_at", "2024-03-28 07:40:55.894245"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 17ms (Views: 4.0ms | ActiveRecord: 0.6ms | Allocations: 1364)
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (1.4ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (3.0ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:40:55.908153"], ["updated_at", "2024-03-28 07:40:55.908153"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:40:55.919928"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 12ms (Views: 6.8ms | ActiveRecord: 0.5ms | Allocations: 1656)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:40:55.933996"], ["updated_at", "2024-03-28 07:40:55.933996"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 07:40:55.944033"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 1617)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:40:55.951304"], ["updated_at", "2024-03-28 07:40:55.951304"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", ""], ["rule_data", "{}"], ["updated_at", "2024-03-28 07:40:55.969178"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 14ms (Views: 1.7ms | ActiveRecord: 0.6ms | Allocations: 1466)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:40:55.974943"], ["updated_at", "2024-03-28 07:40:55.974943"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 0.5ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:40:55.989376"], ["updated_at", "2024-03-28 07:40:55.989376"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 356)
  [1m[35m (1.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 3ms (Views: 0.6ms | ActiveRecord: 0.2ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:40:56.006278"], ["updated_at", "2024-03-28 07:40:56.006278"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:40:56.017557"], ["updated_at", "2024-03-28 07:40:56.017557"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 9ms (Views: 1.1ms | ActiveRecord: 1.6ms | Allocations: 857)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:40:56.034833"], ["updated_at", "2024-03-28 07:40:56.034833"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 8ms (Views: 0.5ms | ActiveRecord: 0.8ms | Allocations: 855)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", ""], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:40:56.055771"], ["updated_at", "2024-03-28 07:40:56.055771"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 15ms (Views: 0.3ms | ActiveRecord: 1.0ms | Allocations: 890)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:40:56.071475"], ["updated_at", "2024-03-28 07:40:56.071475"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:40:56.076847"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.3ms | ActiveRecord: 0.3ms | Allocations: 912)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:40:56.093045"], ["updated_at", "2024-03-28 07:40:56.093045"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.5ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 07:40:56.099514"], ["id", 1]]
  [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 10ms (Views: 0.4ms | ActiveRecord: 1.4ms | Allocations: 876)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:40:56.110730"], ["updated_at", "2024-03-28 07:40:56.110730"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.3ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", ""], ["updated_at", "2024-03-28 07:40:56.119706"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 7ms (Views: 0.3ms | ActiveRecord: 0.7ms | Allocations: 973)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:40:56.125950"], ["updated_at", "2024-03-28 07:40:56.125950"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 5ms (ActiveRecord: 0.5ms | Allocations: 363)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:40:56.139592"], ["updated_at", "2024-03-28 07:40:56.139592"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 356)
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:40:56 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 15:40:56 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:40:56.212653"], ["updated_at", "2024-03-28 07:40:56.212653"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:40:56.215079"], ["updated_at", "2024-03-28 07:40:56.215079"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:40:56"], ["created_at", "2024-03-28 07:40:56.223578"], ["updated_at", "2024-03-28 07:40:56.223578"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 27ms (Views: 0.7ms | ActiveRecord: 1.7ms | Allocations: 2924)
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:40:56 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:40:56.247468"], ["updated_at", "2024-03-28 07:40:56.247468"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:40:56.253255"], ["updated_at", "2024-03-28 07:40:56.253255"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:40:56.256338"], ["updated_at", "2024-03-28 07:40:56.256338"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 11ms (Views: 0.2ms | ActiveRecord: 1.6ms | Allocations: 2167)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:46:28 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:46:28.479174"], ["updated_at", "2024-03-28 07:46:28.479174"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:46:28.493961"], ["updated_at", "2024-03-28 07:46:28.493961"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:46:28"], ["created_at", "2024-03-28 07:46:28.516164"], ["updated_at", "2024-03-28 07:46:28.516164"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 48ms (Views: 0.8ms | ActiveRecord: 2.6ms | Allocations: 16837)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:46:28 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:46:28.549999"], ["updated_at", "2024-03-28 07:46:28.549999"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:46:28.551862"], ["updated_at", "2024-03-28 07:46:28.551862"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:46:28"], ["created_at", "2024-03-28 07:46:28.554409"], ["updated_at", "2024-03-28 07:46:28.554409"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 9ms (Views: 0.9ms | ActiveRecord: 1.3ms | Allocations: 2640)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 07:46:28.563878"], ["updated_at", "2024-03-28 07:46:28.563878"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 07:46:28.565535"], ["updated_at", "2024-03-28 07:46:28.565535"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.6ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:46:28.569532"], ["updated_at", "2024-03-28 07:46:28.569532"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 9ms (Views: 0.2ms | ActiveRecord: 1.6ms | Allocations: 2133)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:46:28 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 15:46:28 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:46:28.630334"], ["updated_at", "2024-03-28 07:46:28.630334"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:46:28.632646"], ["updated_at", "2024-03-28 07:46:28.632646"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:46:28"], ["created_at", "2024-03-28 07:46:28.636304"], ["updated_at", "2024-03-28 07:46:28.636304"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 19ms (Views: 0.7ms | ActiveRecord: 1.5ms | Allocations: 2925)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:46:28 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:46:28.652644"], ["updated_at", "2024-03-28 07:46:28.652644"]]
  [1m[35m (1.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:46:28.656262"], ["updated_at", "2024-03-28 07:46:28.656262"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:46:28.659974"], ["updated_at", "2024-03-28 07:46:28.659974"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 10ms (Views: 0.2ms | ActiveRecord: 2.7ms | Allocations: 2170)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:55:04 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:55:04.911841"], ["updated_at", "2024-03-28 07:55:04.911841"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:55:04.923891"], ["updated_at", "2024-03-28 07:55:04.923891"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:55:04"], ["created_at", "2024-03-28 07:55:04.945314"], ["updated_at", "2024-03-28 07:55:04.945314"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 45ms (Views: 0.7ms | ActiveRecord: 3.6ms | Allocations: 16837)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (1.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:55:04 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.0ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:55:04.978611"], ["updated_at", "2024-03-28 07:55:04.978611"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:55:04.981379"], ["updated_at", "2024-03-28 07:55:04.981379"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:55:04"], ["created_at", "2024-03-28 07:55:04.985672"], ["updated_at", "2024-03-28 07:55:04.985672"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 11ms (Views: 0.7ms | ActiveRecord: 1.9ms | Allocations: 2640)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 07:55:04.995971"], ["updated_at", "2024-03-28 07:55:04.995971"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 07:55:04.998499"], ["updated_at", "2024-03-28 07:55:04.998499"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:55:05.001904"], ["updated_at", "2024-03-28 07:55:05.001904"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 8ms (Views: 0.2ms | ActiveRecord: 1.6ms | Allocations: 2133)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:55:05 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 15:55:05 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:55:05.070918"], ["updated_at", "2024-03-28 07:55:05.070918"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:55:05.073839"], ["updated_at", "2024-03-28 07:55:05.073839"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:55:05"], ["created_at", "2024-03-28 07:55:05.076316"], ["updated_at", "2024-03-28 07:55:05.076316"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 16ms (Views: 0.6ms | ActiveRecord: 1.4ms | Allocations: 2926)
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:55:05 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:55:05.095004"], ["updated_at", "2024-03-28 07:55:05.095004"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:55:05.096734"], ["updated_at", "2024-03-28 07:55:05.096734"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:55:05.099916"], ["updated_at", "2024-03-28 07:55:05.099916"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 8ms (Views: 0.2ms | ActiveRecord: 1.4ms | Allocations: 2170)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 8ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:56:11 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.9ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:56:11.331083"], ["updated_at", "2024-03-28 07:56:11.331083"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:56:11.346616"], ["updated_at", "2024-03-28 07:56:11.346616"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:56:11"], ["created_at", "2024-03-28 07:56:11.366412"], ["updated_at", "2024-03-28 07:56:11.366412"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 48ms (Views: 1.1ms | ActiveRecord: 2.6ms | Allocations: 16837)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 15:56:11 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:56:11.399527"], ["updated_at", "2024-03-28 07:56:11.399527"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:56:11.401372"], ["updated_at", "2024-03-28 07:56:11.401372"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:56:11"], ["created_at", "2024-03-28 07:56:11.405142"], ["updated_at", "2024-03-28 07:56:11.405142"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 11ms (Views: 1.3ms | ActiveRecord: 1.6ms | Allocations: 2640)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 07:56:11.414634"], ["updated_at", "2024-03-28 07:56:11.414634"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 07:56:11.416207"], ["updated_at", "2024-03-28 07:56:11.416207"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.5ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:56:11.420985"], ["updated_at", "2024-03-28 07:56:11.420985"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 9ms (Views: 0.2ms | ActiveRecord: 1.8ms | Allocations: 2133)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:56:11 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 15:56:11 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 07:56:11.480292"], ["updated_at", "2024-03-28 07:56:11.480292"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 07:56:11.482370"], ["updated_at", "2024-03-28 07:56:11.482370"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 07:56:11"], ["created_at", "2024-03-28 07:56:11.485448"], ["updated_at", "2024-03-28 07:56:11.485448"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 18ms (Views: 1.2ms | ActiveRecord: 1.4ms | Allocations: 2926)
  [1m[35m (1.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 15:56:11 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:56:11.503720"], ["updated_at", "2024-03-28 07:56:11.503720"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 07:56:11.505880"], ["updated_at", "2024-03-28 07:56:11.505880"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 07:56:11.511012"], ["updated_at", "2024-03-28 07:56:11.511012"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 10ms (Views: 0.2ms | ActiveRecord: 1.5ms | Allocations: 2170)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:00:33 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.9ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:00:33.730896"], ["updated_at", "2024-03-28 08:00:33.730896"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:00:33.744184"], ["updated_at", "2024-03-28 08:00:33.744184"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:00:33"], ["created_at", "2024-03-28 08:00:33.764769"], ["updated_at", "2024-03-28 08:00:33.764769"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 47ms (Views: 0.9ms | ActiveRecord: 3.2ms | Allocations: 16837)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:00:33 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:00:33.798639"], ["updated_at", "2024-03-28 08:00:33.798639"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:00:33.801363"], ["updated_at", "2024-03-28 08:00:33.801363"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:00:33"], ["created_at", "2024-03-28 08:00:33.805434"], ["updated_at", "2024-03-28 08:00:33.805434"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 11ms (Views: 0.6ms | ActiveRecord: 1.9ms | Allocations: 2640)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 08:00:33.813891"], ["updated_at", "2024-03-28 08:00:33.813891"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 08:00:33.815542"], ["updated_at", "2024-03-28 08:00:33.815542"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 08:00:33.819478"], ["updated_at", "2024-03-28 08:00:33.819478"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 9ms (Views: 0.2ms | ActiveRecord: 1.3ms | Allocations: 2133)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:00:33 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 16:00:33 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:00:33.866025"], ["updated_at", "2024-03-28 08:00:33.866025"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:00:33.868799"], ["updated_at", "2024-03-28 08:00:33.868799"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:00:33"], ["created_at", "2024-03-28 08:00:33.872937"], ["updated_at", "2024-03-28 08:00:33.872937"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 17ms (Views: 0.6ms | ActiveRecord: 1.6ms | Allocations: 2925)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:00:33 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 08:00:33.888225"], ["updated_at", "2024-03-28 08:00:33.888225"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 08:00:33.890814"], ["updated_at", "2024-03-28 08:00:33.890814"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 08:00:33.895304"], ["updated_at", "2024-03-28 08:00:33.895304"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 9ms (Views: 0.2ms | ActiveRecord: 1.8ms | Allocations: 2170)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:17:12 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:17:12.182233"], ["updated_at", "2024-03-28 08:17:12.182233"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:17:12.195263"], ["updated_at", "2024-03-28 08:17:12.195263"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:17:12"], ["created_at", "2024-03-28 08:17:12.216886"], ["updated_at", "2024-03-28 08:17:12.216886"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 45ms (Views: 0.7ms | ActiveRecord: 2.5ms | Allocations: 16837)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:17:12 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:17:12.246184"], ["updated_at", "2024-03-28 08:17:12.246184"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:17:12.248568"], ["updated_at", "2024-03-28 08:17:12.248568"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:17:12"], ["created_at", "2024-03-28 08:17:12.251834"], ["updated_at", "2024-03-28 08:17:12.251834"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 9ms (Views: 0.7ms | ActiveRecord: 2.0ms | Allocations: 2640)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 08:17:12.259589"], ["updated_at", "2024-03-28 08:17:12.259589"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 08:17:12.261186"], ["updated_at", "2024-03-28 08:17:12.261186"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 08:17:12.265896"], ["updated_at", "2024-03-28 08:17:12.265896"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 8ms (Views: 0.2ms | ActiveRecord: 1.3ms | Allocations: 2133)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:17:12 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 16:17:12 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:17:12.309059"], ["updated_at", "2024-03-28 08:17:12.309059"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:17:12.311149"], ["updated_at", "2024-03-28 08:17:12.311149"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:17:12"], ["created_at", "2024-03-28 08:17:12.315652"], ["updated_at", "2024-03-28 08:17:12.315652"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 17ms (Views: 0.6ms | ActiveRecord: 1.4ms | Allocations: 2925)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:17:12 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 08:17:12.330678"], ["updated_at", "2024-03-28 08:17:12.330678"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 08:17:12.332552"], ["updated_at", "2024-03-28 08:17:12.332552"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 08:17:12.337202"], ["updated_at", "2024-03-28 08:17:12.337202"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 10ms (Views: 0.2ms | ActiveRecord: 1.9ms | Allocations: 2170)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:20:29 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:20:29.915616"], ["updated_at", "2024-03-28 08:20:29.915616"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:20:29.928329"], ["updated_at", "2024-03-28 08:20:29.928329"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:20:29"], ["created_at", "2024-03-28 08:20:29.946540"], ["updated_at", "2024-03-28 08:20:29.946540"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 43ms (Views: 0.7ms | ActiveRecord: 2.3ms | Allocations: 16837)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:20:29 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:20:29.979055"], ["updated_at", "2024-03-28 08:20:29.979055"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:20:29.981181"], ["updated_at", "2024-03-28 08:20:29.981181"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:20:29"], ["created_at", "2024-03-28 08:20:29.983386"], ["updated_at", "2024-03-28 08:20:29.983386"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 9ms (Views: 0.8ms | ActiveRecord: 1.2ms | Allocations: 2640)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 08:20:29.991713"], ["updated_at", "2024-03-28 08:20:29.991713"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 08:20:29.993339"], ["updated_at", "2024-03-28 08:20:29.993339"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 08:20:29.997288"], ["updated_at", "2024-03-28 08:20:29.997288"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 8ms (Views: 0.2ms | ActiveRecord: 1.3ms | Allocations: 2133)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:20:30 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 16:20:30 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:20:30.043315"], ["updated_at", "2024-03-28 08:20:30.043315"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:20:30.046694"], ["updated_at", "2024-03-28 08:20:30.046694"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:20:30"], ["created_at", "2024-03-28 08:20:30.051155"], ["updated_at", "2024-03-28 08:20:30.051155"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 20ms (Views: 0.6ms | ActiveRecord: 1.9ms | Allocations: 2925)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:20:30 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 08:20:30.066921"], ["updated_at", "2024-03-28 08:20:30.066921"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 08:20:30.068361"], ["updated_at", "2024-03-28 08:20:30.068361"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 08:20:30.070233"], ["updated_at", "2024-03-28 08:20:30.070233"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 6ms (Views: 0.1ms | ActiveRecord: 1.0ms | Allocations: 2170)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:23:13 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:23:13.366001"], ["updated_at", "2024-03-28 08:23:13.366001"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:23:13.378577"], ["updated_at", "2024-03-28 08:23:13.378577"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:23:13"], ["created_at", "2024-03-28 08:23:13.397845"], ["updated_at", "2024-03-28 08:23:13.397845"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 42ms (Views: 0.8ms | ActiveRecord: 2.4ms | Allocations: 16837)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:23:13 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:23:13.429983"], ["updated_at", "2024-03-28 08:23:13.429983"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:23:13.432133"], ["updated_at", "2024-03-28 08:23:13.432133"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:23:13"], ["created_at", "2024-03-28 08:23:13.434432"], ["updated_at", "2024-03-28 08:23:13.434432"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 9ms (Views: 0.7ms | ActiveRecord: 1.3ms | Allocations: 2640)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["rule_type", ""], ["created_at", "2024-03-28 08:23:13.443644"], ["updated_at", "2024-03-28 08:23:13.443644"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "created_at", "updated_at") VALUES (?, ?, ?)[0m  [["name", ""], ["created_at", "2024-03-28 08:23:13.445321"], ["updated_at", "2024-03-28 08:23:13.445321"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 08:23:13.448653"], ["updated_at", "2024-03-28 08:23:13.448653"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 7ms (Views: 0.2ms | ActiveRecord: 1.1ms | Allocations: 2000)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:23:13 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 16:23:13 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:23:13.503628"], ["updated_at", "2024-03-28 08:23:13.503628"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:23:13.506131"], ["updated_at", "2024-03-28 08:23:13.506131"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:23:13"], ["created_at", "2024-03-28 08:23:13.509665"], ["updated_at", "2024-03-28 08:23:13.509665"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 18ms (Views: 0.6ms | ActiveRecord: 1.5ms | Allocations: 2926)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:23:13 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 08:23:13.524752"], ["updated_at", "2024-03-28 08:23:13.524752"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("created_at", "updated_at") VALUES (?, ?)[0m  [["created_at", "2024-03-28 08:23:13.526573"], ["updated_at", "2024-03-28 08:23:13.526573"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["created_at", "2024-03-28 08:23:13.530459"], ["updated_at", "2024-03-28 08:23:13.530459"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 8ms (Views: 0.1ms | ActiveRecord: 1.4ms | Allocations: 2026)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:24:31 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.9ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:24:31.667911"], ["updated_at", "2024-03-28 08:24:31.667911"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:24:31.680239"], ["updated_at", "2024-03-28 08:24:31.680239"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:24:31"], ["created_at", "2024-03-28 08:24:31.698616"], ["updated_at", "2024-03-28 08:24:31.698616"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 44ms (Views: 0.8ms | ActiveRecord: 2.9ms | Allocations: 16837)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:24:31 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:24:31.730185"], ["updated_at", "2024-03-28 08:24:31.730185"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:24:31.731991"], ["updated_at", "2024-03-28 08:24:31.731991"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.6ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:24:31"], ["created_at", "2024-03-28 08:24:31.735119"], ["updated_at", "2024-03-28 08:24:31.735119"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 10ms (Views: 1.6ms | ActiveRecord: 1.7ms | Allocations: 2640)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 303)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:24:31 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 16:24:31 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:24:31.784820"], ["updated_at", "2024-03-28 08:24:31.784820"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:24:31.787428"], ["updated_at", "2024-03-28 08:24:31.787428"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:24:31"], ["created_at", "2024-03-28 08:24:31.790829"], ["updated_at", "2024-03-28 08:24:31.790829"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 17ms (Views: 0.6ms | ActiveRecord: 1.6ms | Allocations: 2925)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:24:31 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 318)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 6ms (Views: 1.5ms | ActiveRecord: 0.4ms | Allocations: 2063)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.0ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:04.412943"], ["updated_at", "2024-03-28 08:27:04.412943"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:04.424625"], ["updated_at", "2024-03-28 08:27:04.424625"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:04.426042"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:04.426042"], ["created_at", "2024-03-28 08:27:04.438794"], ["updated_at", "2024-03-28 08:27:04.438794"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 680)
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:04.448779"], ["updated_at", "2024-03-28 08:27:04.448779"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:04.450291"], ["updated_at", "2024-03-28 08:27:04.450291"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:27:04 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.3ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:04"], ["created_at", "2024-03-28 08:27:04.465369"], ["updated_at", "2024-03-28 08:27:04.465369"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 10ms (Views: 0.5ms | ActiveRecord: 1.0ms | Allocations: 2335)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:04.471173"], ["updated_at", "2024-03-28 08:27:04.471173"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:04.473340"], ["updated_at", "2024-03-28 08:27:04.473340"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:27:04 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (1.0ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:04"], ["created_at", "2024-03-28 08:27:04.481036"], ["updated_at", "2024-03-28 08:27:04.481036"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 7ms (Views: 0.4ms | ActiveRecord: 1.4ms | Allocations: 1249)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:27:04 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 10ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 2016)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:04.501667"], ["updated_at", "2024-03-28 08:27:04.501667"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:04.503786"], ["updated_at", "2024-03-28 08:27:04.503786"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:04.504933"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:04.504933"], ["created_at", "2024-03-28 08:27:04.505976"], ["updated_at", "2024-03-28 08:27:04.505976"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:27:04 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.7ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:27:04"], ["updated_at", "2024-03-28 08:27:04.518952"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 13ms (Views: 0.6ms | ActiveRecord: 1.2ms | Allocations: 1488)
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:04.533622"], ["updated_at", "2024-03-28 08:27:04.533622"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:04.536317"], ["updated_at", "2024-03-28 08:27:04.536317"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:04.538545"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:04.538545"], ["created_at", "2024-03-28 08:27:04.540296"], ["updated_at", "2024-03-28 08:27:04.540296"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:27:04 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.3ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:27:04"], ["updated_at", "2024-03-28 08:27:04.556834"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 14ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 1328)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:04.564353"], ["updated_at", "2024-03-28 08:27:04.564353"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:04.567008"], ["updated_at", "2024-03-28 08:27:04.567008"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:04.568713"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:04.568713"], ["created_at", "2024-03-28 08:27:04.572968"], ["updated_at", "2024-03-28 08:27:04.572968"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:27:04 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 3ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 1108)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:04.583426"], ["updated_at", "2024-03-28 08:27:04.583426"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:04.585754"], ["updated_at", "2024-03-28 08:27:04.585754"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:04.589191"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:04.589191"], ["created_at", "2024-03-28 08:27:04.590180"], ["updated_at", "2024-03-28 08:27:04.590180"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 426)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (2.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:04.598181"], ["updated_at", "2024-03-28 08:27:04.598181"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:04.603730"], ["updated_at", "2024-03-28 08:27:04.603730"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:04.605876"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:04.605876"], ["created_at", "2024-03-28 08:27:04.608204"], ["updated_at", "2024-03-28 08:27:04.608204"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.6ms | Allocations: 357)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.4ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 2ms (Views: 0.7ms | ActiveRecord: 0.4ms | Allocations: 337)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:04.633277"], ["updated_at", "2024-03-28 08:27:04.633277"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 10ms (Views: 0.7ms | ActiveRecord: 0.1ms | Allocations: 520)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 31ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 505)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 5ms (Views: 3.7ms | ActiveRecord: 0.0ms | Allocations: 473)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 6ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 594)
  [1m[35m (5.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:04.763055"], ["updated_at", "2024-03-28 08:27:04.763055"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:27:04.785290"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 24ms (Views: 4.4ms | ActiveRecord: 0.5ms | Allocations: 1671)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (1.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:04.811491"], ["updated_at", "2024-03-28 08:27:04.811491"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:27:04.830989"], ["id", 1]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 15ms (Views: 0.6ms | ActiveRecord: 0.9ms | Allocations: 1619)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:04.839565"], ["updated_at", "2024-03-28 08:27:04.839565"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 2ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 661)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:04.850440"], ["updated_at", "2024-03-28 08:27:04.850440"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.5ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:04.862353"], ["updated_at", "2024-03-28 08:27:04.862353"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.3ms | Allocations: 356)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 1ms (Views: 0.7ms | ActiveRecord: 0.2ms | Allocations: 345)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (4.0ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:04.946770"], ["updated_at", "2024-03-28 08:27:04.946770"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 505)
  [1m[35m (16.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (2.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:04.993978"], ["updated_at", "2024-03-28 08:27:04.993978"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.5ms | ActiveRecord: 0.9ms | Allocations: 867)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:05.007966"], ["updated_at", "2024-03-28 08:27:05.007966"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 10ms (Views: 2.7ms | ActiveRecord: 1.1ms | Allocations: 855)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:05.032436"], ["updated_at", "2024-03-28 08:27:05.032436"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:27:05.041179"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.6ms | ActiveRecord: 0.4ms | Allocations: 912)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (44.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:05.091851"], ["updated_at", "2024-03-28 08:27:05.091851"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:27:05.096893"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.6ms | ActiveRecord: 0.4ms | Allocations: 876)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:05.104447"], ["updated_at", "2024-03-28 08:27:05.104447"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 367)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:05.114372"], ["updated_at", "2024-03-28 08:27:05.114372"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 0.5ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:05.124537"], ["updated_at", "2024-03-28 08:27:05.124537"]]
  [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.4ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.7ms | Allocations: 356)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 3ms (Views: 0.4ms | ActiveRecord: 0.2ms | Allocations: 561)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:27:05 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:05.150474"], ["updated_at", "2024-03-28 08:27:05.150474"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:05.153797"], ["updated_at", "2024-03-28 08:27:05.153797"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:05"], ["created_at", "2024-03-28 08:27:05.160520"], ["updated_at", "2024-03-28 08:27:05.160520"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 13ms (Views: 0.7ms | ActiveRecord: 2.0ms | Allocations: 3338)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:27:05 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:05.173027"], ["updated_at", "2024-03-28 08:27:05.173027"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:05.175029"], ["updated_at", "2024-03-28 08:27:05.175029"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:05"], ["created_at", "2024-03-28 08:27:05.178313"], ["updated_at", "2024-03-28 08:27:05.178313"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 9ms (Views: 0.8ms | ActiveRecord: 1.6ms | Allocations: 2639)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 302)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 1ms (Views: 0.9ms | ActiveRecord: 0.2ms | Allocations: 224)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:05.195803"], ["updated_at", "2024-03-28 08:27:05.195803"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:05.197972"], ["updated_at", "2024-03-28 08:27:05.197972"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:05.198949"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:05.198949"], ["created_at", "2024-03-28 08:27:05.201344"], ["updated_at", "2024-03-28 08:27:05.201344"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 1ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 370)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:05.212512"], ["updated_at", "2024-03-28 08:27:05.212512"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:05.215246"], ["updated_at", "2024-03-28 08:27:05.215246"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:27:05 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:05"], ["created_at", "2024-03-28 08:27:05.221584"], ["updated_at", "2024-03-28 08:27:05.221584"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 1249)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:05.227720"], ["updated_at", "2024-03-28 08:27:05.227720"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:05.230234"], ["updated_at", "2024-03-28 08:27:05.230234"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:27:05 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.5ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:05"], ["created_at", "2024-03-28 08:27:05.237256"], ["updated_at", "2024-03-28 08:27:05.237256"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.4ms | ActiveRecord: 0.9ms | Allocations: 1249)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:27:05 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 2ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 1009)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.0ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:05.250588"], ["updated_at", "2024-03-28 08:27:05.250588"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:05.254888"], ["updated_at", "2024-03-28 08:27:05.254888"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:05.256919"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:05.256919"], ["created_at", "2024-03-28 08:27:05.258026"], ["updated_at", "2024-03-28 08:27:05.258026"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:27:05 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:27:05"], ["updated_at", "2024-03-28 08:27:05.263933"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 1328)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:05.270523"], ["updated_at", "2024-03-28 08:27:05.270523"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:05.272986"], ["updated_at", "2024-03-28 08:27:05.272986"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:05.274210"], ["LIMIT", 1]]
  [1m[35m (1.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:05.274210"], ["created_at", "2024-03-28 08:27:05.275897"], ["updated_at", "2024-03-28 08:27:05.275897"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:27:05 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.3ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:27:05"], ["updated_at", "2024-03-28 08:27:05.285440"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.5ms | ActiveRecord: 0.7ms | Allocations: 1328)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:05.290498"], ["updated_at", "2024-03-28 08:27:05.290498"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:05.293293"], ["updated_at", "2024-03-28 08:27:05.293293"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:05.294794"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:05.294794"], ["created_at", "2024-03-28 08:27:05.296934"], ["updated_at", "2024-03-28 08:27:05.296934"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:27:05 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 4ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 1103)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.7ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:05.309783"], ["updated_at", "2024-03-28 08:27:05.309783"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:05.312265"], ["updated_at", "2024-03-28 08:27:05.312265"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:05.314172"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:05.314172"], ["created_at", "2024-03-28 08:27:05.316040"], ["updated_at", "2024-03-28 08:27:05.316040"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 357)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:05.326636"], ["updated_at", "2024-03-28 08:27:05.326636"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:05.329381"], ["updated_at", "2024-03-28 08:27:05.329381"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:05.331145"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:05.331145"], ["created_at", "2024-03-28 08:27:05.332609"], ["updated_at", "2024-03-28 08:27:05.332609"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 5ms (ActiveRecord: 0.4ms | Allocations: 357)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 2ms (Views: 0.6ms | ActiveRecord: 0.2ms | Allocations: 222)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:05.346911"], ["updated_at", "2024-03-28 08:27:05.346911"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 1ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 379)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 472)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 4ms (Views: 2.1ms | ActiveRecord: 0.0ms | Allocations: 472)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 2ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 574)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:05.380201"], ["updated_at", "2024-03-28 08:27:05.380201"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:27:05.388501"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 1.4ms | ActiveRecord: 0.3ms | Allocations: 1617)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:05.395706"], ["updated_at", "2024-03-28 08:27:05.395706"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:27:05.403878"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 1617)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:05.409944"], ["updated_at", "2024-03-28 08:27:05.409944"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 2ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 661)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:05.421510"], ["updated_at", "2024-03-28 08:27:05.421510"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:05.431299"], ["updated_at", "2024-03-28 08:27:05.431299"]]
  [1m[35m (1.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.3ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.5ms | Allocations: 356)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 222)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:05.447153"], ["updated_at", "2024-03-28 08:27:05.447153"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 4ms (Views: 1.0ms | ActiveRecord: 0.1ms | Allocations: 364)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:05.462582"], ["updated_at", "2024-03-28 08:27:05.462582"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.4ms | ActiveRecord: 0.8ms | Allocations: 855)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:05.472342"], ["updated_at", "2024-03-28 08:27:05.472342"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 3ms (Views: 0.3ms | ActiveRecord: 0.6ms | Allocations: 855)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:05.486375"], ["updated_at", "2024-03-28 08:27:05.486375"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:27:05.491728"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 876)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:05.497268"], ["updated_at", "2024-03-28 08:27:05.497268"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:27:05.504601"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.5ms | ActiveRecord: 0.7ms | Allocations: 876)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:05.511344"], ["updated_at", "2024-03-28 08:27:05.511344"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 367)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:05.531492"], ["updated_at", "2024-03-28 08:27:05.531492"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.5ms | Allocations: 356)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:05.545624"], ["updated_at", "2024-03-28 08:27:05.545624"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (1.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.3ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 1.5ms | Allocations: 356)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:27:05 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 16:27:05 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:27:05.598148"], ["updated_at", "2024-03-28 08:27:05.598148"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:27:05.600679"], ["updated_at", "2024-03-28 08:27:05.600679"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:27:05"], ["created_at", "2024-03-28 08:27:05.604603"], ["updated_at", "2024-03-28 08:27:05.604603"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 20ms (Views: 0.8ms | ActiveRecord: 1.5ms | Allocations: 2924)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:27:05 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 317)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 5ms (Views: 1.3ms | ActiveRecord: 0.4ms | Allocations: 2063)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:00.557198"], ["updated_at", "2024-03-28 08:28:00.557198"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:00.570019"], ["updated_at", "2024-03-28 08:28:00.570019"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:00.572095"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:00.572095"], ["created_at", "2024-03-28 08:28:00.586051"], ["updated_at", "2024-03-28 08:28:00.586051"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 680)
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:00.597277"], ["updated_at", "2024-03-28 08:28:00.597277"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:00.599027"], ["updated_at", "2024-03-28 08:28:00.599027"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:28:00 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:00"], ["created_at", "2024-03-28 08:28:00.615220"], ["updated_at", "2024-03-28 08:28:00.615220"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 8ms (Views: 0.3ms | ActiveRecord: 0.6ms | Allocations: 2335)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:00.619904"], ["updated_at", "2024-03-28 08:28:00.619904"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:00.621478"], ["updated_at", "2024-03-28 08:28:00.621478"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:28:00 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:00"], ["created_at", "2024-03-28 08:28:00.628147"], ["updated_at", "2024-03-28 08:28:00.628147"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 7ms (Views: 1.6ms | ActiveRecord: 0.7ms | Allocations: 1249)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:28:00 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 6ms (Views: 0.5ms | ActiveRecord: 0.0ms | Allocations: 2016)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:00.650308"], ["updated_at", "2024-03-28 08:28:00.650308"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:00.653997"], ["updated_at", "2024-03-28 08:28:00.653997"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:00.655353"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:00.655353"], ["created_at", "2024-03-28 08:28:00.656317"], ["updated_at", "2024-03-28 08:28:00.656317"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:28:00 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:28:00"], ["updated_at", "2024-03-28 08:28:00.664338"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 0.8ms | Allocations: 1488)
  [1m[36mAvailability Load (0.4ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:00.671915"], ["updated_at", "2024-03-28 08:28:00.671915"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:00.674166"], ["updated_at", "2024-03-28 08:28:00.674166"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:00.675412"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:00.675412"], ["created_at", "2024-03-28 08:28:00.676930"], ["updated_at", "2024-03-28 08:28:00.676930"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:28:00 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.0ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.1ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:28:00"], ["updated_at", "2024-03-28 08:28:00.684450"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 1.0ms | ActiveRecord: 0.4ms | Allocations: 1328)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:00.689097"], ["updated_at", "2024-03-28 08:28:00.689097"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:00.690743"], ["updated_at", "2024-03-28 08:28:00.690743"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:00.692011"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.5ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:00.692011"], ["created_at", "2024-03-28 08:28:00.694434"], ["updated_at", "2024-03-28 08:28:00.694434"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:28:00 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 5ms (Views: 0.2ms | ActiveRecord: 0.4ms | Allocations: 1108)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:00.705944"], ["updated_at", "2024-03-28 08:28:00.705944"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:00.708025"], ["updated_at", "2024-03-28 08:28:00.708025"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:00.709314"], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:00.709314"], ["created_at", "2024-03-28 08:28:00.712235"], ["updated_at", "2024-03-28 08:28:00.712235"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.5ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:00.722641"], ["updated_at", "2024-03-28 08:28:00.722641"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:00.724287"], ["updated_at", "2024-03-28 08:28:00.724287"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:00.725616"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:00.725616"], ["created_at", "2024-03-28 08:28:00.727335"], ["updated_at", "2024-03-28 08:28:00.727335"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 357)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 337)
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:00.739489"], ["updated_at", "2024-03-28 08:28:00.739489"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 1.2ms | ActiveRecord: 0.2ms | Allocations: 520)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 505)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 3ms (Views: 2.6ms | ActiveRecord: 0.0ms | Allocations: 473)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 5ms (Views: 2.7ms | ActiveRecord: 0.0ms | Allocations: 594)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:00.801173"], ["updated_at", "2024-03-28 08:28:00.801173"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:28:00.817663"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 14ms (Views: 2.9ms | ActiveRecord: 0.4ms | Allocations: 1671)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:00.837264"], ["updated_at", "2024-03-28 08:28:00.837264"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:28:00.857762"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 16ms (Views: 1.8ms | ActiveRecord: 0.5ms | Allocations: 1617)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:00.869893"], ["updated_at", "2024-03-28 08:28:00.869893"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 2ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 663)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:00.886170"], ["updated_at", "2024-03-28 08:28:00.886170"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:00.894891"], ["updated_at", "2024-03-28 08:28:00.894891"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.9ms | Allocations: 356)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 345)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:00.910739"], ["updated_at", "2024-03-28 08:28:00.910739"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 505)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:00.924653"], ["updated_at", "2024-03-28 08:28:00.924653"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 1.2ms | ActiveRecord: 0.6ms | Allocations: 867)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (1.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.9ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:00.934270"], ["updated_at", "2024-03-28 08:28:00.934270"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.6ms | ActiveRecord: 1.4ms | Allocations: 855)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:00.947693"], ["updated_at", "2024-03-28 08:28:00.947693"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:28:00.952062"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.5ms | ActiveRecord: 0.5ms | Allocations: 912)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.0ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:00.958704"], ["updated_at", "2024-03-28 08:28:00.958704"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:28:00.965414"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.5ms | ActiveRecord: 0.4ms | Allocations: 876)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:00.970939"], ["updated_at", "2024-03-28 08:28:00.970939"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 2ms (Views: 0.3ms | ActiveRecord: 0.1ms | Allocations: 367)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.5ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:00.981585"], ["updated_at", "2024-03-28 08:28:00.981585"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.0ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:00.991884"], ["updated_at", "2024-03-28 08:28:00.991884"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 356)
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 2ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 561)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:28:01 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:01.019764"], ["updated_at", "2024-03-28 08:28:01.019764"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:01.021762"], ["updated_at", "2024-03-28 08:28:01.021762"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:01"], ["created_at", "2024-03-28 08:28:01.027707"], ["updated_at", "2024-03-28 08:28:01.027707"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 12ms (Views: 1.0ms | ActiveRecord: 1.6ms | Allocations: 3338)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:28:01 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:01.040429"], ["updated_at", "2024-03-28 08:28:01.040429"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:01.043729"], ["updated_at", "2024-03-28 08:28:01.043729"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:01"], ["created_at", "2024-03-28 08:28:01.049024"], ["updated_at", "2024-03-28 08:28:01.049024"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 13ms (Views: 0.9ms | ActiveRecord: 2.2ms | Allocations: 2639)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
Completed 422 Unprocessable Entity in 0ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 302)
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 2ms (Views: 0.6ms | ActiveRecord: 0.3ms | Allocations: 224)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.9ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.9ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:01.066214"], ["updated_at", "2024-03-28 08:28:01.066214"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:01.071000"], ["updated_at", "2024-03-28 08:28:01.071000"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:01.072293"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:01.072293"], ["created_at", "2024-03-28 08:28:01.073254"], ["updated_at", "2024-03-28 08:28:01.073254"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 1ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 370)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (2.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:01.082657"], ["updated_at", "2024-03-28 08:28:01.082657"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:01.087715"], ["updated_at", "2024-03-28 08:28:01.087715"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:28:01 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:01"], ["created_at", "2024-03-28 08:28:01.092789"], ["updated_at", "2024-03-28 08:28:01.092789"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.6ms | ActiveRecord: 0.6ms | Allocations: 1249)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:01.099334"], ["updated_at", "2024-03-28 08:28:01.099334"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:01.103213"], ["updated_at", "2024-03-28 08:28:01.103213"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:28:01 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:01"], ["created_at", "2024-03-28 08:28:01.108457"], ["updated_at", "2024-03-28 08:28:01.108457"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.4ms | ActiveRecord: 0.9ms | Allocations: 1249)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:28:01 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 4ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 1009)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:01.123477"], ["updated_at", "2024-03-28 08:28:01.123477"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:01.125892"], ["updated_at", "2024-03-28 08:28:01.125892"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:01.127845"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:01.127845"], ["created_at", "2024-03-28 08:28:01.130977"], ["updated_at", "2024-03-28 08:28:01.130977"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:28:01 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.1ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:28:01"], ["updated_at", "2024-03-28 08:28:01.139519"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 0.5ms | Allocations: 1328)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:01.146107"], ["updated_at", "2024-03-28 08:28:01.146107"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:01.148360"], ["updated_at", "2024-03-28 08:28:01.148360"]]
  [1m[35m (2.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:01.151959"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:01.151959"], ["created_at", "2024-03-28 08:28:01.153809"], ["updated_at", "2024-03-28 08:28:01.153809"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:28:01 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.0ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.1ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:28:01"], ["updated_at", "2024-03-28 08:28:01.158055"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 1328)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:01.164371"], ["updated_at", "2024-03-28 08:28:01.164371"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:01.166439"], ["updated_at", "2024-03-28 08:28:01.166439"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:01.170337"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:01.170337"], ["created_at", "2024-03-28 08:28:01.171632"], ["updated_at", "2024-03-28 08:28:01.171632"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:28:01 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 4ms (Views: 0.4ms | ActiveRecord: 0.3ms | Allocations: 1103)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:01.182219"], ["updated_at", "2024-03-28 08:28:01.182219"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:01.186012"], ["updated_at", "2024-03-28 08:28:01.186012"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:01.187945"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:01.187945"], ["created_at", "2024-03-28 08:28:01.189026"], ["updated_at", "2024-03-28 08:28:01.189026"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 357)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:01.198269"], ["updated_at", "2024-03-28 08:28:01.198269"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:01.201813"], ["updated_at", "2024-03-28 08:28:01.201813"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:01.204147"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:01.204147"], ["created_at", "2024-03-28 08:28:01.205326"], ["updated_at", "2024-03-28 08:28:01.205326"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 357)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 222)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:01.220622"], ["updated_at", "2024-03-28 08:28:01.220622"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 379)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 2ms (Views: 0.8ms | ActiveRecord: 0.0ms | Allocations: 472)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 472)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 2ms (Views: 0.4ms | ActiveRecord: 0.0ms | Allocations: 574)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:01.250088"], ["updated_at", "2024-03-28 08:28:01.250088"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:28:01.256887"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 1617)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:01.264881"], ["updated_at", "2024-03-28 08:28:01.264881"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:28:01.271740"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.3ms | ActiveRecord: 0.3ms | Allocations: 1617)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:01.275791"], ["updated_at", "2024-03-28 08:28:01.275791"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 4ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 661)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:01.289474"], ["updated_at", "2024-03-28 08:28:01.289474"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.5ms | Allocations: 356)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (1.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.0ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:01.300239"], ["updated_at", "2024-03-28 08:28:01.300239"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 356)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.3ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 2ms (Views: 1.1ms | ActiveRecord: 0.3ms | Allocations: 222)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:01.319572"], ["updated_at", "2024-03-28 08:28:01.319572"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 1ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 364)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:01.331404"], ["updated_at", "2024-03-28 08:28:01.331404"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 1.4ms | ActiveRecord: 1.4ms | Allocations: 855)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:01.341449"], ["updated_at", "2024-03-28 08:28:01.341449"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 1.1ms | ActiveRecord: 0.8ms | Allocations: 855)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
Completed 422 Unprocessable Entity in 2ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:01.356604"], ["updated_at", "2024-03-28 08:28:01.356604"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.3ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:28:01.361836"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.4ms | ActiveRecord: 0.9ms | Allocations: 876)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:01.370081"], ["updated_at", "2024-03-28 08:28:01.370081"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:28:01.373360"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.4ms | ActiveRecord: 0.3ms | Allocations: 876)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:01.380460"], ["updated_at", "2024-03-28 08:28:01.380460"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.5ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 3ms (Views: 0.3ms | ActiveRecord: 0.5ms | Allocations: 367)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:01.392445"], ["updated_at", "2024-03-28 08:28:01.392445"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.5ms | Allocations: 356)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:01.404902"], ["updated_at", "2024-03-28 08:28:01.404902"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:28:01 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 16:28:01 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:28:01.457868"], ["updated_at", "2024-03-28 08:28:01.457868"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:28:01.460434"], ["updated_at", "2024-03-28 08:28:01.460434"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:28:01"], ["created_at", "2024-03-28 08:28:01.467360"], ["updated_at", "2024-03-28 08:28:01.467360"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 25ms (Views: 0.7ms | ActiveRecord: 1.9ms | Allocations: 2924)
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:28:01 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 317)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (1.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 6ms (Views: 1.2ms | ActiveRecord: 0.3ms | Allocations: 2063)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:01.449076"], ["updated_at", "2024-03-28 08:30:01.449076"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:01.466104"], ["updated_at", "2024-03-28 08:30:01.466104"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:01.467833"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:01.467833"], ["created_at", "2024-03-28 08:30:01.483269"], ["updated_at", "2024-03-28 08:30:01.483269"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 680)
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:01.494325"], ["updated_at", "2024-03-28 08:30:01.494325"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:01.496368"], ["updated_at", "2024-03-28 08:30:01.496368"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:30:01 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:01"], ["created_at", "2024-03-28 08:30:01.511624"], ["updated_at", "2024-03-28 08:30:01.511624"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 9ms (Views: 0.5ms | ActiveRecord: 0.7ms | Allocations: 2335)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:01.518928"], ["updated_at", "2024-03-28 08:30:01.518928"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:01.521298"], ["updated_at", "2024-03-28 08:30:01.521298"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:30:01 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.5ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:01"], ["created_at", "2024-03-28 08:30:01.528358"], ["updated_at", "2024-03-28 08:30:01.528358"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.4ms | ActiveRecord: 0.8ms | Allocations: 1249)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:30:01 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 6ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 2016)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:01.550268"], ["updated_at", "2024-03-28 08:30:01.550268"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:01.552785"], ["updated_at", "2024-03-28 08:30:01.552785"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:01.555479"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.7ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:01.555479"], ["created_at", "2024-03-28 08:30:01.557830"], ["updated_at", "2024-03-28 08:30:01.557830"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:30:01 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.3ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:30:01"], ["updated_at", "2024-03-28 08:30:01.566195"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 1488)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:01.577738"], ["updated_at", "2024-03-28 08:30:01.577738"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:01.579875"], ["updated_at", "2024-03-28 08:30:01.579875"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.5ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:01.580899"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:01.580899"], ["created_at", "2024-03-28 08:30:01.583192"], ["updated_at", "2024-03-28 08:30:01.583192"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:30:01 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.1ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:30:01"], ["updated_at", "2024-03-28 08:30:01.591012"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 0.5ms | Allocations: 1328)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:01.596256"], ["updated_at", "2024-03-28 08:30:01.596256"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:01.597999"], ["updated_at", "2024-03-28 08:30:01.597999"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:01.598936"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:01.598936"], ["created_at", "2024-03-28 08:30:01.599842"], ["updated_at", "2024-03-28 08:30:01.599842"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:30:01 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 3ms (Views: 0.2ms | ActiveRecord: 0.2ms | Allocations: 1108)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:01.612969"], ["updated_at", "2024-03-28 08:30:01.612969"]]
  [1m[35m (1.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:01.616868"], ["updated_at", "2024-03-28 08:30:01.616868"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:01.618649"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:01.618649"], ["created_at", "2024-03-28 08:30:01.619740"], ["updated_at", "2024-03-28 08:30:01.619740"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.4ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:01.632554"], ["updated_at", "2024-03-28 08:30:01.632554"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:01.634675"], ["updated_at", "2024-03-28 08:30:01.634675"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:01.636687"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.7ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:01.636687"], ["created_at", "2024-03-28 08:30:01.638637"], ["updated_at", "2024-03-28 08:30:01.638637"]]
  [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 357)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 1ms (Views: 0.8ms | ActiveRecord: 0.2ms | Allocations: 337)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:01.655258"], ["updated_at", "2024-03-28 08:30:01.655258"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 520)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 2ms (Views: 0.4ms | ActiveRecord: 0.0ms | Allocations: 505)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 6ms (Views: 0.4ms | ActiveRecord: 0.0ms | Allocations: 473)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 9ms (Views: 4.2ms | ActiveRecord: 0.0ms | Allocations: 594)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:01.736863"], ["updated_at", "2024-03-28 08:30:01.736863"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:30:01.755101"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 16ms (Views: 3.3ms | ActiveRecord: 0.6ms | Allocations: 1671)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:01.772085"], ["updated_at", "2024-03-28 08:30:01.772085"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:30:01.798108"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 15ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 1617)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:01.812328"], ["updated_at", "2024-03-28 08:30:01.812328"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 663)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:01.826692"], ["updated_at", "2024-03-28 08:30:01.826692"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 363)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:01.839276"], ["updated_at", "2024-03-28 08:30:01.839276"]]
  [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (2.7ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 4ms (Views: 1.1ms | ActiveRecord: 2.7ms | Allocations: 345)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:01.863822"], ["updated_at", "2024-03-28 08:30:01.863822"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 505)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:01.880909"], ["updated_at", "2024-03-28 08:30:01.880909"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 3ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 867)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (1.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:01.893319"], ["updated_at", "2024-03-28 08:30:01.893319"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 855)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.5ms | ActiveRecord: 0.0ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:01.905023"], ["updated_at", "2024-03-28 08:30:01.905023"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:30:01.914224"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 2ms (Views: 0.4ms | ActiveRecord: 0.3ms | Allocations: 912)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:01.919668"], ["updated_at", "2024-03-28 08:30:01.919668"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:30:01.927996"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 876)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:01.932732"], ["updated_at", "2024-03-28 08:30:01.932732"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 4ms (Views: 2.1ms | ActiveRecord: 0.1ms | Allocations: 367)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:01.945074"], ["updated_at", "2024-03-28 08:30:01.945074"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.2ms | Allocations: 363)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:01.955276"], ["updated_at", "2024-03-28 08:30:01.955276"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 2ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 561)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:30:01 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:01.982894"], ["updated_at", "2024-03-28 08:30:01.982894"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:01.985676"], ["updated_at", "2024-03-28 08:30:01.985676"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:01"], ["created_at", "2024-03-28 08:30:01.994905"], ["updated_at", "2024-03-28 08:30:01.994905"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 16ms (Views: 0.7ms | ActiveRecord: 2.0ms | Allocations: 3338)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:30:02 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:02.012427"], ["updated_at", "2024-03-28 08:30:02.012427"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:02.014790"], ["updated_at", "2024-03-28 08:30:02.014790"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:02"], ["created_at", "2024-03-28 08:30:02.019122"], ["updated_at", "2024-03-28 08:30:02.019122"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 13ms (Views: 4.4ms | ActiveRecord: 1.5ms | Allocations: 2639)
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
Completed 422 Unprocessable Entity in 0ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 302)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 224)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:02.040059"], ["updated_at", "2024-03-28 08:30:02.040059"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:02.042062"], ["updated_at", "2024-03-28 08:30:02.042062"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:02.045430"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:02.045430"], ["created_at", "2024-03-28 08:30:02.046719"], ["updated_at", "2024-03-28 08:30:02.046719"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 1ms (Views: 0.7ms | ActiveRecord: 0.1ms | Allocations: 370)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (1.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:02.056503"], ["updated_at", "2024-03-28 08:30:02.056503"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:02.060900"], ["updated_at", "2024-03-28 08:30:02.060900"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:30:02 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:02"], ["created_at", "2024-03-28 08:30:02.066301"], ["updated_at", "2024-03-28 08:30:02.066301"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.3ms | ActiveRecord: 0.6ms | Allocations: 1249)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:02.070761"], ["updated_at", "2024-03-28 08:30:02.070761"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:02.075182"], ["updated_at", "2024-03-28 08:30:02.075182"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:30:02 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:02"], ["created_at", "2024-03-28 08:30:02.083938"], ["updated_at", "2024-03-28 08:30:02.083938"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 1249)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:30:02 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 3ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 1009)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:02.100991"], ["updated_at", "2024-03-28 08:30:02.100991"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:02.103411"], ["updated_at", "2024-03-28 08:30:02.103411"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:02.104997"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.7ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:02.104997"], ["created_at", "2024-03-28 08:30:02.106752"], ["updated_at", "2024-03-28 08:30:02.106752"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:30:02 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:30:02"], ["updated_at", "2024-03-28 08:30:02.116312"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 1328)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:02.121863"], ["updated_at", "2024-03-28 08:30:02.121863"]]
  [1m[35m (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:02.127429"], ["updated_at", "2024-03-28 08:30:02.127429"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:02.129295"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:02.129295"], ["created_at", "2024-03-28 08:30:02.130456"], ["updated_at", "2024-03-28 08:30:02.130456"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:30:02 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.0ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.1ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:30:02"], ["updated_at", "2024-03-28 08:30:02.135868"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 1328)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:02.141573"], ["updated_at", "2024-03-28 08:30:02.141573"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:02.145503"], ["updated_at", "2024-03-28 08:30:02.145503"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:02.146868"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:02.146868"], ["created_at", "2024-03-28 08:30:02.150770"], ["updated_at", "2024-03-28 08:30:02.150770"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:30:02 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 7ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 1103)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:02.163751"], ["updated_at", "2024-03-28 08:30:02.163751"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:02.168438"], ["updated_at", "2024-03-28 08:30:02.168438"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:02.171100"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.5ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:02.171100"], ["created_at", "2024-03-28 08:30:02.174461"], ["updated_at", "2024-03-28 08:30:02.174461"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 357)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (2.9ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:02.187814"], ["updated_at", "2024-03-28 08:30:02.187814"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:02.194551"], ["updated_at", "2024-03-28 08:30:02.194551"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:02.196171"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:02.196171"], ["created_at", "2024-03-28 08:30:02.197226"], ["updated_at", "2024-03-28 08:30:02.197226"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.2ms | Allocations: 357)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 1ms (Views: 0.6ms | ActiveRecord: 0.2ms | Allocations: 222)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:02.208444"], ["updated_at", "2024-03-28 08:30:02.208444"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 1.4ms | ActiveRecord: 0.1ms | Allocations: 379)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 472)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 2ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 472)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 574)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:02.242052"], ["updated_at", "2024-03-28 08:30:02.242052"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:30:02.250679"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.3ms | ActiveRecord: 0.5ms | Allocations: 1617)
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:02.255886"], ["updated_at", "2024-03-28 08:30:02.255886"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (1.4ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:30:02.263707"], ["id", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.6ms | ActiveRecord: 1.8ms | Allocations: 1617)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:02.270760"], ["updated_at", "2024-03-28 08:30:02.270760"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 3ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 661)
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:02.283657"], ["updated_at", "2024-03-28 08:30:02.283657"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:02.295551"], ["updated_at", "2024-03-28 08:30:02.295551"]]
  [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 356)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 3ms (Views: 1.9ms | ActiveRecord: 0.2ms | Allocations: 222)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:02.313842"], ["updated_at", "2024-03-28 08:30:02.313842"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 1ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 364)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:02.328397"], ["updated_at", "2024-03-28 08:30:02.328397"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.4ms | ActiveRecord: 0.8ms | Allocations: 855)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:02.337941"], ["updated_at", "2024-03-28 08:30:02.337941"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 1.3ms | ActiveRecord: 0.8ms | Allocations: 855)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:02.352949"], ["updated_at", "2024-03-28 08:30:02.352949"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:30:02.358768"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.6ms | ActiveRecord: 0.5ms | Allocations: 876)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (1.4ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:02.367996"], ["updated_at", "2024-03-28 08:30:02.367996"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:30:02.372666"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.6ms | ActiveRecord: 0.5ms | Allocations: 876)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.9ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:02.380163"], ["updated_at", "2024-03-28 08:30:02.380163"]]
  [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 367)
  [1m[35m (2.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:02.392854"], ["updated_at", "2024-03-28 08:30:02.392854"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (2.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 356)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:02.403636"], ["updated_at", "2024-03-28 08:30:02.403636"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:30:02 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 16:30:02 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:30:02.458497"], ["updated_at", "2024-03-28 08:30:02.458497"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:30:02.461154"], ["updated_at", "2024-03-28 08:30:02.461154"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:30:02"], ["created_at", "2024-03-28 08:30:02.463722"], ["updated_at", "2024-03-28 08:30:02.463722"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 17ms (Views: 0.6ms | ActiveRecord: 1.3ms | Allocations: 2924)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:30:02 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 317)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 6ms (Views: 1.4ms | ActiveRecord: 0.4ms | Allocations: 2063)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:15.235575"], ["updated_at", "2024-03-28 08:31:15.235575"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.248181"], ["updated_at", "2024-03-28 08:31:15.248181"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15.249846"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15.249846"], ["created_at", "2024-03-28 08:31:15.262322"], ["updated_at", "2024-03-28 08:31:15.262322"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 1ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 680)
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:15.272252"], ["updated_at", "2024-03-28 08:31:15.272252"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.273877"], ["updated_at", "2024-03-28 08:31:15.273877"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:31:15 +0800", "tour_id"=>"1"}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15"], ["created_at", "2024-03-28 08:31:15.287307"], ["updated_at", "2024-03-28 08:31:15.287307"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 9ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 2335)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:15.293840"], ["updated_at", "2024-03-28 08:31:15.293840"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.295533"], ["updated_at", "2024-03-28 08:31:15.295533"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:31:15 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15"], ["created_at", "2024-03-28 08:31:15.300624"], ["updated_at", "2024-03-28 08:31:15.300624"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 1249)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:31:15 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 6ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 2016)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:15.318657"], ["updated_at", "2024-03-28 08:31:15.318657"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.321012"], ["updated_at", "2024-03-28 08:31:15.321012"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15.323231"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15.323231"], ["created_at", "2024-03-28 08:31:15.325115"], ["updated_at", "2024-03-28 08:31:15.325115"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:31:15 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:31:15"], ["updated_at", "2024-03-28 08:31:15.333389"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 0.8ms | Allocations: 1488)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:15.341508"], ["updated_at", "2024-03-28 08:31:15.341508"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.344641"], ["updated_at", "2024-03-28 08:31:15.344641"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15.345638"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15.345638"], ["created_at", "2024-03-28 08:31:15.346532"], ["updated_at", "2024-03-28 08:31:15.346532"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:31:15 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.1ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:31:15"], ["updated_at", "2024-03-28 08:31:15.351311"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.5ms | ActiveRecord: 0.5ms | Allocations: 1328)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:15.356967"], ["updated_at", "2024-03-28 08:31:15.356967"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.358935"], ["updated_at", "2024-03-28 08:31:15.358935"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15.360038"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15.360038"], ["created_at", "2024-03-28 08:31:15.361586"], ["updated_at", "2024-03-28 08:31:15.361586"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:31:15 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 4ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 1108)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:15.372737"], ["updated_at", "2024-03-28 08:31:15.372737"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.375287"], ["updated_at", "2024-03-28 08:31:15.375287"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15.377298"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15.377298"], ["created_at", "2024-03-28 08:31:15.378477"], ["updated_at", "2024-03-28 08:31:15.378477"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.4ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:15.388396"], ["updated_at", "2024-03-28 08:31:15.388396"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.390722"], ["updated_at", "2024-03-28 08:31:15.390722"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15.392585"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15.392585"], ["created_at", "2024-03-28 08:31:15.393836"], ["updated_at", "2024-03-28 08:31:15.393836"]]
  [1m[35m (1.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.6ms | Allocations: 357)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 337)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.408348"], ["updated_at", "2024-03-28 08:31:15.408348"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 520)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 2ms (Views: 0.4ms | ActiveRecord: 0.0ms | Allocations: 505)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 4ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 473)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 4ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 594)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (3.0ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.471298"], ["updated_at", "2024-03-28 08:31:15.471298"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (2.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:31:15.487483"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 13ms (Views: 0.4ms | ActiveRecord: 2.5ms | Allocations: 1671)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.504731"], ["updated_at", "2024-03-28 08:31:15.504731"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:31:15.527112"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 14ms (Views: 1.7ms | ActiveRecord: 0.4ms | Allocations: 1617)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.538015"], ["updated_at", "2024-03-28 08:31:15.538015"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 661)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.551771"], ["updated_at", "2024-03-28 08:31:15.551771"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.562356"], ["updated_at", "2024-03-28 08:31:15.562356"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.3ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 2ms (Views: 0.9ms | ActiveRecord: 0.3ms | Allocations: 345)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:15.577396"], ["updated_at", "2024-03-28 08:31:15.577396"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 3ms (Views: 1.0ms | ActiveRecord: 0.2ms | Allocations: 505)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:15.589818"], ["updated_at", "2024-03-28 08:31:15.589818"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.4ms | ActiveRecord: 1.0ms | Allocations: 867)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:15.599296"], ["updated_at", "2024-03-28 08:31:15.599296"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 855)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:15.612164"], ["updated_at", "2024-03-28 08:31:15.612164"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:31:15.619040"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 912)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:15.625022"], ["updated_at", "2024-03-28 08:31:15.625022"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:31:15.629189"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 876)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:15.636766"], ["updated_at", "2024-03-28 08:31:15.636766"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 2ms (Views: 0.8ms | ActiveRecord: 0.1ms | Allocations: 367)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:15.650799"], ["updated_at", "2024-03-28 08:31:15.650799"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.4ms | Allocations: 363)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:15.661528"], ["updated_at", "2024-03-28 08:31:15.661528"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 356)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 3ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 561)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:31:15 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.686646"], ["updated_at", "2024-03-28 08:31:15.686646"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:15.688825"], ["updated_at", "2024-03-28 08:31:15.688825"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15"], ["created_at", "2024-03-28 08:31:15.695217"], ["updated_at", "2024-03-28 08:31:15.695217"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 12ms (Views: 1.2ms | ActiveRecord: 1.7ms | Allocations: 3338)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:31:15 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.705741"], ["updated_at", "2024-03-28 08:31:15.705741"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:15.710778"], ["updated_at", "2024-03-28 08:31:15.710778"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15"], ["created_at", "2024-03-28 08:31:15.713896"], ["updated_at", "2024-03-28 08:31:15.713896"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 10ms (Views: 0.6ms | ActiveRecord: 1.6ms | Allocations: 2639)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 302)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 1ms (Views: 0.6ms | ActiveRecord: 0.3ms | Allocations: 224)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.9ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:15.728070"], ["updated_at", "2024-03-28 08:31:15.728070"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.732643"], ["updated_at", "2024-03-28 08:31:15.732643"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15.733823"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15.733823"], ["created_at", "2024-03-28 08:31:15.734777"], ["updated_at", "2024-03-28 08:31:15.734777"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 1ms (Views: 0.6ms | ActiveRecord: 0.1ms | Allocations: 370)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:15.743735"], ["updated_at", "2024-03-28 08:31:15.743735"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.745547"], ["updated_at", "2024-03-28 08:31:15.745547"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:31:15 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15"], ["created_at", "2024-03-28 08:31:15.752672"], ["updated_at", "2024-03-28 08:31:15.752672"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 1249)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:15.758921"], ["updated_at", "2024-03-28 08:31:15.758921"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.760814"], ["updated_at", "2024-03-28 08:31:15.760814"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:31:15 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.5ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15"], ["created_at", "2024-03-28 08:31:15.767886"], ["updated_at", "2024-03-28 08:31:15.767886"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 1249)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:31:15 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 2ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 1009)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:15.782132"], ["updated_at", "2024-03-28 08:31:15.782132"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.785248"], ["updated_at", "2024-03-28 08:31:15.785248"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15.786748"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15.786748"], ["created_at", "2024-03-28 08:31:15.788170"], ["updated_at", "2024-03-28 08:31:15.788170"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:31:15 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:31:15"], ["updated_at", "2024-03-28 08:31:15.794436"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 1328)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:15.800990"], ["updated_at", "2024-03-28 08:31:15.800990"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.803240"], ["updated_at", "2024-03-28 08:31:15.803240"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15.804924"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15.804924"], ["created_at", "2024-03-28 08:31:15.808369"], ["updated_at", "2024-03-28 08:31:15.808369"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:31:15 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.0ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.1ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:31:15"], ["updated_at", "2024-03-28 08:31:15.813553"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 1328)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:15.817215"], ["updated_at", "2024-03-28 08:31:15.817215"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.819265"], ["updated_at", "2024-03-28 08:31:15.819265"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15.821097"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15.821097"], ["created_at", "2024-03-28 08:31:15.823396"], ["updated_at", "2024-03-28 08:31:15.823396"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:31:15 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 5ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 1103)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:15.835336"], ["updated_at", "2024-03-28 08:31:15.835336"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.840487"], ["updated_at", "2024-03-28 08:31:15.840487"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15.845195"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15.845195"], ["created_at", "2024-03-28 08:31:15.846992"], ["updated_at", "2024-03-28 08:31:15.846992"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.5ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (1.3ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 10ms (ActiveRecord: 2.0ms | Allocations: 357)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (2.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:15.863097"], ["updated_at", "2024-03-28 08:31:15.863097"]]
  [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.869069"], ["updated_at", "2024-03-28 08:31:15.869069"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15.877989"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:15.877989"], ["created_at", "2024-03-28 08:31:15.887635"], ["updated_at", "2024-03-28 08:31:15.887635"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.5ms | Allocations: 357)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.4ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 6ms (Views: 4.9ms | ActiveRecord: 0.4ms | Allocations: 222)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.909375"], ["updated_at", "2024-03-28 08:31:15.909375"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 1ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 379)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 472)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 472)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 2ms (Views: 0.8ms | ActiveRecord: 0.0ms | Allocations: 574)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.937232"], ["updated_at", "2024-03-28 08:31:15.937232"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:31:15.941477"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.6ms | ActiveRecord: 1.0ms | Allocations: 1617)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.947904"], ["updated_at", "2024-03-28 08:31:15.947904"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.6ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:31:15.953955"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.4ms | ActiveRecord: 0.9ms | Allocations: 1617)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.959039"], ["updated_at", "2024-03-28 08:31:15.959039"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 2ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 661)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.974173"], ["updated_at", "2024-03-28 08:31:15.974173"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:15.992533"], ["updated_at", "2024-03-28 08:31:15.992533"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 5ms (Views: 4.6ms | ActiveRecord: 0.2ms | Allocations: 222)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:16.015355"], ["updated_at", "2024-03-28 08:31:16.015355"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 364)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:16.032253"], ["updated_at", "2024-03-28 08:31:16.032253"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.6ms | ActiveRecord: 0.8ms | Allocations: 855)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:16.044205"], ["updated_at", "2024-03-28 08:31:16.044205"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 7ms (Views: 0.4ms | ActiveRecord: 1.3ms | Allocations: 855)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:16.056663"], ["updated_at", "2024-03-28 08:31:16.056663"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:31:16.064906"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 1.4ms | ActiveRecord: 0.3ms | Allocations: 876)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (2.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:16.071753"], ["updated_at", "2024-03-28 08:31:16.071753"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:31:16.080137"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 1.4ms | ActiveRecord: 0.3ms | Allocations: 876)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:16.086247"], ["updated_at", "2024-03-28 08:31:16.086247"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 5ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 367)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:16.098673"], ["updated_at", "2024-03-28 08:31:16.098673"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (1.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 1.5ms | Allocations: 356)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:16.112026"], ["updated_at", "2024-03-28 08:31:16.112026"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 356)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (3.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:31:16 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 16:31:16 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:31:16.166593"], ["updated_at", "2024-03-28 08:31:16.166593"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:31:16.169531"], ["updated_at", "2024-03-28 08:31:16.169531"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:31:16"], ["created_at", "2024-03-28 08:31:16.173194"], ["updated_at", "2024-03-28 08:31:16.173194"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 19ms (Views: 0.9ms | ActiveRecord: 2.0ms | Allocations: 2924)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:31:16 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 317)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:43:45 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:43:45.972833"], ["updated_at", "2024-03-28 08:43:45.972833"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:43:46.006935"], ["updated_at", "2024-03-28 08:43:46.006935"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:43:45"], ["created_at", "2024-03-28 08:43:46.026536"], ["updated_at", "2024-03-28 08:43:46.026536"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 65ms (Views: 0.7ms | ActiveRecord: 2.5ms | Allocations: 16860)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:43:46 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:43:46.036813"], ["updated_at", "2024-03-28 08:43:46.036813"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:43:46.038874"], ["updated_at", "2024-03-28 08:43:46.038874"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:43:46"], ["created_at", "2024-03-28 08:43:46.042742"], ["updated_at", "2024-03-28 08:43:46.042742"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 9ms (Views: 1.3ms | ActiveRecord: 1.4ms | Allocations: 2639)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 303)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 1ms (Views: 0.6ms | ActiveRecord: 0.2ms | Allocations: 323)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:43:46.061505"], ["updated_at", "2024-03-28 08:43:46.061505"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:43:46.063934"], ["updated_at", "2024-03-28 08:43:46.063934"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:43:46.067091"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:43:46.067091"], ["created_at", "2024-03-28 08:43:46.069575"], ["updated_at", "2024-03-28 08:43:46.069575"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.6ms | ActiveRecord: 0.2ms | Allocations: 553)
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:43:46.079346"], ["updated_at", "2024-03-28 08:43:46.079346"]]
  [1m[35m (1.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:43:46.082805"], ["updated_at", "2024-03-28 08:43:46.082805"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:43:46 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:43:46"], ["created_at", "2024-03-28 08:43:46.090525"], ["updated_at", "2024-03-28 08:43:46.090525"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 7ms (Views: 0.7ms | ActiveRecord: 0.7ms | Allocations: 1541)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:43:46.097667"], ["updated_at", "2024-03-28 08:43:46.097667"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:43:46.100074"], ["updated_at", "2024-03-28 08:43:46.100074"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:43:46 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:43:46"], ["created_at", "2024-03-28 08:43:46.107043"], ["updated_at", "2024-03-28 08:43:46.107043"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 1249)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:43:46 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 6ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 2014)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:43:46.125455"], ["updated_at", "2024-03-28 08:43:46.125455"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:43:46.129467"], ["updated_at", "2024-03-28 08:43:46.129467"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:43:46.131073"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:43:46.131073"], ["created_at", "2024-03-28 08:43:46.132219"], ["updated_at", "2024-03-28 08:43:46.132219"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:43:46 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.3ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:43:46"], ["updated_at", "2024-03-28 08:43:46.140617"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 1.0ms | Allocations: 1486)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:43:46.147743"], ["updated_at", "2024-03-28 08:43:46.147743"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:43:46.149845"], ["updated_at", "2024-03-28 08:43:46.149845"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:43:46.151737"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:43:46.151737"], ["created_at", "2024-03-28 08:43:46.153951"], ["updated_at", "2024-03-28 08:43:46.153951"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:43:46 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.0ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.1ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:43:46"], ["updated_at", "2024-03-28 08:43:46.159112"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 1328)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:43:46.163703"], ["updated_at", "2024-03-28 08:43:46.163703"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:43:46.165625"], ["updated_at", "2024-03-28 08:43:46.165625"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:43:46.166870"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:43:46.166870"], ["created_at", "2024-03-28 08:43:46.168928"], ["updated_at", "2024-03-28 08:43:46.168928"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:43:46 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 3ms (Views: 0.2ms | ActiveRecord: 0.4ms | Allocations: 1108)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:43:46.180599"], ["updated_at", "2024-03-28 08:43:46.180599"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:43:46.182584"], ["updated_at", "2024-03-28 08:43:46.182584"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:43:46.184052"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:43:46.184052"], ["created_at", "2024-03-28 08:43:46.184949"], ["updated_at", "2024-03-28 08:43:46.184949"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:43:46.193059"], ["updated_at", "2024-03-28 08:43:46.193059"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:43:46.195539"], ["updated_at", "2024-03-28 08:43:46.195539"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:43:46.197123"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:43:46.197123"], ["created_at", "2024-03-28 08:43:46.198228"], ["updated_at", "2024-03-28 08:43:46.198228"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 357)
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.3ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.3ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:43:46.212977"], ["updated_at", "2024-03-28 08:43:46.212977"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 7ms (Views: 0.8ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 3ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 475)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (3.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 6ms (Views: 2.5ms | ActiveRecord: 0.0ms | Allocations: 473)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 6ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 594)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:43:46.320154"], ["updated_at", "2024-03-28 08:43:46.320154"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (2.3ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.4ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:43:46.333344"], ["id", 1]]
  [1m[35m (1.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.4ms | ActiveRecord: 4.1ms | Allocations: 1658)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (1.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:43:46.345720"], ["updated_at", "2024-03-28 08:43:46.345720"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:43:46.351973"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 1617)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:43:46.358745"], ["updated_at", "2024-03-28 08:43:46.358745"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 661)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:43:46.371623"], ["updated_at", "2024-03-28 08:43:46.371623"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:43:46.382588"], ["updated_at", "2024-03-28 08:43:46.382588"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 1ms (Views: 0.6ms | ActiveRecord: 0.1ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:43:46.402319"], ["updated_at", "2024-03-28 08:43:46.402319"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 3ms (Views: 0.6ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:43:46.417594"], ["updated_at", "2024-03-28 08:43:46.417594"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.4ms | ActiveRecord: 0.8ms | Allocations: 857)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.0ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:43:46.429362"], ["updated_at", "2024-03-28 08:43:46.429362"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.4ms | ActiveRecord: 1.2ms | Allocations: 855)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:43:46.444346"], ["updated_at", "2024-03-28 08:43:46.444346"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:43:46.449251"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.3ms | ActiveRecord: 0.3ms | Allocations: 912)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:43:46.456546"], ["updated_at", "2024-03-28 08:43:46.456546"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:43:46.464299"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 876)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:43:46.470644"], ["updated_at", "2024-03-28 08:43:46.470644"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 367)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:43:46.480202"], ["updated_at", "2024-03-28 08:43:46.480202"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:43:46.490842"], ["updated_at", "2024-03-28 08:43:46.490842"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 356)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:43:46 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 16:43:46 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:43:46.566133"], ["updated_at", "2024-03-28 08:43:46.566133"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:43:46.569157"], ["updated_at", "2024-03-28 08:43:46.569157"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:43:46"], ["created_at", "2024-03-28 08:43:46.572367"], ["updated_at", "2024-03-28 08:43:46.572367"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 22ms (Views: 1.1ms | ActiveRecord: 1.6ms | Allocations: 2924)
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:43:46 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 317)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:44:11 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:44:11.385141"], ["updated_at", "2024-03-28 08:44:11.385141"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:44:11.418504"], ["updated_at", "2024-03-28 08:44:11.418504"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:44:11"], ["created_at", "2024-03-28 08:44:11.439916"], ["updated_at", "2024-03-28 08:44:11.439916"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 67ms (Views: 0.7ms | ActiveRecord: 2.3ms | Allocations: 16860)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:44:11 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:44:11.450536"], ["updated_at", "2024-03-28 08:44:11.450536"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:44:11.452214"], ["updated_at", "2024-03-28 08:44:11.452214"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:44:11"], ["created_at", "2024-03-28 08:44:11.456302"], ["updated_at", "2024-03-28 08:44:11.456302"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 11ms (Views: 1.8ms | ActiveRecord: 1.7ms | Allocations: 2639)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 303)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 323)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:44:11.474070"], ["updated_at", "2024-03-28 08:44:11.474070"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:44:11.475817"], ["updated_at", "2024-03-28 08:44:11.475817"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:44:11.476784"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.5ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:44:11.476784"], ["created_at", "2024-03-28 08:44:11.480959"], ["updated_at", "2024-03-28 08:44:11.480959"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.7ms | ActiveRecord: 0.2ms | Allocations: 553)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:44:11.490981"], ["updated_at", "2024-03-28 08:44:11.490981"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:44:11.493144"], ["updated_at", "2024-03-28 08:44:11.493144"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:44:11 +0800", "tour_id"=>"1"}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:44:11"], ["created_at", "2024-03-28 08:44:11.501956"], ["updated_at", "2024-03-28 08:44:11.501956"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 8ms (Views: 1.2ms | ActiveRecord: 0.9ms | Allocations: 1541)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:44:11.507643"], ["updated_at", "2024-03-28 08:44:11.507643"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:44:11.509274"], ["updated_at", "2024-03-28 08:44:11.509274"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:44:11 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:44:11"], ["created_at", "2024-03-28 08:44:11.516033"], ["updated_at", "2024-03-28 08:44:11.516033"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 8ms (Views: 0.6ms | ActiveRecord: 0.9ms | Allocations: 1249)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:44:11 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 6ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 2014)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:44:11.533941"], ["updated_at", "2024-03-28 08:44:11.533941"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:44:11.536153"], ["updated_at", "2024-03-28 08:44:11.536153"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (1.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:44:11.537202"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:44:11.537202"], ["created_at", "2024-03-28 08:44:11.540536"], ["updated_at", "2024-03-28 08:44:11.540536"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:44:11 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.6ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:44:11"], ["updated_at", "2024-03-28 08:44:11.547551"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 1.1ms | Allocations: 1486)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:44:11.555221"], ["updated_at", "2024-03-28 08:44:11.555221"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:44:11.557169"], ["updated_at", "2024-03-28 08:44:11.557169"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:44:11.558530"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:44:11.558530"], ["created_at", "2024-03-28 08:44:11.559751"], ["updated_at", "2024-03-28 08:44:11.559751"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:44:11 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.1ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:44:11"], ["updated_at", "2024-03-28 08:44:11.567909"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 0.7ms | Allocations: 1328)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:44:11.572947"], ["updated_at", "2024-03-28 08:44:11.572947"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:44:11.575227"], ["updated_at", "2024-03-28 08:44:11.575227"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:44:11.576247"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:44:11.576247"], ["created_at", "2024-03-28 08:44:11.577590"], ["updated_at", "2024-03-28 08:44:11.577590"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:44:11 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 4ms (Views: 0.2ms | ActiveRecord: 0.4ms | Allocations: 1108)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:44:11.590776"], ["updated_at", "2024-03-28 08:44:11.590776"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:44:11.592794"], ["updated_at", "2024-03-28 08:44:11.592794"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:44:11.594657"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:44:11.594657"], ["created_at", "2024-03-28 08:44:11.601547"], ["updated_at", "2024-03-28 08:44:11.601547"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:44:11.609111"], ["updated_at", "2024-03-28 08:44:11.609111"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:44:11.610803"], ["updated_at", "2024-03-28 08:44:11.610803"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:44:11.613718"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:44:11.613718"], ["created_at", "2024-03-28 08:44:11.618502"], ["updated_at", "2024-03-28 08:44:11.618502"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 357)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.3ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 1ms (Views: 0.6ms | ActiveRecord: 0.3ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.0ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:44:11.634811"], ["updated_at", "2024-03-28 08:44:11.634811"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 3ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 475)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 7ms (Views: 2.7ms | ActiveRecord: 0.0ms | Allocations: 473)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 7ms (Views: 0.4ms | ActiveRecord: 0.0ms | Allocations: 594)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:44:11.743198"], ["updated_at", "2024-03-28 08:44:11.743198"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:44:11.759477"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 1658)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (2.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:44:11.767593"], ["updated_at", "2024-03-28 08:44:11.767593"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:44:11.774333"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 1617)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:44:11.781606"], ["updated_at", "2024-03-28 08:44:11.781606"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 2ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 661)
  [1m[35m (2.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:44:11.793382"], ["updated_at", "2024-03-28 08:44:11.793382"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 1.1ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:44:11.807000"], ["updated_at", "2024-03-28 08:44:11.807000"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.5ms | Allocations: 356)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 280)
  [1m[35m (2.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:44:11.826360"], ["updated_at", "2024-03-28 08:44:11.826360"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.7ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:44:11.843119"], ["updated_at", "2024-03-28 08:44:11.843119"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 3ms (Views: 0.6ms | ActiveRecord: 0.7ms | Allocations: 857)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (2.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:44:11.854466"], ["updated_at", "2024-03-28 08:44:11.854466"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 7ms (Views: 0.4ms | ActiveRecord: 2.5ms | Allocations: 855)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 280)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:44:11.870897"], ["updated_at", "2024-03-28 08:44:11.870897"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:44:11.877452"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.7ms | ActiveRecord: 0.5ms | Allocations: 912)
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:44:11.887182"], ["updated_at", "2024-03-28 08:44:11.887182"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:44:11.893525"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 876)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:44:11.901092"], ["updated_at", "2024-03-28 08:44:11.901092"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 367)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.9ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:44:11.913786"], ["updated_at", "2024-03-28 08:44:11.913786"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (1.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:44:11.925709"], ["updated_at", "2024-03-28 08:44:11.925709"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (1.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (1.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:44:11 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 16:44:11 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:44:11.977692"], ["updated_at", "2024-03-28 08:44:11.977692"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:44:11.980198"], ["updated_at", "2024-03-28 08:44:11.980198"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:44:11"], ["created_at", "2024-03-28 08:44:11.985453"], ["updated_at", "2024-03-28 08:44:11.985453"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 19ms (Views: 0.8ms | ActiveRecord: 1.7ms | Allocations: 2924)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:44:11 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 317)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:45:32 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:45:32.106669"], ["updated_at", "2024-03-28 08:45:32.106669"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:45:32.139517"], ["updated_at", "2024-03-28 08:45:32.139517"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:45:32"], ["created_at", "2024-03-28 08:45:32.158223"], ["updated_at", "2024-03-28 08:45:32.158223"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 63ms (Views: 0.9ms | ActiveRecord: 2.4ms | Allocations: 16861)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:45:32 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:45:32.167279"], ["updated_at", "2024-03-28 08:45:32.167279"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:45:32.168998"], ["updated_at", "2024-03-28 08:45:32.168998"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:45:32"], ["created_at", "2024-03-28 08:45:32.173075"], ["updated_at", "2024-03-28 08:45:32.173075"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 11ms (Views: 1.8ms | ActiveRecord: 1.5ms | Allocations: 2639)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
Completed 422 Unprocessable Entity in 0ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 303)
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 1ms (Views: 0.6ms | ActiveRecord: 0.2ms | Allocations: 323)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:45:32.189519"], ["updated_at", "2024-03-28 08:45:32.189519"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:45:32.191652"], ["updated_at", "2024-03-28 08:45:32.191652"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:45:32.192867"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:45:32.192867"], ["created_at", "2024-03-28 08:45:32.196459"], ["updated_at", "2024-03-28 08:45:32.196459"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 553)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:45:32.205253"], ["updated_at", "2024-03-28 08:45:32.205253"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:45:32.207622"], ["updated_at", "2024-03-28 08:45:32.207622"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:45:32 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:45:32"], ["created_at", "2024-03-28 08:45:32.215667"], ["updated_at", "2024-03-28 08:45:32.215667"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 8ms (Views: 2.1ms | ActiveRecord: 0.7ms | Allocations: 1541)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:45:32.222899"], ["updated_at", "2024-03-28 08:45:32.222899"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:45:32.224721"], ["updated_at", "2024-03-28 08:45:32.224721"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:45:32 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:45:32"], ["created_at", "2024-03-28 08:45:32.232969"], ["updated_at", "2024-03-28 08:45:32.232969"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 1249)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:45:32 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 6ms (Views: 0.5ms | ActiveRecord: 0.0ms | Allocations: 2014)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:45:32.249319"], ["updated_at", "2024-03-28 08:45:32.249319"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:45:32.251441"], ["updated_at", "2024-03-28 08:45:32.251441"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:45:32.253489"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:45:32.253489"], ["created_at", "2024-03-28 08:45:32.255210"], ["updated_at", "2024-03-28 08:45:32.255210"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:45:32 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:45:32"], ["updated_at", "2024-03-28 08:45:32.261260"], ["id", 1]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 1.0ms | Allocations: 1486)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:45:32.269825"], ["updated_at", "2024-03-28 08:45:32.269825"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:45:32.271438"], ["updated_at", "2024-03-28 08:45:32.271438"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:45:32.272411"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:45:32.272411"], ["created_at", "2024-03-28 08:45:32.273857"], ["updated_at", "2024-03-28 08:45:32.273857"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:45:32 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:45:32"], ["updated_at", "2024-03-28 08:45:32.284031"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.3ms | ActiveRecord: 0.6ms | Allocations: 1328)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:45:32.288517"], ["updated_at", "2024-03-28 08:45:32.288517"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:45:32.290447"], ["updated_at", "2024-03-28 08:45:32.290447"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:45:32.291594"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (1.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:45:32.291594"], ["created_at", "2024-03-28 08:45:32.292889"], ["updated_at", "2024-03-28 08:45:32.292889"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:45:32 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 2ms (Views: 0.2ms | ActiveRecord: 0.2ms | Allocations: 1108)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:45:32.307183"], ["updated_at", "2024-03-28 08:45:32.307183"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (4.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:45:32.309353"], ["updated_at", "2024-03-28 08:45:32.309353"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:45:32.316590"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:45:32.316590"], ["created_at", "2024-03-28 08:45:32.317878"], ["updated_at", "2024-03-28 08:45:32.317878"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.2ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:45:32.324201"], ["updated_at", "2024-03-28 08:45:32.324201"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:45:32.326285"], ["updated_at", "2024-03-28 08:45:32.326285"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:45:32.332020"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:45:32.332020"], ["created_at", "2024-03-28 08:45:32.334559"], ["updated_at", "2024-03-28 08:45:32.334559"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.2ms | Allocations: 357)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 1ms (Views: 0.6ms | ActiveRecord: 0.2ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:45:32.351432"], ["updated_at", "2024-03-28 08:45:32.351432"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 5ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (1.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 4ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 475)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 6ms (Views: 0.4ms | ActiveRecord: 0.0ms | Allocations: 473)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 7ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 594)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:45:32.457239"], ["updated_at", "2024-03-28 08:45:32.457239"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:45:32.471201"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 0.3ms | Allocations: 1658)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:45:32.480451"], ["updated_at", "2024-03-28 08:45:32.480451"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:45:32.489759"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 1617)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:45:32.496358"], ["updated_at", "2024-03-28 08:45:32.496358"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 2ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 661)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:45:32.507112"], ["updated_at", "2024-03-28 08:45:32.507112"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 0.6ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:45:32.519548"], ["updated_at", "2024-03-28 08:45:32.519548"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 356)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 1ms (Views: 0.8ms | ActiveRecord: 0.2ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:45:32.536905"], ["updated_at", "2024-03-28 08:45:32.536905"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:45:32.550085"], ["updated_at", "2024-03-28 08:45:32.550085"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.7ms | ActiveRecord: 0.7ms | Allocations: 857)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:45:32.561220"], ["updated_at", "2024-03-28 08:45:32.561220"]]
  [1m[35m (1.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.7ms | ActiveRecord: 1.7ms | Allocations: 855)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:45:32.575212"], ["updated_at", "2024-03-28 08:45:32.575212"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:45:32.581585"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 912)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:45:32.589227"], ["updated_at", "2024-03-28 08:45:32.589227"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:45:32.593363"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.8ms | ActiveRecord: 0.5ms | Allocations: 876)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (2.0ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:45:32.600706"], ["updated_at", "2024-03-28 08:45:32.600706"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 367)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:45:32.611672"], ["updated_at", "2024-03-28 08:45:32.611672"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 5ms (ActiveRecord: 0.5ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:45:32.624668"], ["updated_at", "2024-03-28 08:45:32.624668"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:45:32 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 16:45:32 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:45:32.675324"], ["updated_at", "2024-03-28 08:45:32.675324"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:45:32.678406"], ["updated_at", "2024-03-28 08:45:32.678406"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:45:32"], ["created_at", "2024-03-28 08:45:32.680950"], ["updated_at", "2024-03-28 08:45:32.680950"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 15ms (Views: 0.6ms | ActiveRecord: 1.5ms | Allocations: 2924)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:45:32 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
Completed 422 Unprocessable Entity in 3ms (Views: 1.2ms | ActiveRecord: 0.0ms | Allocations: 317)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (1.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.5ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 11ms (Views: 0.6ms | ActiveRecord: 0.9ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:49:50 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:49:50.541434"], ["updated_at", "2024-03-28 08:49:50.541434"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:49:50.575481"], ["updated_at", "2024-03-28 08:49:50.575481"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:49:50"], ["created_at", "2024-03-28 08:49:50.598608"], ["updated_at", "2024-03-28 08:49:50.598608"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 67ms (Views: 0.9ms | ActiveRecord: 2.4ms | Allocations: 16860)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:49:50 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:49:50.607943"], ["updated_at", "2024-03-28 08:49:50.607943"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:49:50.609985"], ["updated_at", "2024-03-28 08:49:50.609985"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:49:50"], ["created_at", "2024-03-28 08:49:50.613761"], ["updated_at", "2024-03-28 08:49:50.613761"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 11ms (Views: 1.7ms | ActiveRecord: 1.6ms | Allocations: 2639)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 303)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (1.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 1.0ms | Allocations: 323)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:49:50.631260"], ["updated_at", "2024-03-28 08:49:50.631260"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:49:50.632921"], ["updated_at", "2024-03-28 08:49:50.632921"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.3ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:49:50.634161"], ["LIMIT", 1]]
  [1m[35m (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:49:50.634161"], ["created_at", "2024-03-28 08:49:50.636041"], ["updated_at", "2024-03-28 08:49:50.636041"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 553)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:49:50.645861"], ["updated_at", "2024-03-28 08:49:50.645861"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:49:50.648664"], ["updated_at", "2024-03-28 08:49:50.648664"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:49:50 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:49:50"], ["created_at", "2024-03-28 08:49:50.655425"], ["updated_at", "2024-03-28 08:49:50.655425"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.5ms | ActiveRecord: 0.7ms | Allocations: 1541)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:49:50.661029"], ["updated_at", "2024-03-28 08:49:50.661029"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:49:50.665193"], ["updated_at", "2024-03-28 08:49:50.665193"]]
  [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:49:50 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.5ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:49:50"], ["created_at", "2024-03-28 08:49:50.671583"], ["updated_at", "2024-03-28 08:49:50.671583"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.4ms | ActiveRecord: 0.8ms | Allocations: 1249)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:49:50 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 9ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 2014)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:49:50.693189"], ["updated_at", "2024-03-28 08:49:50.693189"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:49:50.695072"], ["updated_at", "2024-03-28 08:49:50.695072"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:49:50.700033"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:49:50.700033"], ["created_at", "2024-03-28 08:49:50.701295"], ["updated_at", "2024-03-28 08:49:50.701295"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:49:50 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:49:50"], ["updated_at", "2024-03-28 08:49:50.707510"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 1486)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:49:50.715241"], ["updated_at", "2024-03-28 08:49:50.715241"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:49:50.717457"], ["updated_at", "2024-03-28 08:49:50.717457"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:49:50.719560"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:49:50.719560"], ["created_at", "2024-03-28 08:49:50.721321"], ["updated_at", "2024-03-28 08:49:50.721321"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:49:50 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.1ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:49:50"], ["updated_at", "2024-03-28 08:49:50.727752"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 1328)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:49:50.733382"], ["updated_at", "2024-03-28 08:49:50.733382"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:49:50.735689"], ["updated_at", "2024-03-28 08:49:50.735689"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:49:50.736882"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.6ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:49:50.736882"], ["created_at", "2024-03-28 08:49:50.739539"], ["updated_at", "2024-03-28 08:49:50.739539"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:49:50 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 4ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 1108)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:49:50.751953"], ["updated_at", "2024-03-28 08:49:50.751953"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:49:50.753995"], ["updated_at", "2024-03-28 08:49:50.753995"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:49:50.756365"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:49:50.756365"], ["created_at", "2024-03-28 08:49:50.757920"], ["updated_at", "2024-03-28 08:49:50.757920"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.5ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:49:50.767319"], ["updated_at", "2024-03-28 08:49:50.767319"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:49:50.769535"], ["updated_at", "2024-03-28 08:49:50.769535"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:49:50.770695"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:49:50.770695"], ["created_at", "2024-03-28 08:49:50.772841"], ["updated_at", "2024-03-28 08:49:50.772841"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 0.3ms | Allocations: 357)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.3ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 4ms (Views: 0.7ms | ActiveRecord: 0.3ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.0ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:49:50.803004"], ["updated_at", "2024-03-28 08:49:50.803004"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (2.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 7ms (Views: 3.3ms | ActiveRecord: 2.1ms | Allocations: 496)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 4ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 475)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 4ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 473)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 596)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:49:50.899206"], ["updated_at", "2024-03-28 08:49:50.899206"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:49:50.907380"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 1656)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:49:50.914672"], ["updated_at", "2024-03-28 08:49:50.914672"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:49:50.920031"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 1617)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:49:50.925663"], ["updated_at", "2024-03-28 08:49:50.925663"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 4ms (Views: 0.2ms | ActiveRecord: 0.2ms | Allocations: 661)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.9ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:49:50.936801"], ["updated_at", "2024-03-28 08:49:50.936801"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:49:50.946355"], ["updated_at", "2024-03-28 08:49:50.946355"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 356)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 1ms (Views: 0.7ms | ActiveRecord: 0.2ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:49:50.964713"], ["updated_at", "2024-03-28 08:49:50.964713"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:49:50.976632"], ["updated_at", "2024-03-28 08:49:50.976632"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 1.4ms | ActiveRecord: 0.7ms | Allocations: 857)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:49:50.986960"], ["updated_at", "2024-03-28 08:49:50.986960"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 1.3ms | ActiveRecord: 0.9ms | Allocations: 855)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:49:51.000755"], ["updated_at", "2024-03-28 08:49:51.000755"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:49:51.005829"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 912)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:49:51.011467"], ["updated_at", "2024-03-28 08:49:51.011467"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:49:51.018001"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.7ms | ActiveRecord: 0.5ms | Allocations: 876)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:49:51.024075"], ["updated_at", "2024-03-28 08:49:51.024075"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 3ms (Views: 1.3ms | ActiveRecord: 0.1ms | Allocations: 367)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:49:51.034360"], ["updated_at", "2024-03-28 08:49:51.034360"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 363)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:49:51.043758"], ["updated_at", "2024-03-28 08:49:51.043758"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (1.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 1.4ms | Allocations: 356)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:49:51 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 16:49:51 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:49:51.095947"], ["updated_at", "2024-03-28 08:49:51.095947"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:49:51.097796"], ["updated_at", "2024-03-28 08:49:51.097796"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:49:51"], ["created_at", "2024-03-28 08:49:51.100266"], ["updated_at", "2024-03-28 08:49:51.100266"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 16ms (Views: 0.7ms | ActiveRecord: 1.3ms | Allocations: 2924)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:49:51 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
Completed 422 Unprocessable Entity in 2ms (Views: 0.4ms | ActiveRecord: 0.0ms | Allocations: 317)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:51:02 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:51:02.561125"], ["updated_at", "2024-03-28 08:51:02.561125"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:51:02.598139"], ["updated_at", "2024-03-28 08:51:02.598139"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:51:02"], ["created_at", "2024-03-28 08:51:02.617297"], ["updated_at", "2024-03-28 08:51:02.617297"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 68ms (Views: 0.7ms | ActiveRecord: 2.9ms | Allocations: 16861)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:51:02 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:51:02.626451"], ["updated_at", "2024-03-28 08:51:02.626451"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:51:02.628568"], ["updated_at", "2024-03-28 08:51:02.628568"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:51:02"], ["created_at", "2024-03-28 08:51:02.633199"], ["updated_at", "2024-03-28 08:51:02.633199"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 11ms (Views: 1.1ms | ActiveRecord: 1.6ms | Allocations: 2639)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
Completed 422 Unprocessable Entity in 0ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 303)
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 2ms (Views: 1.9ms | ActiveRecord: 0.2ms | Allocations: 323)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:51:02.648794"], ["updated_at", "2024-03-28 08:51:02.648794"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:51:02.651460"], ["updated_at", "2024-03-28 08:51:02.651460"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:51:02.652928"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.6ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:51:02.652928"], ["created_at", "2024-03-28 08:51:02.655018"], ["updated_at", "2024-03-28 08:51:02.655018"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 1.2ms | ActiveRecord: 0.1ms | Allocations: 553)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:51:02.664885"], ["updated_at", "2024-03-28 08:51:02.664885"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:51:02.667284"], ["updated_at", "2024-03-28 08:51:02.667284"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:51:02 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:51:02"], ["created_at", "2024-03-28 08:51:02.675252"], ["updated_at", "2024-03-28 08:51:02.675252"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 7ms (Views: 0.6ms | ActiveRecord: 0.9ms | Allocations: 1541)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:51:02.681396"], ["updated_at", "2024-03-28 08:51:02.681396"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:51:02.684530"], ["updated_at", "2024-03-28 08:51:02.684530"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:51:02 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:51:02"], ["created_at", "2024-03-28 08:51:02.691439"], ["updated_at", "2024-03-28 08:51:02.691439"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.3ms | ActiveRecord: 0.7ms | Allocations: 1249)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:51:02 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 7ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 2014)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:51:02.707144"], ["updated_at", "2024-03-28 08:51:02.707144"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:51:02.709940"], ["updated_at", "2024-03-28 08:51:02.709940"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:51:02.711606"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:51:02.711606"], ["created_at", "2024-03-28 08:51:02.712650"], ["updated_at", "2024-03-28 08:51:02.712650"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:51:02 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:51:02"], ["updated_at", "2024-03-28 08:51:02.718982"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 1486)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:51:02.726744"], ["updated_at", "2024-03-28 08:51:02.726744"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:51:02.728467"], ["updated_at", "2024-03-28 08:51:02.728467"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:51:02.729383"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:51:02.729383"], ["created_at", "2024-03-28 08:51:02.730320"], ["updated_at", "2024-03-28 08:51:02.730320"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:51:02 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.1ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:51:02"], ["updated_at", "2024-03-28 08:51:02.738283"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 0.7ms | Allocations: 1328)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:51:02.742654"], ["updated_at", "2024-03-28 08:51:02.742654"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:51:02.745074"], ["updated_at", "2024-03-28 08:51:02.745074"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:51:02.746084"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:51:02.746084"], ["created_at", "2024-03-28 08:51:02.748256"], ["updated_at", "2024-03-28 08:51:02.748256"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:51:02 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 3ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 1108)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:51:02.760291"], ["updated_at", "2024-03-28 08:51:02.760291"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:51:02.761866"], ["updated_at", "2024-03-28 08:51:02.761866"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:51:02.762768"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:51:02.762768"], ["created_at", "2024-03-28 08:51:02.763712"], ["updated_at", "2024-03-28 08:51:02.763712"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 0.7ms | Allocations: 426)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:51:02.775756"], ["updated_at", "2024-03-28 08:51:02.775756"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:51:02.777604"], ["updated_at", "2024-03-28 08:51:02.777604"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:51:02.778529"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:51:02.778529"], ["created_at", "2024-03-28 08:51:02.779438"], ["updated_at", "2024-03-28 08:51:02.779438"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (3.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 5ms (ActiveRecord: 3.8ms | Allocations: 357)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.3ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 5ms (Views: 0.8ms | ActiveRecord: 0.3ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:51:02.807505"], ["updated_at", "2024-03-28 08:51:02.807505"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 5ms (Views: 4.2ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 6ms (Views: 2.6ms | ActiveRecord: 0.0ms | Allocations: 475)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 3ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 473)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 2ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 596)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:51:02.907549"], ["updated_at", "2024-03-28 08:51:02.907549"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.2ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:51:02.914934"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.5ms | ActiveRecord: 0.4ms | Allocations: 1656)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:51:02.925073"], ["updated_at", "2024-03-28 08:51:02.925073"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:51:02.931139"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.5ms | ActiveRecord: 0.5ms | Allocations: 1617)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:51:02.936891"], ["updated_at", "2024-03-28 08:51:02.936891"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 2ms (Views: 0.2ms | ActiveRecord: 0.2ms | Allocations: 661)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:51:02.948003"], ["updated_at", "2024-03-28 08:51:02.948003"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.3ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 5ms (ActiveRecord: 0.5ms | Allocations: 363)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:51:02.961584"], ["updated_at", "2024-03-28 08:51:02.961584"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 356)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 3ms (Views: 2.3ms | ActiveRecord: 0.2ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:51:02.979498"], ["updated_at", "2024-03-28 08:51:02.979498"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 1.0ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.9ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:51:02.994653"], ["updated_at", "2024-03-28 08:51:02.994653"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 3ms (Views: 0.4ms | ActiveRecord: 1.0ms | Allocations: 857)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:51:03.002612"], ["updated_at", "2024-03-28 08:51:03.002612"]]
  [1m[35m (1.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 8ms (Views: 0.4ms | ActiveRecord: 1.8ms | Allocations: 855)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:51:03.020954"], ["updated_at", "2024-03-28 08:51:03.020954"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:51:03.025745"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.3ms | ActiveRecord: 0.3ms | Allocations: 912)
  [1m[36mTour Load (0.0ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:51:03.030386"], ["updated_at", "2024-03-28 08:51:03.030386"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.3ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:51:03.034825"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 876)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:51:03.042047"], ["updated_at", "2024-03-28 08:51:03.042047"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 367)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:51:03.049429"], ["updated_at", "2024-03-28 08:51:03.049429"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.8ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:51:03.061635"], ["updated_at", "2024-03-28 08:51:03.061635"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.6ms | Allocations: 356)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:51:03 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 16:51:03 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:51:03.110988"], ["updated_at", "2024-03-28 08:51:03.110988"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:51:03.113067"], ["updated_at", "2024-03-28 08:51:03.113067"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:51:03"], ["created_at", "2024-03-28 08:51:03.116084"], ["updated_at", "2024-03-28 08:51:03.116084"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 17ms (Views: 0.7ms | ActiveRecord: 1.3ms | Allocations: 2924)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:51:03 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 317)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (1.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:53:58 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.9ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:53:58.572055"], ["updated_at", "2024-03-28 08:53:58.572055"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:53:58.606927"], ["updated_at", "2024-03-28 08:53:58.606927"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:53:58"], ["created_at", "2024-03-28 08:53:58.629486"], ["updated_at", "2024-03-28 08:53:58.629486"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 70ms (Views: 0.7ms | ActiveRecord: 2.7ms | Allocations: 16861)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:53:58 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:53:58.638551"], ["updated_at", "2024-03-28 08:53:58.638551"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:53:58.640766"], ["updated_at", "2024-03-28 08:53:58.640766"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:53:58"], ["created_at", "2024-03-28 08:53:58.645062"], ["updated_at", "2024-03-28 08:53:58.645062"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 11ms (Views: 1.8ms | ActiveRecord: 1.6ms | Allocations: 2639)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
Completed 422 Unprocessable Entity in 0ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 303)
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 2ms (Views: 0.6ms | ActiveRecord: 0.2ms | Allocations: 323)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:53:58.662071"], ["updated_at", "2024-03-28 08:53:58.662071"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:53:58.665141"], ["updated_at", "2024-03-28 08:53:58.665141"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:53:58.666681"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:53:58.666681"], ["created_at", "2024-03-28 08:53:58.668778"], ["updated_at", "2024-03-28 08:53:58.668778"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 1ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 553)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:53:58.678079"], ["updated_at", "2024-03-28 08:53:58.678079"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:53:58.680176"], ["updated_at", "2024-03-28 08:53:58.680176"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:53:58 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.6ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:53:58"], ["created_at", "2024-03-28 08:53:58.687820"], ["updated_at", "2024-03-28 08:53:58.687820"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.4ms | ActiveRecord: 1.0ms | Allocations: 1541)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:53:58.693419"], ["updated_at", "2024-03-28 08:53:58.693419"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:53:58.696513"], ["updated_at", "2024-03-28 08:53:58.696513"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:53:58 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:53:58"], ["created_at", "2024-03-28 08:53:58.704267"], ["updated_at", "2024-03-28 08:53:58.704267"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 1249)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:53:58 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 12ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 2014)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:53:58.725678"], ["updated_at", "2024-03-28 08:53:58.725678"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:53:58.728036"], ["updated_at", "2024-03-28 08:53:58.728036"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:53:58.729702"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:53:58.729702"], ["created_at", "2024-03-28 08:53:58.732015"], ["updated_at", "2024-03-28 08:53:58.732015"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:53:58 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.3ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:53:58"], ["updated_at", "2024-03-28 08:53:58.738120"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.5ms | ActiveRecord: 0.7ms | Allocations: 1486)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.9ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:53:58.746271"], ["updated_at", "2024-03-28 08:53:58.746271"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:53:58.749616"], ["updated_at", "2024-03-28 08:53:58.749616"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:53:58.752160"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:53:58.752160"], ["created_at", "2024-03-28 08:53:58.753277"], ["updated_at", "2024-03-28 08:53:58.753277"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:53:58 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.0ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:53:58"], ["updated_at", "2024-03-28 08:53:58.758552"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.3ms | ActiveRecord: 0.9ms | Allocations: 1328)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:53:58.763298"], ["updated_at", "2024-03-28 08:53:58.763298"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:53:58.768662"], ["updated_at", "2024-03-28 08:53:58.768662"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:53:58.770798"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:53:58.770798"], ["created_at", "2024-03-28 08:53:58.772543"], ["updated_at", "2024-03-28 08:53:58.772543"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:53:58 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 3ms (Views: 0.2ms | ActiveRecord: 0.4ms | Allocations: 1108)
  [1m[35m (3.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:53:58.786146"], ["updated_at", "2024-03-28 08:53:58.786146"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:53:58.788917"], ["updated_at", "2024-03-28 08:53:58.788917"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:53:58.790531"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:53:58.790531"], ["created_at", "2024-03-28 08:53:58.791858"], ["updated_at", "2024-03-28 08:53:58.791858"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 0.7ms | Allocations: 426)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:53:58.803049"], ["updated_at", "2024-03-28 08:53:58.803049"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:53:58.805560"], ["updated_at", "2024-03-28 08:53:58.805560"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:53:58.806571"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:53:58.806571"], ["created_at", "2024-03-28 08:53:58.807475"], ["updated_at", "2024-03-28 08:53:58.807475"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 5ms (ActiveRecord: 0.4ms | Allocations: 357)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (2.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 5ms (Views: 1.1ms | ActiveRecord: 2.0ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:53:58.844638"], ["updated_at", "2024-03-28 08:53:58.844638"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 6ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 6ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 595)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:53:58.895187"], ["updated_at", "2024-03-28 08:53:58.895187"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:53:58.919458"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 15ms (Views: 0.5ms | ActiveRecord: 0.3ms | Allocations: 1656)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (1.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:53:58.933928"], ["updated_at", "2024-03-28 08:53:58.933928"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:53:58.946000"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 1619)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:53:58.951272"], ["updated_at", "2024-03-28 08:53:58.951272"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 2ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 661)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:53:58.964500"], ["updated_at", "2024-03-28 08:53:58.964500"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.3ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:53:58.976575"], ["updated_at", "2024-03-28 08:53:58.976575"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.5ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 4ms (Views: 1.1ms | ActiveRecord: 0.5ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:53:58.993612"], ["updated_at", "2024-03-28 08:53:58.993612"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 3ms (Views: 0.7ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:53:59.008272"], ["updated_at", "2024-03-28 08:53:59.008272"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 3ms (Views: 0.6ms | ActiveRecord: 0.6ms | Allocations: 857)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:53:59.017380"], ["updated_at", "2024-03-28 08:53:59.017380"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 1.1ms | ActiveRecord: 0.6ms | Allocations: 855)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:53:59.032857"], ["updated_at", "2024-03-28 08:53:59.032857"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:53:59.039880"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.3ms | ActiveRecord: 0.3ms | Allocations: 912)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:53:59.045549"], ["updated_at", "2024-03-28 08:53:59.045549"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:53:59.051224"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.3ms | ActiveRecord: 0.3ms | Allocations: 876)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:53:59.058343"], ["updated_at", "2024-03-28 08:53:59.058343"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 2ms (Views: 0.8ms | ActiveRecord: 0.1ms | Allocations: 367)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:53:59.068250"], ["updated_at", "2024-03-28 08:53:59.068250"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 363)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:53:59.079972"], ["updated_at", "2024-03-28 08:53:59.079972"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 1.0ms | Allocations: 356)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (2.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:53:59 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 16:53:59 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:53:59.133348"], ["updated_at", "2024-03-28 08:53:59.133348"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:53:59.135615"], ["updated_at", "2024-03-28 08:53:59.135615"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:53:59"], ["created_at", "2024-03-28 08:53:59.138319"], ["updated_at", "2024-03-28 08:53:59.138319"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 16ms (Views: 0.6ms | ActiveRecord: 1.2ms | Allocations: 2924)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:53:59 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 318)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:54:18 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:18.587119"], ["updated_at", "2024-03-28 08:54:18.587119"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:18.621532"], ["updated_at", "2024-03-28 08:54:18.621532"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:18"], ["created_at", "2024-03-28 08:54:18.641368"], ["updated_at", "2024-03-28 08:54:18.641368"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 66ms (Views: 0.7ms | ActiveRecord: 2.9ms | Allocations: 16860)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:54:18 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:18.651642"], ["updated_at", "2024-03-28 08:54:18.651642"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:18.653325"], ["updated_at", "2024-03-28 08:54:18.653325"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:18"], ["created_at", "2024-03-28 08:54:18.657957"], ["updated_at", "2024-03-28 08:54:18.657957"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 10ms (Views: 1.5ms | ActiveRecord: 1.5ms | Allocations: 2639)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 303)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 323)
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:18.674290"], ["updated_at", "2024-03-28 08:54:18.674290"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:18.676258"], ["updated_at", "2024-03-28 08:54:18.676258"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:18.678544"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:18.678544"], ["created_at", "2024-03-28 08:54:18.681510"], ["updated_at", "2024-03-28 08:54:18.681510"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 553)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:18.690563"], ["updated_at", "2024-03-28 08:54:18.690563"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:18.692861"], ["updated_at", "2024-03-28 08:54:18.692861"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:54:18 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:18"], ["created_at", "2024-03-28 08:54:18.701471"], ["updated_at", "2024-03-28 08:54:18.701471"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.5ms | ActiveRecord: 0.6ms | Allocations: 1541)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:18.707739"], ["updated_at", "2024-03-28 08:54:18.707739"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:18.710093"], ["updated_at", "2024-03-28 08:54:18.710093"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:54:18 +0800", "tour_id"=>"1"}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:18"], ["created_at", "2024-03-28 08:54:18.716812"], ["updated_at", "2024-03-28 08:54:18.716812"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 1.1ms | ActiveRecord: 0.8ms | Allocations: 1249)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:54:18 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 8ms (Views: 0.4ms | ActiveRecord: 0.0ms | Allocations: 2015)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:18.735050"], ["updated_at", "2024-03-28 08:54:18.735050"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:18.738269"], ["updated_at", "2024-03-28 08:54:18.738269"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:18.739764"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:18.739764"], ["created_at", "2024-03-28 08:54:18.741256"], ["updated_at", "2024-03-28 08:54:18.741256"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:54:18 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.3ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.3ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:54:18"], ["updated_at", "2024-03-28 08:54:18.747931"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.4ms | ActiveRecord: 0.9ms | Allocations: 1486)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:18.755143"], ["updated_at", "2024-03-28 08:54:18.755143"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:18.757692"], ["updated_at", "2024-03-28 08:54:18.757692"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:18.759085"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:18.759085"], ["created_at", "2024-03-28 08:54:18.761004"], ["updated_at", "2024-03-28 08:54:18.761004"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:54:18 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.1ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:54:18"], ["updated_at", "2024-03-28 08:54:18.768902"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.5ms | ActiveRecord: 0.5ms | Allocations: 1328)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:18.774117"], ["updated_at", "2024-03-28 08:54:18.774117"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:18.776257"], ["updated_at", "2024-03-28 08:54:18.776257"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:18.777691"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:18.777691"], ["created_at", "2024-03-28 08:54:18.779283"], ["updated_at", "2024-03-28 08:54:18.779283"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:54:18 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 4ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 1108)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:18.789605"], ["updated_at", "2024-03-28 08:54:18.789605"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:18.791174"], ["updated_at", "2024-03-28 08:54:18.791174"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:18.792412"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:18.792412"], ["created_at", "2024-03-28 08:54:18.794057"], ["updated_at", "2024-03-28 08:54:18.794057"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 426)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:18.803614"], ["updated_at", "2024-03-28 08:54:18.803614"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:18.806412"], ["updated_at", "2024-03-28 08:54:18.806412"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:18.808102"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:18.808102"], ["created_at", "2024-03-28 08:54:18.813334"], ["updated_at", "2024-03-28 08:54:18.813334"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 7ms (ActiveRecord: 0.5ms | Allocations: 357)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (2.3ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 5ms (Views: 0.6ms | ActiveRecord: 2.3ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:18.844301"], ["updated_at", "2024-03-28 08:54:18.844301"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 4ms (Views: 2.6ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 6ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 475)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 3ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 473)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 596)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:18.936449"], ["updated_at", "2024-03-28 08:54:18.936449"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:54:18.943292"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 1656)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.9ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:18.950000"], ["updated_at", "2024-03-28 08:54:18.950000"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:54:18.958205"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 1617)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:18.963666"], ["updated_at", "2024-03-28 08:54:18.963666"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 2ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 661)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.9ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:18.975043"], ["updated_at", "2024-03-28 08:54:18.975043"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.4ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.4ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:18.985413"], ["updated_at", "2024-03-28 08:54:18.985413"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.4ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.4ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:19.001883"], ["updated_at", "2024-03-28 08:54:19.001883"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.8ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:19.014033"], ["updated_at", "2024-03-28 08:54:19.014033"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.7ms | ActiveRecord: 1.3ms | Allocations: 857)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:19.023051"], ["updated_at", "2024-03-28 08:54:19.023051"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 1.1ms | ActiveRecord: 1.0ms | Allocations: 855)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (1.0ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:19.036026"], ["updated_at", "2024-03-28 08:54:19.036026"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:54:19.044752"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 912)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:19.052354"], ["updated_at", "2024-03-28 08:54:19.052354"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.2ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:54:19.059348"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.5ms | ActiveRecord: 0.5ms | Allocations: 876)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:19.065056"], ["updated_at", "2024-03-28 08:54:19.065056"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (1.8ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 4ms (Views: 0.2ms | ActiveRecord: 1.8ms | Allocations: 367)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:19.075912"], ["updated_at", "2024-03-28 08:54:19.075912"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (1.8ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 2.1ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:19.088754"], ["updated_at", "2024-03-28 08:54:19.088754"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:54:19 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 16:54:19 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:19.150497"], ["updated_at", "2024-03-28 08:54:19.150497"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:19.152332"], ["updated_at", "2024-03-28 08:54:19.152332"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:19"], ["created_at", "2024-03-28 08:54:19.154605"], ["updated_at", "2024-03-28 08:54:19.154605"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 15ms (Views: 0.6ms | ActiveRecord: 1.1ms | Allocations: 2924)
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:54:19 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 317)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:54:48 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:48.528738"], ["updated_at", "2024-03-28 08:54:48.528738"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:48.563019"], ["updated_at", "2024-03-28 08:54:48.563019"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:48"], ["created_at", "2024-03-28 08:54:48.581272"], ["updated_at", "2024-03-28 08:54:48.581272"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 65ms (Views: 0.9ms | ActiveRecord: 2.4ms | Allocations: 16860)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (3.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:54:48 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:48.593385"], ["updated_at", "2024-03-28 08:54:48.593385"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:48.595321"], ["updated_at", "2024-03-28 08:54:48.595321"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:48"], ["created_at", "2024-03-28 08:54:48.599702"], ["updated_at", "2024-03-28 08:54:48.599702"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 10ms (Views: 0.7ms | ActiveRecord: 1.5ms | Allocations: 2639)
  [1m[35m (0.8ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 303)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.4ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 2ms (Views: 1.0ms | ActiveRecord: 0.4ms | Allocations: 323)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:48.619059"], ["updated_at", "2024-03-28 08:54:48.619059"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:48.620682"], ["updated_at", "2024-03-28 08:54:48.620682"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:48.621589"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:48.621589"], ["created_at", "2024-03-28 08:54:48.622696"], ["updated_at", "2024-03-28 08:54:48.622696"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.6ms | ActiveRecord: 0.2ms | Allocations: 553)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:48.633134"], ["updated_at", "2024-03-28 08:54:48.633134"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:48.636201"], ["updated_at", "2024-03-28 08:54:48.636201"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:54:48 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:48"], ["created_at", "2024-03-28 08:54:48.642828"], ["updated_at", "2024-03-28 08:54:48.642828"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 7ms (Views: 0.4ms | ActiveRecord: 1.0ms | Allocations: 1541)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:48.649465"], ["updated_at", "2024-03-28 08:54:48.649465"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:48.653181"], ["updated_at", "2024-03-28 08:54:48.653181"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:54:48 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:48"], ["created_at", "2024-03-28 08:54:48.658573"], ["updated_at", "2024-03-28 08:54:48.658573"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.5ms | ActiveRecord: 0.7ms | Allocations: 1249)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:54:48 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 11ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 2014)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:48.687438"], ["updated_at", "2024-03-28 08:54:48.687438"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:48.689293"], ["updated_at", "2024-03-28 08:54:48.689293"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:48.690287"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:48.690287"], ["created_at", "2024-03-28 08:54:48.691606"], ["updated_at", "2024-03-28 08:54:48.691606"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:54:48 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:54:48"], ["updated_at", "2024-03-28 08:54:48.698098"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.5ms | ActiveRecord: 0.6ms | Allocations: 1486)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:48.705755"], ["updated_at", "2024-03-28 08:54:48.705755"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:48.707538"], ["updated_at", "2024-03-28 08:54:48.707538"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:48.708740"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:48.708740"], ["created_at", "2024-03-28 08:54:48.711346"], ["updated_at", "2024-03-28 08:54:48.711346"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:54:48 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.1ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:54:48"], ["updated_at", "2024-03-28 08:54:48.719756"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 0.6ms | Allocations: 1328)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:48.723578"], ["updated_at", "2024-03-28 08:54:48.723578"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:48.725722"], ["updated_at", "2024-03-28 08:54:48.725722"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:48.727446"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:48.727446"], ["created_at", "2024-03-28 08:54:48.728701"], ["updated_at", "2024-03-28 08:54:48.728701"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:54:48 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 2ms (Views: 0.2ms | ActiveRecord: 0.2ms | Allocations: 1108)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:48.739599"], ["updated_at", "2024-03-28 08:54:48.739599"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:48.741626"], ["updated_at", "2024-03-28 08:54:48.741626"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:48.743579"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:48.743579"], ["created_at", "2024-03-28 08:54:48.746719"], ["updated_at", "2024-03-28 08:54:48.746719"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:48.756971"], ["updated_at", "2024-03-28 08:54:48.756971"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:48.759317"], ["updated_at", "2024-03-28 08:54:48.759317"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (7.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:48.760771"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:48.760771"], ["created_at", "2024-03-28 08:54:48.771214"], ["updated_at", "2024-03-28 08:54:48.771214"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (6.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 8ms (ActiveRecord: 6.3ms | Allocations: 357)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 9ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:48.811725"], ["updated_at", "2024-03-28 08:54:48.811725"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 5ms (Views: 3.3ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 3ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 475)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (2.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}}
Completed 422 Unprocessable Entity in 3ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 473)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 596)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:48.910992"], ["updated_at", "2024-03-28 08:54:48.910992"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:54:48.918842"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.3ms | ActiveRecord: 0.3ms | Allocations: 1656)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:48.926855"], ["updated_at", "2024-03-28 08:54:48.926855"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:54:48.934245"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 1617)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:48.940110"], ["updated_at", "2024-03-28 08:54:48.940110"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 5ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 661)
  [1m[35m (0.9ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:48.952912"], ["updated_at", "2024-03-28 08:54:48.952912"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:48.971262"], ["updated_at", "2024-03-28 08:54:48.971262"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 1ms (Views: 1.0ms | ActiveRecord: 0.2ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:48.988082"], ["updated_at", "2024-03-28 08:54:48.988082"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:49.003821"], ["updated_at", "2024-03-28 08:54:49.003821"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 3ms (Views: 0.3ms | ActiveRecord: 0.6ms | Allocations: 857)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:49.010791"], ["updated_at", "2024-03-28 08:54:49.010791"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 1.0ms | ActiveRecord: 0.7ms | Allocations: 855)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:49.024707"], ["updated_at", "2024-03-28 08:54:49.024707"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:54:49.031659"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 912)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:49.037841"], ["updated_at", "2024-03-28 08:54:49.037841"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:54:49.042908"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 876)
  [1m[35m (3.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:49.050881"], ["updated_at", "2024-03-28 08:54:49.050881"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 367)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:49.059946"], ["updated_at", "2024-03-28 08:54:49.059946"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.3ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (1.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 5ms (ActiveRecord: 1.6ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (1.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:49.077227"], ["updated_at", "2024-03-28 08:54:49.077227"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (1.3ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:54:49 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 16:54:49 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:54:49.141657"], ["updated_at", "2024-03-28 08:54:49.141657"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:54:49.144342"], ["updated_at", "2024-03-28 08:54:49.144342"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:54:49"], ["created_at", "2024-03-28 08:54:49.149757"], ["updated_at", "2024-03-28 08:54:49.149757"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 19ms (Views: 0.8ms | ActiveRecord: 1.5ms | Allocations: 2924)
  [1m[35m (1.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:54:49 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
Completed 422 Unprocessable Entity in 2ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 317)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:55:01 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:55:01.823938"], ["updated_at", "2024-03-28 08:55:01.823938"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:55:01.862395"], ["updated_at", "2024-03-28 08:55:01.862395"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:55:01"], ["created_at", "2024-03-28 08:55:01.883604"], ["updated_at", "2024-03-28 08:55:01.883604"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 70ms (Views: 0.7ms | ActiveRecord: 2.4ms | Allocations: 16860)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (1.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:55:01 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.0ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:55:01.894981"], ["updated_at", "2024-03-28 08:55:01.894981"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:55:01.898294"], ["updated_at", "2024-03-28 08:55:01.898294"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:55:01"], ["created_at", "2024-03-28 08:55:01.903388"], ["updated_at", "2024-03-28 08:55:01.903388"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 13ms (Views: 1.3ms | ActiveRecord: 2.2ms | Allocations: 2639)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 303)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 323)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:55:01.920782"], ["updated_at", "2024-03-28 08:55:01.920782"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:55:01.922450"], ["updated_at", "2024-03-28 08:55:01.922450"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:55:01.923646"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:55:01.923646"], ["created_at", "2024-03-28 08:55:01.927099"], ["updated_at", "2024-03-28 08:55:01.927099"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 1ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 553)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:55:01.935980"], ["updated_at", "2024-03-28 08:55:01.935980"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:55:01.937828"], ["updated_at", "2024-03-28 08:55:01.937828"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:55:01 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:55:01"], ["created_at", "2024-03-28 08:55:01.946181"], ["updated_at", "2024-03-28 08:55:01.946181"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.4ms | ActiveRecord: 0.6ms | Allocations: 1541)
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (1.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:55:01.952562"], ["updated_at", "2024-03-28 08:55:01.952562"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:55:01.957617"], ["updated_at", "2024-03-28 08:55:01.957617"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 16:55:01 +0800", "tour_id"=>"1"}}
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.5ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:55:01"], ["created_at", "2024-03-28 08:55:01.963439"], ["updated_at", "2024-03-28 08:55:01.963439"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 7ms (Views: 0.6ms | ActiveRecord: 0.9ms | Allocations: 1249)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:55:01 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 7ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 2014)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:55:01.989876"], ["updated_at", "2024-03-28 08:55:01.989876"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:55:01.992205"], ["updated_at", "2024-03-28 08:55:01.992205"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (1.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:55:01.993385"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:55:01.993385"], ["created_at", "2024-03-28 08:55:01.995934"], ["updated_at", "2024-03-28 08:55:01.995934"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:55:01 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:55:01"], ["updated_at", "2024-03-28 08:55:02.001798"], ["id", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.7ms | ActiveRecord: 0.9ms | Allocations: 1486)
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:55:02.010659"], ["updated_at", "2024-03-28 08:55:02.010659"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:55:02.013010"], ["updated_at", "2024-03-28 08:55:02.013010"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:55:02.013994"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:55:02.013994"], ["created_at", "2024-03-28 08:55:02.016021"], ["updated_at", "2024-03-28 08:55:02.016021"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:55:02 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.0ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 08:55:02"], ["updated_at", "2024-03-28 08:55:02.022547"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 1328)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:55:02.027109"], ["updated_at", "2024-03-28 08:55:02.027109"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:55:02.028948"], ["updated_at", "2024-03-28 08:55:02.028948"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.0ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:55:02.029971"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (2.5ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:55:02.029971"], ["created_at", "2024-03-28 08:55:02.031326"], ["updated_at", "2024-03-28 08:55:02.031326"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 16:55:02 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 6ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 1108)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:55:02.045878"], ["updated_at", "2024-03-28 08:55:02.045878"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:55:02.047627"], ["updated_at", "2024-03-28 08:55:02.047627"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:55:02.050799"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:55:02.050799"], ["created_at", "2024-03-28 08:55:02.052009"], ["updated_at", "2024-03-28 08:55:02.052009"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.4ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:55:02.063547"], ["updated_at", "2024-03-28 08:55:02.063547"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:55:02.074087"], ["updated_at", "2024-03-28 08:55:02.074087"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:55:02.076275"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:55:02.076275"], ["created_at", "2024-03-28 08:55:02.077459"], ["updated_at", "2024-03-28 08:55:02.077459"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.3ms | Allocations: 357)
  [1m[35m (3.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:55:02.110570"], ["updated_at", "2024-03-28 08:55:02.110570"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 7ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 5ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 595)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:55:02.159032"], ["updated_at", "2024-03-28 08:55:02.159032"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:55:02.181078"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 14ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 1656)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (1.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:55:02.195914"], ["updated_at", "2024-03-28 08:55:02.195914"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (1.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 08:55:02.212052"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 10ms (Views: 0.7ms | ActiveRecord: 1.4ms | Allocations: 1619)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:55:02.217525"], ["updated_at", "2024-03-28 08:55:02.217525"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 661)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:55:02.228589"], ["updated_at", "2024-03-28 08:55:02.228589"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.2ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:55:02.236568"], ["updated_at", "2024-03-28 08:55:02.236568"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.5ms | Allocations: 356)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 1ms (Views: 0.7ms | ActiveRecord: 0.2ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:55:02.251348"], ["updated_at", "2024-03-28 08:55:02.251348"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 1.0ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:55:02.264091"], ["updated_at", "2024-03-28 08:55:02.264091"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 7ms (Views: 4.4ms | ActiveRecord: 0.7ms | Allocations: 857)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.9ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:55:02.275301"], ["updated_at", "2024-03-28 08:55:02.275301"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.9ms | ActiveRecord: 1.1ms | Allocations: 855)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:55:02.291039"], ["updated_at", "2024-03-28 08:55:02.291039"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:55:02.296283"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.4ms | ActiveRecord: 0.4ms | Allocations: 912)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:55:02.301702"], ["updated_at", "2024-03-28 08:55:02.301702"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 08:55:02.307210"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.5ms | ActiveRecord: 0.4ms | Allocations: 876)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:55:02.312729"], ["updated_at", "2024-03-28 08:55:02.312729"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 367)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:55:02.321918"], ["updated_at", "2024-03-28 08:55:02.321918"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:55:02.330964"], ["updated_at", "2024-03-28 08:55:02.330964"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 356)
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:55:02 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 16:55:02 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.8ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 08:55:02.406932"], ["updated_at", "2024-03-28 08:55:02.406932"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.3ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 08:55:02.411233"], ["updated_at", "2024-03-28 08:55:02.411233"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 08:55:02"], ["created_at", "2024-03-28 08:55:02.418038"], ["updated_at", "2024-03-28 08:55:02.418038"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 33ms (Views: 0.9ms | ActiveRecord: 2.1ms | Allocations: 2924)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 16:55:02 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 318)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (1.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ?[0m  [["key", "schema_sha1"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#get_availability_tours as HTML
  [1m[36mTour Load (0.4ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 0.7ms | Allocations: 2420)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 17:20:33 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.0ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 09:20:33.752656"], ["updated_at", "2024-03-28 09:20:33.752656"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.2ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 09:20:33.786515"], ["updated_at", "2024-03-28 09:20:33.786515"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.8ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 09:20:33"], ["created_at", "2024-03-28 09:20:33.812112"], ["updated_at", "2024-03-28 09:20:33.812112"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 72ms (Views: 0.9ms | ActiveRecord: 3.6ms | Allocations: 16860)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 17:20:33 +0800"}, "availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>"specific_dates"}, "tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.0ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 09:20:33.822427"], ["updated_at", "2024-03-28 09:20:33.822427"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 09:20:33.826550"], ["updated_at", "2024-03-28 09:20:33.826550"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 09:20:33"], ["created_at", "2024-03-28 09:20:33.831108"], ["updated_at", "2024-03-28 09:20:33.831108"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 12ms (Views: 0.9ms | ActiveRecord: 2.3ms | Allocations: 2639)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"availability"=>{"start_time"=>""}, "availability_rule"=>{"rule_type"=>""}, "tour"=>{"name"=>""}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 303)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#index as HTML
  [1m[36mAvailability Load (0.4ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities"[0m
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.4ms | Allocations: 323)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 09:20:33.852820"], ["updated_at", "2024-03-28 09:20:33.852820"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.1ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 09:20:33.854467"], ["updated_at", "2024-03-28 09:20:33.854467"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 09:20:33.855381"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 09:20:33.855381"], ["created_at", "2024-03-28 09:20:33.856713"], ["updated_at", "2024-03-28 09:20:33.856713"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.2ms | Allocations: 553)
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 09:20:33.867994"], ["updated_at", "2024-03-28 09:20:33.867994"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 09:20:33.870536"], ["updated_at", "2024-03-28 09:20:33.870536"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 17:20:33 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 09:20:33"], ["created_at", "2024-03-28 09:20:33.879550"], ["updated_at", "2024-03-28 09:20:33.879550"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 7ms (Views: 0.4ms | ActiveRecord: 0.8ms | Allocations: 1541)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (1.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 09:20:33.886056"], ["updated_at", "2024-03-28 09:20:33.886056"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 09:20:33.889402"], ["updated_at", "2024-03-28 09:20:33.889402"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"availability_rule_id"=>"1", "start_time"=>"2024-03-28 17:20:33 +0800", "tour_id"=>"1"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.8ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 09:20:33"], ["created_at", "2024-03-28 09:20:33.894848"], ["updated_at", "2024-03-28 09:20:33.894848"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 5ms (Views: 0.4ms | ActiveRecord: 1.1ms | Allocations: 1249)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilitiesController#create as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 17:20:33 +0800", "tour_id"=>""}}
Completed 422 Unprocessable Entity in 9ms (Views: 0.4ms | ActiveRecord: 0.0ms | Allocations: 2014)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 09:20:33.915832"], ["updated_at", "2024-03-28 09:20:33.915832"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 09:20:33.918078"], ["updated_at", "2024-03-28 09:20:33.918078"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 09:20:33.919743"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.4ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 09:20:33.919743"], ["created_at", "2024-03-28 09:20:33.921579"], ["updated_at", "2024-03-28 09:20:33.921579"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 17:20:33 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 09:20:33"], ["updated_at", "2024-03-28 09:20:33.928041"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.6ms | ActiveRecord: 0.6ms | Allocations: 1486)
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 09:20:33.936876"], ["updated_at", "2024-03-28 09:20:33.936876"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 09:20:33.938637"], ["updated_at", "2024-03-28 09:20:33.938637"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 09:20:33.939736"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 09:20:33.939736"], ["created_at", "2024-03-28 09:20:33.941726"], ["updated_at", "2024-03-28 09:20:33.941726"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 17:20:33 +0800"}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Update (0.2ms)[0m  [1m[33mUPDATE "availabilities" SET "start_time" = ?, "updated_at" = ? WHERE "availabilities"."id" = ?[0m  [["start_time", "2024-03-28 09:20:33"], ["updated_at", "2024-03-28 09:20:33.948769"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.6ms | ActiveRecord: 0.7ms | Allocations: 1328)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 09:20:33.954827"], ["updated_at", "2024-03-28 09:20:33.954827"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.3ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 09:20:33.956920"], ["updated_at", "2024-03-28 09:20:33.956920"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 09:20:33.958435"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.3ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 09:20:33.958435"], ["created_at", "2024-03-28 09:20:33.960062"], ["updated_at", "2024-03-28 09:20:33.960062"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#update as HTML
  Parameters: {"availability"=>{"start_time"=>"2024-03-28 17:20:33 +0800", "tour_id"=>""}, "id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 5ms (Views: 0.3ms | ActiveRecord: 0.5ms | Allocations: 1108)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.7ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 09:20:33.973380"], ["updated_at", "2024-03-28 09:20:33.973380"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 09:20:33.975554"], ["updated_at", "2024-03-28 09:20:33.975554"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 09:20:33.976768"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.6ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 09:20:33.976768"], ["created_at", "2024-03-28 09:20:33.978008"], ["updated_at", "2024-03-28 09:20:33.978008"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.2ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.4ms | Allocations: 426)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availabilities"[0m
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.6ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 09:20:33.988249"], ["updated_at", "2024-03-28 09:20:33.988249"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.2ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 09:20:33.990248"], ["updated_at", "2024-03-28 09:20:33.990248"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."tour_id" = ? AND "availabilities"."availability_rule_id" = ? AND "availabilities"."start_time" = ? LIMIT ?[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 09:20:33.991839"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Create (0.7ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 09:20:33.991839"], ["created_at", "2024-03-28 09:20:33.993169"], ["updated_at", "2024-03-28 09:20:33.993169"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilitiesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailability Load (0.1ms)[0m  [1m[34mSELECT "availabilities".* FROM "availabilities" WHERE "availabilities"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailability Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availabilities" WHERE "availabilities"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 6ms (ActiveRecord: 0.4ms | Allocations: 357)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#index as HTML
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules"[0m
Completed 200 OK in 4ms (Views: 0.6ms | ActiveRecord: 0.2ms | Allocations: 314)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 09:20:34.025425"], ["updated_at", "2024-03-28 09:20:34.025425"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 7ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 496)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by AvailabilityRulesController#create as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}}
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 6ms (Views: 2.7ms | ActiveRecord: 0.0ms | Allocations: 595)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.6ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 09:20:34.068089"], ["updated_at", "2024-03-28 09:20:34.068089"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 09:20:34.088267"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 14ms (Views: 2.4ms | ActiveRecord: 0.4ms | Allocations: 1656)
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.7ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 09:20:34.102927"], ["updated_at", "2024-03-28 09:20:34.102927"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"days"=>["Monday", "Wednesday", "Friday"]}, "rule_type"=>"weekly"}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.2ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Update (0.1ms)[0m  [1m[33mUPDATE "availability_rules" SET "rule_type" = ?, "rule_data" = ?, "updated_at" = ? WHERE "availability_rules"."id" = ?[0m  [["rule_type", "weekly"], ["rule_data", "{\"days\":[\"Monday\",\"Wednesday\",\"Friday\"]}"], ["updated_at", "2024-03-28 09:20:34.121003"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 11ms (Views: 0.5ms | ActiveRecord: 0.4ms | Allocations: 1619)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.4ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 09:20:34.126384"], ["updated_at", "2024-03-28 09:20:34.126384"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#update as HTML
  Parameters: {"availability_rule"=>{"rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}, "rule_type"=>""}, "id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[31mUnpermitted parameter: :dates[0m
[31mUnpermitted parameter: :dates[0m
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 661)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 09:20:34.137946"], ["updated_at", "2024-03-28 09:20:34.137946"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.2ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "availability_rules"[0m
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (1.9ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 09:20:34.151656"], ["updated_at", "2024-03-28 09:20:34.151656"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by AvailabilityRulesController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mAvailabilityRule Load (0.1ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Destroy (0.1ms)[0m  [1m[31mDELETE FROM "availability_rules" WHERE "availability_rules"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.4ms | Allocations: 356)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#index as HTML
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 09:20:34.171438"], ["updated_at", "2024-03-28 09:20:34.171438"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 480)
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 09:20:34.187423"], ["updated_at", "2024-03-28 09:20:34.187423"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 3ms (Views: 0.3ms | ActiveRecord: 0.5ms | Allocations: 857)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>"Sample Tour"}}
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 09:20:34.194726"], ["updated_at", "2024-03-28 09:20:34.194726"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 6ms (Views: 3.0ms | ActiveRecord: 0.9ms | Allocations: 855)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Processing by ToursController#create as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 280)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.8ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 09:20:34.210593"], ["updated_at", "2024-03-28 09:20:34.210593"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.2ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 09:20:34.218050"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 912)
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 09:20:34.224909"], ["updated_at", "2024-03-28 09:20:34.224909"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"name"=>"New Tour Name"}, "id"=>"1"}
  [1m[36mTour Load (0.5ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Update (0.1ms)[0m  [1m[33mUPDATE "tours" SET "name" = ?, "updated_at" = ? WHERE "tours"."id" = ?[0m  [["name", "New Tour Name"], ["updated_at", "2024-03-28 09:20:34.231853"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 0.8ms | Allocations: 876)
  [1m[35m (0.4ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.4ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 09:20:34.237441"], ["updated_at", "2024-03-28 09:20:34.237441"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#update as HTML
  Parameters: {"tour"=>{"description"=>"A sample tour description", "duration_days"=>"1", "duration_hours"=>"3", "name"=>""}, "id"=>"1"}
  [1m[36mTour Load (0.1ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
Completed 422 Unprocessable Entity in 2ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 367)
  [1m[35m (1.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.3ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 09:20:34.249548"], ["updated_at", "2024-03-28 09:20:34.249548"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (0.4ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.1ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.7ms | Allocations: 363)
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tours"[0m
  [1m[35m (0.6ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.5ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 09:20:34.259523"], ["updated_at", "2024-03-28 09:20:34.259523"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Processing by ToursController#destroy as HTML
  Parameters: {"id"=>"1"}
  [1m[36mTour Load (2.6ms)[0m  [1m[34mSELECT "tours".* FROM "tours" WHERE "tours"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Destroy (0.2ms)[0m  [1m[31mDELETE FROM "tours" WHERE "tours"."id" = ?[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 5ms (ActiveRecord: 3.0ms | Allocations: 356)
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 17:20:34 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>"Sample Tour", "description"=>"A sample tour description", "duration_hours"=>"3", "duration_days"=>"1"}, "availability"=>{"start_time"=>"2024-03-28 17:20:34 +0800"}, "availability_rule"=>{"rule_type"=>"specific_dates", "rule_data"=>{"dates"=>["2024-01-05", "2024-02-06", "2024-03-15"]}}}
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Create (0.5ms)[0m  [1m[32mINSERT INTO "availability_rules" ("rule_type", "rule_data", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["rule_type", "specific_dates"], ["rule_data", "{\"dates\":[\"2024-01-05\",\"2024-02-06\",\"2024-03-15\"]}"], ["created_at", "2024-03-28 09:20:34.316928"], ["updated_at", "2024-03-28 09:20:34.316928"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTour Create (0.1ms)[0m  [1m[32mINSERT INTO "tours" ("name", "description", "duration_hours", "duration_days", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["name", "Sample Tour"], ["description", "A sample tour description"], ["duration_hours", 3], ["duration_days", 1], ["created_at", "2024-03-28 09:20:34.318780"], ["updated_at", "2024-03-28 09:20:34.318780"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAvailabilityRule Load (0.0ms)[0m  [1m[34mSELECT "availability_rules".* FROM "availability_rules" WHERE "availability_rules"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAvailability Create (0.2ms)[0m  [1m[32mINSERT INTO "availabilities" ("tour_id", "availability_rule_id", "start_time", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["tour_id", 1], ["availability_rule_id", 1], ["start_time", "2024-03-28 09:20:34"], ["created_at", "2024-03-28 09:20:34.321275"], ["updated_at", "2024-03-28 09:20:34.321275"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 16ms (Views: 0.7ms | ActiveRecord: 1.1ms | Allocations: 2924)
  [1m[35m (0.7ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started POST "/api/create_tour_availability" for 127.0.0.1 at 2024-03-28 17:20:34 +0800
Processing by ApiController#create_tour_availability as HTML
  Parameters: {"tour"=>{"name"=>nil}, "availability"=>{"start_time"=>nil}, "availability_rule"=>{"rule_type"=>nil}}
Completed 422 Unprocessable Entity in 1ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 318)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
